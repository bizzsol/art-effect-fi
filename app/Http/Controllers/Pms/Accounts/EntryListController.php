<?php
bolt_decrypt( __FILE__ , 'PPG2st'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zXEFjY291bnRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXENvbXBhbnk7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllclBheW1lbnQ7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllckxlZGdlcnM7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllcnM7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xQdXJjaGFzZVxQdXJjaGFzZU9yZGVyOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHVyY2hhc2VcUHVyY2hhc2VPcmRlckVudHJ5Owp1c2UgREI7CnVzZSBBdXRoOwp1c2UgQXBwOwp1c2UgRGF0YVRhYmxlczsKCmNsYXNzIEVudHJ5TGlzdENvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsgICAKICAgIC8qKgogICAgICogU2V0IGdsb2JhbCBkYXRhIHRhYmxlIGhlYWRlcnMuCiAgICAgKgogICAgICogQHJldHVybiBoZWFkZXJDb2x1bW5zCiAgICAgKi8KCiAgICBwdWJsaWMgZnVuY3Rpb24gaGVhZGVyQ29sdW1ucygkdmFsdWU9JycpCiAgICB7CiAgICAgICAgJHJvd3MgPSAgYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwKICAgICAgICAgICAgWydjb21wYW55JywgJ2NvbXBhbnknLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydwb19kYXRlJywgJ3BvX2RhdGUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydyZWZlcmVuY2Vfbm8nLCAncmVmZXJlbmNlX25vJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnc3VwcGxpZXJzJywgJ3N1cHBsaWVycycsICd0ZXh0LWxlZnQnXSwKICAgICAgICAgICAgWydxdW90YXRpb25fcmVmX25vJywgJ3F1b3RhdGlvbl9yZWZfbm8nLCAndGV4dC1sZWZ0J10sIAogICAgICAgICAgICBbJ2N1cnJlbmN5JywgJ2N1cnJlbmN5JywgJ3RleHQtcmlnaHQnXSwKICAgICAgICAgICAgWyd0b3RhbF9wcmljZScsICd0b3RhbF9wcmljZScsICd0ZXh0LXJpZ2h0J10sIAogICAgICAgICAgICBbJ3ZhdCcsICd2YXQnLCAndGV4dC1yaWdodCddLAogICAgICAgICAgICBbJ2dyb3NzX3ByaWNlJywgJ2dyb3NzX3ByaWNlJywgJ3RleHQtcmlnaHQnXSwKICAgICAgICAgICAgWydhY3Rpb25zJywgJ2FjdGlvbnMnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICApOwogICAgICAgIHJldHVybiAkcm93czsKICAgIH0KICAgIC8qKgogICAgICogRGlzcGxheSBhIGxpc3Rpbmcgb2YgdGhlIHJlc291cmNlLgogICAgICoKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgIHRyeSB7CgogICAgICAgICAgICBpZiAocmVxdWVzdCgpLT5hamF4KCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBEYXRhdGFibGVzOjpvZigKICAgICAgICAgICAgICAgICAgICBQdXJjaGFzZU9yZGVyOjp3aXRoKFsncmVsUXVvdGF0aW9uJywncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsJ3JlbFF1b3RhdGlvbi5leGNoYW5nZVJhdGUuY3VycmVuY3knXSkKICAgICAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdwdXJjaGFzZU9yZGVyRW50cmllcycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmVSYXcoJ3B1cmNoYXNlX29yZGVycy5pZD1wdXJjaGFzZV9vcmRlcl9lbnRyaWVzLnB1cmNoYXNlX29yZGVyX2lkJyk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdVbml0LmNvbXBhbnkudXNlcnMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgndXNlcl9pZCcsIGF1dGgoKS0+dXNlcigpLT5pZCk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPndoZW4oIWRhdGF0YWJsZU9yZGVyaW5nKCksIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2lkJywgJ2Rlc2MnKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLT5hZGRJbmRleENvbHVtbigpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjb21wYW55JywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAoaXNzZXQoJHZhbHVlcy0+VW5pdC0+Y29tcGFueS0+Y29kZSkgPyAkdmFsdWVzLT5Vbml0LT5jb21wYW55LT5jb2RlIDogJycpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdjb21wYW55JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnVW5pdC5jb21wYW55JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2NvZGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3BvX2RhdGUnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZSgnZC1NLVknLCBzdHJ0b3RpbWUoJHZhbHVlcy0+cG9fZGF0ZSkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdyZWZlcmVuY2Vfbm8nLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKSIgb25jbGljaz0icHVyY2hhc2VPcmRlckRldGFpbHMoJCh0aGlzKSkiIGNsYXNzPSJidG4gYnRuLWxpbmsgc2hvd1BPRGV0YWlscyIgZGF0YS1zcmM9Iicucm91dGUoJ3Btcy5wdXJjaGFzZS5vcmRlci1saXN0LnNob3cnLCR2YWx1ZXMtPmlkKS4nIj4nLiR2YWx1ZXMtPnJlZmVyZW5jZV9uby4nPC9hPic7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3JlZmVyZW5jZV9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3JlZmVyZW5jZV9ubycsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3N1cHBsaWVycycsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24pID8gKGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVsU3VwcGxpZXJzLT5uYW1lKSA/ICR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVsU3VwcGxpZXJzLT5uYW1lLicgKCcuJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPmNvZGUuJyknIDogJycpIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3N1cHBsaWVycycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5LiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdxdW90YXRpb25fcmVmX25vJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVmZXJlbmNlX25vKT8kdmFsdWVzLT5yZWxRdW90YXRpb24tPnJlZmVyZW5jZV9ubzonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncXVvdGF0aW9uX3JlZl9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgncmVmZXJlbmNlX25vJywgJ0xJS0UnLCAnJScuJGtleS4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjdXJyZW5jeScsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPmNvZGUpPyR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+Y29kZTonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3JlbFF1b3RhdGlvbi5leGNoYW5nZVJhdGUuY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScuJGtleS4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3RvdGFsX3ByaWNlJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbURvdWJsZVZhbHVlKCR2YWx1ZXMtPnRvdGFsX3ByaWNlKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3ZhdCcsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzeXN0ZW1Eb3VibGVWYWx1ZSgkdmFsdWVzLT52YXQsIDIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbignZ3Jvc3NfcHJpY2UnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3lzdGVtRG91YmxlVmFsdWUoJHZhbHVlcy0+Z3Jvc3NfcHJpY2UsIDIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iJy5yb3V0ZSgncG1zLmFjY291bnRzLnBvLndpc2UuZW50cnkuc2hvdycsJHZhbHVlcy0+aWQpLicvcHJpbnQiICB0aXRsZT0iUHJpbnQgQWxsIFRyYW5zYWN0aW9ucyIgY2xhc3M9ImJ0biBtYi0xIGJ0bi14cyBidG4tc3VjY2VzcyI+PGkgY2xhc3M9ImxhcyBsYS1wcmludCI+PC9pPlByaW50PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgdGFyZ2V0PSJfX2JsYW5rIiBocmVmPSInLnJvdXRlKCdwbXMuYWNjb3VudHMucG8ud2lzZS5lbnRyeS5zaG93JywkdmFsdWVzLT5pZCkuJyIgIHRpdGxlPSJFbnRyeSBMaXN0IiBjbGFzcz0iYnRuIG1iLTEgYnRuLXhzIGJ0bi1pbmZvIj48aSBjbGFzcz0ibGFyIGxhLXBsdXMtc3F1YXJlIj48L2k+RW50cmllczwvYT4nOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbJ2RhdGUnLCAncmVmZXJlbmNlX25vJywgJ3RvdGFsX3ByaWNlJywgJ3ZhdCcsICdncm9zc19wcmljZScsICdhY3Rpb25zJ10pCiAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnUHVyY2hhc2UgT3JkZXIgV2lzZSBFbnRyeSBMaXN0JywKICAgICAgICAgICAgICAgICdoZWFkZXJDb2x1bW5zJyA9PiAkdGhpcy0+aGVhZGVyQ29sdW1ucygpLAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLmFjY291bnRzLnBvLXdpc2UtZW50cnktbGlzdCcsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgIC8qKgogICAgICogRGlzcGxheSB0aGUgc3BlY2lmaWVkIHJlc291cmNlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICAgcHVibGljIGZ1bmN0aW9uIHBvV2lzZUVudHJ5TGlzdCgkaWQpCiAgICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRlbnRyeUxpc3QgPSBQdXJjaGFzZU9yZGVyRW50cnk6OndpdGgoWwogICAgICAgICAgICAgICAgJ2VudHJ5Lml0ZW1zLmNoYXJ0T2ZBY2NvdW50JywKICAgICAgICAgICAgICAgICdlbnRyeS5lbnRyeVR5cGUnLAogICAgICAgICAgICAgICAgJ2VudHJ5LmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmUoJ3B1cmNoYXNlX29yZGVyX2lkJywkaWQpCiAgICAgICAgICAgIC0+b3JkZXJCeSgnaWQnLCAnZGVzYycpCiAgICAgICAgICAgIC0+cGFnaW5hdGUoMTAwKTsKCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnRW50cnkgTGlzdCcsCiAgICAgICAgICAgICAgICAnZW50cnlMaXN0JyA9PiAkZW50cnlMaXN0LAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLmFjY291bnRzLmVudHJ5LWxpc3QnLCAkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBwb1dpc2VFbnRyeUxpc3RQcmludCgkaWQpCiAgICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRwdXJjaGFzZU9yZGVyID0gUHVyY2hhc2VPcmRlcjo6d2l0aChbCiAgICAgICAgICAgICAgICAncHVyY2hhc2VPcmRlckVudHJpZXMuZW50cnkuaXRlbXMuY2hhcnRPZkFjY291bnQnLAogICAgICAgICAgICAgICAgJ3B1cmNoYXNlT3JkZXJFbnRyaWVzLmVudHJ5Lml0ZW1zLmNvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLAogICAgICAgICAgICAgICAgJ3B1cmNoYXNlT3JkZXJFbnRyaWVzLmVudHJ5LmVudHJ5VHlwZScsCiAgICAgICAgICAgICAgICAncHVyY2hhc2VPcmRlckVudHJpZXMuZW50cnkuZXhjaGFuZ2VSYXRlLmN1cnJlbmN5JywKICAgICAgICAgICAgXSktPmZpbmRPckZhaWwoJGlkKTsKICAgICAgICAgICAgJHRpdGxlID0gJ1B1cmNoYXNlIE9yZGVyIFRyYW5zYWN0aW9ucyAjJy4kcHVyY2hhc2VPcmRlci0+cmVmZXJlbmNlX25vOwogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuIHZpZXdNUERGKCdwbXMuYmFja2VuZC5wYWdlcy5hY2NvdW50cy5lbnRyeS1saXN0LXByaW50JywgWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAkdGl0bGUsCiAgICAgICAgICAgICAgICAnc3lzdGVtQ3VycmVuY3knID0+IHN5c3RlbUN1cnJlbmN5KCksCiAgICAgICAgICAgICAgICAncHVyY2hhc2VPcmRlcicgPT4gJHB1cmNoYXNlT3JkZXIsCiAgICAgICAgICAgIF0sICR0aXRsZSwgJHRpdGxlKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBzdXBwbGllcldpc2VFbnRyeUxpc3QgYSBuZXcgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzdXBwbGllcldpc2VFbnRyeUxpc3QoKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdnZXQtc3VwcGxpZXJzJykpewogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oCiAgICAgICAgICAgICAgICAgICAgU3VwcGxpZXJzOjp3aGVyZSgnc3RhdHVzJywgJ0FjdGl2ZScpCiAgICAgICAgICAgICAgICAgICAgLT5oYXMoJ3JlbFF1b3RhdGlvbnMucmVsUHVyY2hhc2VPcmRlci5wdXJjaGFzZU9yZGVyRW50cmllcycpCiAgICAgICAgICAgICAgICAgICAgLT53aGVyZUhhcygncmVsUGF5bWVudHMucmVsUHVyY2hhc2VPcmRlci5Vbml0JywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2NvbXBhbnlfaWQnLCByZXF1ZXN0KCktPmdldCgnY29tcGFueV9pZCcpKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+Z2V0KFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2lkJywgJ25hbWUnLCAnY29kZScKICAgICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGZyb21fZGF0ZSA9IHJlcXVlc3QoKS0+aGFzKCdmcm9tX2RhdGUnKSAmJiAhZW1wdHkocmVxdWVzdCgpLT5nZXQoJ2Zyb21fZGF0ZScpKSA/IGRhdGUoIlktbS1kIiwgc3RydG90aW1lKHJlcXVlc3QoKS0+Z2V0KCdmcm9tX2RhdGUnKSkpIDogZGF0ZSgiWS1tLWQiLCBzdHJ0b3RpbWUoZGF0ZSgnWS1tLTAxJykpKTsKICAgICAgICAgICAgJHRvX2RhdGUgPSByZXF1ZXN0KCktPmhhcygndG9fZGF0ZScpICYmICFlbXB0eShyZXF1ZXN0KCktPmdldCgndG9fZGF0ZScpKSA/IGRhdGUoIlktbS1kIiwgc3RydG90aW1lKHJlcXVlc3QoKS0+Z2V0KCd0b19kYXRlJykpKSA6IGRhdGUoIlktbS1kIiwgc3RydG90aW1lKGRhdGUoJ1ktbS10JykpKTsKICAgICAgICAgICAgJGNvbXBhbnlfaWQgPSByZXF1ZXN0KCktPmhhcygnY29tcGFueV9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ2NvbXBhbnlfaWQnKSA6IG51bGw7CiAgICAgICAgICAgICRzdXBwbGllcl9pZCA9IHJlcXVlc3QoKS0+aGFzKCdzdXBwbGllcl9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ3N1cHBsaWVyX2lkJykgOiBudWxsOwogICAgICAgICAgICAkc2VsZWN0ZWRfc3VwcGxpZXIgPSBTdXBwbGllcnM6OmZpbmQoJHN1cHBsaWVyX2lkKTsKCiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGF0YWJsZXM6Om9mKAogICAgICAgICAgICAgICAgICAgIFB1cmNoYXNlT3JkZXI6OndpdGgoWwogICAgICAgICAgICAgICAgICAgICAgICAncmVsUXVvdGF0aW9uJywKICAgICAgICAgICAgICAgICAgICAgICAgJ3JlbFF1b3RhdGlvbi5yZWxTdXBwbGllcnMnLAogICAgICAgICAgICAgICAgICAgICAgICAncmVsUXVvdGF0aW9uLmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScKICAgICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmVIYXMoJ1VuaXQuY29tcGFueS51c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd1c2VyX2lkJywgYXV0aCgpLT51c2VyKCktPmlkKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmVIYXMoJ3B1cmNoYXNlT3JkZXJFbnRyaWVzJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZVJhdygncHVyY2hhc2Vfb3JkZXJzLmlkPXB1cmNoYXNlX29yZGVyX2VudHJpZXMucHVyY2hhc2Vfb3JkZXJfaWQnKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+d2hlbihpc3NldCgkc3VwcGxpZXJfaWQpLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkc3VwcGxpZXJfaWQpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRzdXBwbGllcl9pZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnc3VwcGxpZXJfaWQnLCAkc3VwcGxpZXJfaWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmVCZXR3ZWVuKCdwb19kYXRlJywgWyRmcm9tX2RhdGUsICR0b19kYXRlXSkKICAgICAgICAgICAgICAgICAgICAtPndoZW4oIWRhdGF0YWJsZU9yZGVyaW5nKCksIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2lkJywgJ2Rlc2MnKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLT5hZGRJbmRleENvbHVtbigpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjb21wYW55JywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCR2YWx1ZXMtPlVuaXQtPmNvbXBhbnktPmNvZGUpID8gJHZhbHVlcy0+VW5pdC0+Y29tcGFueS0+Y29kZSA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdjb21wYW55JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnVW5pdC5jb21wYW55JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2NvZGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3BvX2RhdGUnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZSgnZC1NLVknLCBzdHJ0b3RpbWUoJHZhbHVlcy0+cG9fZGF0ZSkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdyZWZlcmVuY2Vfbm8nLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKSIgb25jbGljaz0icHVyY2hhc2VPcmRlckRldGFpbHMoJCh0aGlzKSkiIGNsYXNzPSJidG4gYnRuLWxpbmsgc2hvd1BPRGV0YWlscyIgZGF0YS1zcmM9Iicucm91dGUoJ3Btcy5wdXJjaGFzZS5vcmRlci1saXN0LnNob3cnLCR2YWx1ZXMtPmlkKS4nIj4nLiR2YWx1ZXMtPnJlZmVyZW5jZV9uby4nPC9hPic7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3JlZmVyZW5jZV9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3JlZmVyZW5jZV9ubycsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3N1cHBsaWVycycsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24pID8gKGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVsU3VwcGxpZXJzLT5uYW1lKSA/ICR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVsU3VwcGxpZXJzLT5uYW1lLicgKCcuJHZhbHVlcy0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPmNvZGUuJyknIDogJycpIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3N1cHBsaWVycycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5LiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdxdW90YXRpb25fcmVmX25vJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+cmVmZXJlbmNlX25vKT8kdmFsdWVzLT5yZWxRdW90YXRpb24tPnJlZmVyZW5jZV9ubzonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncXVvdGF0aW9uX3JlZl9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgncmVmZXJlbmNlX25vJywgJ0xJS0UnLCAnJScuJGtleS4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjdXJyZW5jeScsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkdmFsdWVzLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPmNvZGUpPyR2YWx1ZXMtPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+Y29kZTonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3JlbFF1b3RhdGlvbi5leGNoYW5nZVJhdGUuY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScuJGtleS4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3RvdGFsX3ByaWNlJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbURvdWJsZVZhbHVlKCR2YWx1ZXMtPnRvdGFsX3ByaWNlKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmVkaXRDb2x1bW4oJ3ZhdCcsIGZ1bmN0aW9uKCR2YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBzeXN0ZW1Eb3VibGVWYWx1ZSgkdmFsdWVzLT52YXQsIDIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbignZ3Jvc3NfcHJpY2UnLCBmdW5jdGlvbigkdmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3lzdGVtRG91YmxlVmFsdWUoJHZhbHVlcy0+Z3Jvc3NfcHJpY2UsIDIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24oJHZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iJy5yb3V0ZSgncG1zLmFjY291bnRzLnBvLndpc2UuZW50cnkuc2hvdycsJHZhbHVlcy0+aWQpLicvcHJpbnQiICB0aXRsZT0iUHJpbnQgQWxsIFRyYW5zYWN0aW9ucyIgY2xhc3M9ImJ0biBtYi0xIGJ0bi14cyBidG4tc3VjY2VzcyI+PGkgY2xhc3M9ImxhcyBsYS1wcmludCI+PC9pPlByaW50PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgdGFyZ2V0PSJfX2JsYW5rIiBocmVmPSInLnJvdXRlKCdwbXMuYWNjb3VudHMucG8ud2lzZS5lbnRyeS5zaG93JywkdmFsdWVzLT5pZCkuJyIgIHRpdGxlPSJFbnRyeSBMaXN0IiBjbGFzcz0iYnRuIG1iLTEgYnRuLXhzIGJ0bi1pbmZvIj48aSBjbGFzcz0ibGFyIGxhLXBsdXMtc3F1YXJlIj48L2k+RW50cmllczwvYT4nOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbJ2RhdGUnLCAncmVmZXJlbmNlX25vJywgJ3RvdGFsX3ByaWNlJywgJ3ZhdCcsICdncm9zc19wcmljZScsICdhY3Rpb25zJ10pCiAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnU3VwcGxpZXIgV2lzZSBFbnRyeSBMaXN0JywKICAgICAgICAgICAgICAgICdjb21wYW5pZXMnID0+IENvbXBhbnk6OmhhcygncHJvZml0Q2VudHJlcy5jb3N0Q2VudHJlcycpCiAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCd1c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3VzZXJfaWQnLCBhdXRoKCktPnVzZXIoKS0+aWQpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+Z2V0KCksCiAgICAgICAgICAgICAgICAnY29tcGFueV9pZCcgPT4gJGNvbXBhbnlfaWQsCiAgICAgICAgICAgICAgICAnZnJvbV9kYXRlJyA9PiAkZnJvbV9kYXRlLAogICAgICAgICAgICAgICAgJ3RvX2RhdGUnID0+ICR0b19kYXRlLAogICAgICAgICAgICAgICAgJ3N1cHBsaWVyX2lkJyA9PiAkc3VwcGxpZXJfaWQsCiAgICAgICAgICAgICAgICAnc2VsZWN0ZWRfc3VwcGxpZXInID0+ICRzZWxlY3RlZF9zdXBwbGllciwKICAgICAgICAgICAgICAgICdoZWFkZXJDb2x1bW5zJyA9PiAkdGhpcy0+aGVhZGVyQ29sdW1ucygpLAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLmFjY291bnRzLnN1cHBsaWVyLXdpc2UtZW50cnktbGlzdCcsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9Cn0K