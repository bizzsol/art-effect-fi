<?php
bolt_decrypt( __FILE__ , 'Ly5HyE'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xBdHRyaWJ1dGU7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xBdHRyaWJ1dGVPcHRpb247CnVzZSBJbGx1bWluYXRlXFZhbGlkYXRpb25cUnVsZTsKdXNlIElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0Owp1c2UgRGF0YVRhYmxlczsKCmNsYXNzIEF0dHJpYnV0ZU9wdGlvbkNvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsgICAKCiAgICBwdWJsaWMgZnVuY3Rpb24gaGVhZGVyQ29sdW1ucygkdmFsdWU9JycpCiAgICB7CiAgICAgICAgcmV0dXJuIGFycmF5KAogICAgICAgICAgICBbJ1NMJywgJ1NMJ10sCiAgICAgICAgICAgIFsnYXR0cmlidXRlX2NvZGUnLCAnYXR0cmlidXRlX2NvZGUnXSwKICAgICAgICAgICAgWydhdHRyaWJ1dGVfbmFtZScsICdhdHRyaWJ1dGVfbmFtZSddLAogICAgICAgICAgICBbJ25hbWUnLCAnbmFtZScsICd0ZXh0LWxlZnQnXSwKICAgICAgICAgICAgWydkZXNjcmlwdGlvbicsICdkZXNjcmlwdGlvbicsICd0ZXh0LWxlZnQnXSwgCiAgICAgICAgICAgIFsnYWN0aW9ucycsICdhY3Rpb25zJywgJ3RleHQtY2VudGVyJ10KICAgICAgICApOwogICAgfQogICAgCiAgICAvKioKICAgICAqIERpc3BsYXkgYSBsaXN0aW5nIG9mIHRoZSByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICB0cnkgewoKICAgICAgICAgICAgJGF0dHJpYnV0ZU9wdGlvbnMgPSBBdHRyaWJ1dGVPcHRpb246OndpdGgoJ2F0dHJpYnV0ZScpLT53aGVyZSgnYXR0cmlidXRlX2lkJywgcmVxdWVzdCgpLT5nZXQoJ2F0dHJpYnV0ZV9pZCcpKS0+d2hlbighZGF0YXRhYmxlT3JkZXJpbmcoKSwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2lkJywgJ2Rlc2MnKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAkb3B0aW9ucz1bCiAgICAgICAgICAgICAgICAnQWNjb3VudHMnPT5hdXRoKCktPnVzZXIoKS0+aGFzUm9sZSgnQWNjb3VudHMnKSwKICAgICAgICAgICAgICAgICdhdHRyaWJ1dGUtb3B0aW9uLWVkaXQnPT5hdXRoKCktPnVzZXIoKS0+aGFzUGVybWlzc2lvblRvKCdhdHRyaWJ1dGUtb3B0aW9uLWVkaXQnKSwKICAgICAgICAgICAgICAgICdhdHRyaWJ1dGUtb3B0aW9uLWRlbGV0ZSc9PmF1dGgoKS0+dXNlcigpLT5oYXNQZXJtaXNzaW9uVG8oJ2F0dHJpYnV0ZS1vcHRpb24tZGVsZXRlJykKICAgICAgICAgICAgXTsKCiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewoKICAgICAgICAgICAgICAgIHJldHVybiBEYXRhdGFibGVzOjpvZigkYXR0cmlidXRlT3B0aW9ucykKICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2F0dHJpYnV0ZV9jb2RlJywgZnVuY3Rpb24oJG9wdGlvbil7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRvcHRpb24tPmF0dHJpYnV0ZS0+Y29kZSk/JG9wdGlvbi0+YXR0cmlidXRlLT5jb2RlOicnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhdHRyaWJ1dGVfY29kZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2F0dHJpYnV0ZScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYXR0cmlidXRlX25hbWUnLCBmdW5jdGlvbigkb3B0aW9uKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJG9wdGlvbi0+YXR0cmlidXRlLT5uYW1lKT8kb3B0aW9uLT5hdHRyaWJ1dGUtPm5hbWU6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2F0dHJpYnV0ZV9uYW1lJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYXR0cmlidXRlJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24oJG9wdGlvbikgdXNlKCRvcHRpb25zKXsKICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyA9ICcnOwogICAgICAgICAgICAgICAgICAgIGlmKCEkb3B0aW9uc1snQWNjb3VudHMnXSl7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRvcHRpb25zWydhdHRyaWJ1dGUtb3B0aW9uLWVkaXQnXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3Mgcm91bmRlZC1jaXJjbGUgbWwtMiIgaHJlZj0iJy4gdXJsKCdwbXMvcHJvZHVjdC1tYW5hZ2VtZW50L2F0dHJpYnV0ZS1vcHRpb25zLycuJG9wdGlvbi0+aWQuJy9lZGl0JykuJyI+PGkgY2xhc3M9ImxhIGxhLWVkaXQiPjwvaT48L2E+JzsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZigkb3B0aW9uc1snYXR0cmlidXRlLW9wdGlvbi1kZWxldGUnXSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBjbGFzcz0iYnRuIGJ0bi14cyBidG4tZGFuZ2VyIG1sLTIiIGRhdGEtc3JjPSInLnJvdXRlKCdwbXMucHJvZHVjdC1tYW5hZ2VtZW50LmF0dHJpYnV0ZS1vcHRpb25zLmRlc3Ryb3knLCAkb3B0aW9uLT5pZCkuJyIgb25jbGljaz0iZGVsZXRlRnJvbUNSVUQoJCh0aGlzKSkiPjxpIGNsYXNzPSJsYSBsYS10cmFzaCI+PC9pPjwvYT4nOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRhY3Rpb25zOwoKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPnJhd0NvbHVtbnMoWydhY3Rpb25zJ10pCiAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAiQXR0cmlidXRlIE9wdGlvbnMiLAogICAgICAgICAgICAgICAgJ2F0dHJpYnV0ZXMnID0+IEF0dHJpYnV0ZTo6YWxsKCksCiAgICAgICAgICAgICAgICAnaGVhZGVyQ29sdW1ucycgPT4gJHRoaXMtPmhlYWRlckNvbHVtbnMoKQogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuYXR0cmlidXRlcy5vcHRpb25zLmluZGV4JywgJGRhdGEpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNob3cgdGhlIGZvcm0gZm9yIGNyZWF0aW5nIGEgbmV3IHJlc291cmNlLgogICAgICoKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gY3JlYXRlKCkKICAgIHsKICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgJ3RpdGxlJyA9PiAiTmV3IEF0dHJpYnV0ZSBPcHRpb24iLAogICAgICAgICAgICAnYXR0cmlidXRlcycgPT4gQXR0cmlidXRlOjphbGwoKSwKICAgICAgICBdOwogICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5hdHRyaWJ1dGVzLm9wdGlvbnMuY3JlYXRlJywgJGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgYSBuZXdseSBjcmVhdGVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgJHRoaXMtPnZhbGlkYXRlKCRyZXF1ZXN0LCBbCiAgICAgICAgICAgICdhdHRyaWJ1dGVfaWQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICduYW1lJyA9PiBbJ3JlcXVpcmVkJywgJ3N0cmluZycsICdtYXg6MjU1J10sCiAgICAgICAgXSk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJHNlYXJjaCA9IEF0dHJpYnV0ZU9wdGlvbjo6d2hlcmUoJ2F0dHJpYnV0ZV9pZCcsICRyZXF1ZXN0LT5hdHRyaWJ1dGVfaWQpLT53aGVyZSgnbmFtZScsICRyZXF1ZXN0LT5uYW1lKS0+Zmlyc3QoKTsKICAgICAgICAgICAgaWYoaXNzZXQoJHNlYXJjaC0+aWQpKXsKICAgICAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigiQXR0cmlidXRlIE9wdGlvbiAjIi4kcmVxdWVzdC0+bmFtZS4nIGFscmVhZHkgZXhpc3RzIGZvciBBdHRyaWJ1dGUgIycuQXR0cmlidXRlOjpmaW5kKCRyZXF1ZXN0LT5hdHRyaWJ1dGVfaWQpLT5uYW1lKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgQXR0cmlidXRlT3B0aW9uOjpjcmVhdGUoJHJlcXVlc3QtPmFsbCgpKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoJ0F0dHJpYnV0ZSBPcHRpb24gY3JlYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBEaXNwbGF5IHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzaG93KEF0dHJpYnV0ZU9wdGlvbiAkYXR0cmlidXRlT3B0aW9uKQogICAgewogICAgICAgIAogICAgfQoKICAgIC8qKgogICAgICogU2hvdyB0aGUgZm9ybSBmb3IgZWRpdGluZyB0aGUgc3BlY2lmaWVkIHJlc291cmNlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZWRpdCgkaWQpCiAgICB7CiAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICd0aXRsZScgPT4gIkVkaXQgQXR0cmlidXRlIE9wdGlvbiIsCiAgICAgICAgICAgICdhdHRyaWJ1dGVzJyA9PiBBdHRyaWJ1dGU6OmFsbCgpLAogICAgICAgICAgICAnYXR0cmlidXRlT3B0aW9uJyA9PiBBdHRyaWJ1dGVPcHRpb246OmZpbmQoJGlkKSwKICAgICAgICBdOwogICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5hdHRyaWJ1dGVzLm9wdGlvbnMuZWRpdCcsICRkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgc3BlY2lmaWVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCBBdHRyaWJ1dGVPcHRpb24gJGF0dHJpYnV0ZU9wdGlvbikKICAgIHsKICAgICAgICAkdGhpcy0+dmFsaWRhdGUoJHJlcXVlc3QsIFsKICAgICAgICAgICAgJ2F0dHJpYnV0ZV9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ25hbWUnID0+IFsncmVxdWlyZWQnLCAnc3RyaW5nJywgJ21heDoyNTUnXSwKICAgICAgICBdKTsKICAgICAgICB0cnkgewogICAgICAgICAgICAkc2VhcmNoID0gQXR0cmlidXRlT3B0aW9uOjp3aGVyZSgnYXR0cmlidXRlX2lkJywgJHJlcXVlc3QtPmF0dHJpYnV0ZV9pZCktPndoZXJlKCduYW1lJywgJHJlcXVlc3QtPm5hbWUpLT53aGVyZSgnaWQnLCAnIT0nLCAkYXR0cmlidXRlT3B0aW9uLT5pZCktPmZpcnN0KCk7CiAgICAgICAgICAgIGlmKGlzc2V0KCRzZWFyY2gtPmlkKSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoIkF0dHJpYnV0ZSBPcHRpb24gIyIuJHJlcXVlc3QtPm5hbWUuJyBhbHJlYWR5IGV4aXN0cyBmb3IgQXR0cmlidXRlICMnLkF0dHJpYnV0ZTo6ZmluZCgkcmVxdWVzdC0+YXR0cmlidXRlX2lkKS0+bmFtZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRhdHRyaWJ1dGVPcHRpb24tPmZpbGwoJHJlcXVlc3QtPmFsbCgpKS0+c2F2ZSgpOwogICAgICAgICAgICAvL3JldHVybiAkdGhpcy0+YmFja1dpdGhTdWNjZXNzKCdBdHRpYnV0ZSBPcHRpb24gdXBkYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT51cmxSZWRpcmVjdEJhY2soJ0F0dGlidXRlIE9wdGlvbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsJ3Btcy9wcm9kdWN0LW1hbmFnZW1lbnQvYXR0cmlidXRlLW9wdGlvbnM/YXR0cmlidXRlX2lkPScuJHJlcXVlc3QtPmF0dHJpYnV0ZV9pZCwnc3VjY2VzcycpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFJlbW92ZSB0aGUgc3BlY2lmaWVkIHJlc291cmNlIGZyb20gc3RvcmFnZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGRlc3Ryb3koQXR0cmlidXRlT3B0aW9uICRhdHRyaWJ1dGVPcHRpb24pCiAgICB7CiAgICAgICAgdHJ5IHsKCiAgICAgICAgICAgIGlmICgkYXR0cmlidXRlT3B0aW9uLT5wcm9kdWN0cy0+Y291bnQoKSA+IDApIHsKICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAnQXR0cmlidXRlIG9wdGlvbiBjYW4gbm90IGJlIGRlbGV0ZWQuJwogICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRhdHRyaWJ1dGVPcHRpb24tPmRlbGV0ZSgpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAiQXR0cmlidXRlIE9wdGlvbiBoYXMgYmVlbiBkZWxldGVkIgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KfQo=