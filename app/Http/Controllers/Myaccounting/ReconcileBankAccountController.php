<?php
bolt_decrypt( __FILE__ , 'PAcyPC'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQmFua0FjY291bnQ7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ3VycmVuY3lUeXBlOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEN1cnJlbmN5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5SXRlbTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xCYW5rUmVjb25jaWxpYXRpb25TdGF0ZW1lbnQ7Cgp1c2UgQXBwXEltcG9ydHNcQWNjb3VudGluZ1xCYW5rU3RhdGVtZW50SW1wb3J0Owp1c2UgTWFhdHdlYnNpdGVcRXhjZWxcRmFjYWRlc1xFeGNlbDsKCnVzZSBBcHAsIERCOwp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XEZhY2FkZXNcQXV0aDsKCmNsYXNzIFJlY29uY2lsZUJhbmtBY2NvdW50Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICAkdGl0bGUgPSAnUmVjb25jaWxlIEJhbmsgQWNjb3VudCc7CiAgICAgICAgCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGJhbmtBY2NvdW50ID0gQmFua0FjY291bnQ6OndpdGgoWwogICAgICAgICAgICAgICAgJ2N1cnJlbmN5JwogICAgICAgICAgICBdKS0+ZmluZChyZXF1ZXN0KCktPmdldCgnYmFua19hY2NvdW50X2lkJykpOwogICAgICAgICAgICAkZGF0ZSA9IHJlcXVlc3QoKS0+aGFzKCdkYXRlJykgJiYgc3RydG90aW1lKHJlcXVlc3QoKS0+Z2V0KCdkYXRlJykpID4gMCA/IHJlcXVlc3QoKS0+Z2V0KCdkYXRlJykgOiBkYXRlKCdZLW0tZCcpOwogICAgICAgICAgICAkYWNjb3VudHMgPSBbaXNzZXQoJGJhbmtBY2NvdW50LT5jaGFydF9vZl9hY2NvdW50X2lkKSA/ICRiYW5rQWNjb3VudC0+Y2hhcnRfb2ZfYWNjb3VudF9pZCA6IDBdOwoKICAgICAgICAgICAgJGJvb2tCYWxhbmNlID0gJHRoaXMtPmJvb2tCYWxhbmNlKCRkYXRlLCAkYWNjb3VudHMpOwoKICAgICAgICAgICAgJGNvZGUgPSAnJzsKICAgICAgICAgICAgaWYoaXNzZXQoJGJhbmtBY2NvdW50LT5pZCkpewogICAgICAgICAgICAgICAgJGNvZGUgPSBlbnRyeVVuaXF1ZUNvZGUoc3RybGVuKCRiYW5rQWNjb3VudC0+Y29kZSkrNiwgJGJhbmtBY2NvdW50LT5jb2RlLictJywgJ2JhbmtfcmVjb25jaWxpYXRpb25fc3RhdGVtZW50cycsICdjb2RlJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAkdGl0bGUsCiAgICAgICAgICAgICAgICAnYmFua0FjY291bnRzJyA9PiBCYW5rQWNjb3VudDo6d2l0aChbJ2N1cnJlbmN5J10pLT5nZXQoKSwKICAgICAgICAgICAgICAgICdjb3N0Q2VudHJlcycgPT4gZ2V0Q29zdENlbnRyZXMoKSwKICAgICAgICAgICAgICAgICdiYW5rQWNjb3VudCcgPT4gJGJhbmtBY2NvdW50LAogICAgICAgICAgICAgICAgJ2FjY291bnRzJyA9PiAkYWNjb3VudHMsCiAgICAgICAgICAgICAgICAnZGF0ZScgPT4gJGRhdGUsCiAgICAgICAgICAgICAgICAnZGViaXQnID0+ICRib29rQmFsYW5jZVsnZGViaXQnXSwKICAgICAgICAgICAgICAgICdjcmVkaXQnID0+ICRib29rQmFsYW5jZVsnY3JlZGl0J10sCiAgICAgICAgICAgICAgICAnYmFsYW5jZScgPT4gJGJvb2tCYWxhbmNlWydiYWxhbmNlJ10sCiAgICAgICAgICAgICAgICAnY29kZScgPT4gJGNvZGUsCiAgICAgICAgICAgICAgICAnZW50cmllcycgPT4gRW50cnk6OndpdGgoWwogICAgICAgICAgICAgICAgICAgICdpdGVtcycsCiAgICAgICAgICAgICAgICAgICAgJ2VudHJ5VHlwZScsCiAgICAgICAgICAgICAgICAgICAgJ3B1cmNoYXNlT3JkZXInLAogICAgICAgICAgICAgICAgICAgICdleGNoYW5nZVJhdGUuY3VycmVuY3knCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgLT53aGVyZUhhcygnaXRlbXMnLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkYWNjb3VudHMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlTnVsbCgncmVjb25jaWxpYXRpb25fZGF0ZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVJbignY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRhY2NvdW50cyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT53aGVyZSgnZGF0ZScsICc8PScsICRkYXRlKQogICAgICAgICAgICAgICAgLT5nZXQoKQogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnJlY29uY2lsZUJhbmtBY2NvdW50LmluZGV4JywgJGRhdGEpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gYm9va0JhbGFuY2UoJGRhdGUsICRhY2NvdW50cykKICAgIHsKICAgICAgICAkZGViaXQgPSBFbnRyeUl0ZW06OndoZXJlSGFzKCdlbnRyeScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRkYXRlKXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2RhdGUnLCAnPD0nLCAkZGF0ZSk7CiAgICAgICAgfSkKICAgICAgICAtPndoZXJlTm90TnVsbCgncmVjb25jaWxpYXRpb25fZGF0ZScpCiAgICAgICAgLT53aGVyZUluKCdjaGFydF9vZl9hY2NvdW50X2lkJywgJGFjY291bnRzKQogICAgICAgIC0+d2hlcmUoJ2RlYml0X2NyZWRpdCcsICdEJykKICAgICAgICAtPnN1bSgnYW1vdW50Jyk7CgogICAgICAgICRjcmVkaXQgPSBFbnRyeUl0ZW06OndoZXJlSGFzKCdlbnRyeScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRkYXRlKXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2RhdGUnLCAnPD0nLCAkZGF0ZSk7CiAgICAgICAgfSkKICAgICAgICAtPndoZXJlTm90TnVsbCgncmVjb25jaWxpYXRpb25fZGF0ZScpCiAgICAgICAgLT53aGVyZUluKCdjaGFydF9vZl9hY2NvdW50X2lkJywgJGFjY291bnRzKQogICAgICAgIC0+d2hlcmUoJ2RlYml0X2NyZWRpdCcsICdDJykKICAgICAgICAtPnN1bSgnYW1vdW50Jyk7CgogICAgICAgICRiYWxhbmNlID0gc3lzdGVtRG91YmxlVmFsdWUoJGRlYml0LSRjcmVkaXQsIDIpOwoKICAgICAgICByZXR1cm4gWwogICAgICAgICAgICAnZGViaXQnID0+ICRkZWJpdCwKICAgICAgICAgICAgJ2NyZWRpdCcgPT4gJGNyZWRpdCwKICAgICAgICAgICAgJ2JhbGFuY2UnID0+ICRiYWxhbmNlLAogICAgICAgIF07CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNyZWF0ZSgpCiAgICB7CiAgICAgICAgCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgJ2JhbmtfYWNjb3VudF9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2RhdGUnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdlbnRyaWVzJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnZW50cmllcy4qJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnZGViaXRzJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnY3JlZGl0cycgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgLy8gJ2JhbmtfYmFsYW5jZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2JhbmtfY2hhcmdlcycgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgLy8gJ2ZpbGUnID0+ICdyZXF1aXJlZHxtaW1lczp4bHN4LCB4bHMnLAogICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+ICdyZXF1aXJlZCcKICAgICAgICBdKTsKCiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CgogICAgICAgICAgICAkYmFua0FjY291bnQgPSBCYW5rQWNjb3VudDo6ZmluZCgkcmVxdWVzdC0+YmFua19hY2NvdW50X2lkKTsKICAgICAgICAgICAgJGFjY291bnRzID0gW2lzc2V0KCRiYW5rQWNjb3VudC0+Y2hhcnRfb2ZfYWNjb3VudF9pZCkgPyAkYmFua0FjY291bnQtPmNoYXJ0X29mX2FjY291bnRfaWQgOiAwXTsKICAgICAgICAgICAgJGJvb2tCYWxhbmNlID0gJHRoaXMtPmJvb2tCYWxhbmNlKCRyZXF1ZXN0LT5kYXRlLCAkYWNjb3VudHMpWydiYWxhbmNlJ107CiAgICAgICAgICAgICRleGNoYW5nZV9yYXRlX2lkID0gZ2V0RXhjaGFuZ2VSYXRlcygkYmFua0FjY291bnQtPmN1cnJlbmN5X2lkLCAkcmVxdWVzdC0+ZGF0ZSwgZGF0ZSgnSDppOnMnKSlbJ3JhdGUnXS0+aWQ7CgogICAgICAgICAgICAkZGF0YSA9IFtdOwogICAgICAgICAgICBpZigkcmVxdWVzdC0+aGFzRmlsZSgnZmlsZScpKXsKICAgICAgICAgICAgICAgICRzaGVldHMgPSBFeGNlbDo6dG9BcnJheShuZXcgQmFua1N0YXRlbWVudEltcG9ydCwgJHJlcXVlc3QtPmZpbGUpOwogICAgICAgICAgICAgICAgaWYoaXNzZXQoJHNoZWV0c1swXSkpewogICAgICAgICAgICAgICAgICAgIGZvcmVhY2goJHNoZWV0cyBhcyAkc2hlZXQpewogICAgICAgICAgICAgICAgICAgICAgICAkZGF0YSA9IGNvbGxlY3QoJHNoZWV0KS0+d2hlcmVOb3ROdWxsKCdyZWNlaXB0X251bWJlcicpLT5rZXlCeSgncmVjZWlwdF9udW1iZXInKS0+dG9BcnJheSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJHJlY29uY2lsbGVkID0gRW50cnk6OndoZXJlSW4oJ251bWJlcicsIGFycmF5X2tleXMoJGRhdGEpKQogICAgICAgICAgICAtPndoZXJlSGFzKCdpdGVtcycsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRhY2NvdW50cyl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZU5vdE51bGwoJ3JlY29uY2lsaWF0aW9uX2RhdGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVJbignY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRhY2NvdW50cyk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlcmUoJ2RhdGUnLCAnPD0nLCAkcmVxdWVzdC0+ZGF0ZSkKICAgICAgICAgICAgLT5jb3VudCgpOwoKICAgICAgICAgICAgaWYoJHJlY29uY2lsbGVkID4gMCl7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAiU29ycnkhIFRoZXJlIGFyZSBzb21lIGFscmVhZHkgcmVjb25jaWxsZWQgc3RhdG1lbnRzIGV4aXN0cyBpbiB0aGUgQmFuayBTdGF0ZW1lbnQgeW91IHVwbG9hZGVkISIKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkZW50cmllcyA9IEVudHJ5Ojp3aGVyZSgnZGF0ZScsICc8PScsICRyZXF1ZXN0LT5kYXRlKQogICAgICAgICAgICAtPndoZXJlSGFzKCdpdGVtcycsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRhY2NvdW50cyl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZU51bGwoJ3JlY29uY2lsaWF0aW9uX2RhdGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVJbignY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRhY2NvdW50cyk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+Z2V0KCk7CgogICAgICAgICAgICAkcmVjb25jaWxpbmdfZW50cmllcyA9IFtdOwogICAgICAgICAgICAkcGVuZGluZ19lbnRyaWVzID0gW107CiAgICAgICAgICAgICR0b3RhbF9kZWJpdCA9IDA7CiAgICAgICAgICAgICR0b3RhbF9jcmVkaXQgPSAwOwogICAgICAgICAgICBpZihpc3NldCgkZW50cmllc1swXSkpewogICAgICAgICAgICAgICAgZm9yZWFjaCgkZW50cmllcyBhcyAka2V5ID0+ICRlbnRyeSl7CiAgICAgICAgICAgICAgICAgICAgJGRlYml0ID0gJGVudHJ5LT5pdGVtcy0+d2hlcmVJbignY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRhY2NvdW50cyktPndoZXJlKCdkZWJpdF9jcmVkaXQnLCAnRCcpLT53aGVyZU51bGwoJ3JlY29uY2lsaWF0aW9uX2RhdGUnKS0+c3VtKCdhbW91bnQnKTsKICAgICAgICAgICAgICAgICAgICAkY3JlZGl0ID0gJGVudHJ5LT5pdGVtcy0+d2hlcmVJbignY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRhY2NvdW50cyktPndoZXJlKCdkZWJpdF9jcmVkaXQnLCAnQycpLT53aGVyZU51bGwoJ3JlY29uY2lsaWF0aW9uX2RhdGUnKS0+c3VtKCdhbW91bnQnKTsKCiAgICAgICAgICAgICAgICAgICAgaWYoaXNzZXQoJGRhdGFbJGVudHJ5LT5udW1iZXJdKSAmJiAkZGF0YVskZW50cnktPm51bWJlcl1bJ2RlYml0J10gPT0gJGNyZWRpdCAmJiAkZGF0YVskZW50cnktPm51bWJlcl1bJ2NyZWRpdCddID09ICRkZWJpdCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJHJlY29uY2lsaW5nX2VudHJpZXMsICRlbnRyeS0+aWQpOwogICAgICAgICAgICAgICAgICAgICAgICAkdG90YWxfZGViaXQgKz0gJGRlYml0OwogICAgICAgICAgICAgICAgICAgICAgICAkdG90YWxfY3JlZGl0ICs9ICRjcmVkaXQ7CiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJHBlbmRpbmdfZW50cmllcywgJGVudHJ5LT5pZCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyByZXR1cm4gWwogICAgICAgICAgICAvLyAgICAgJ2Jvb2tCYWxhbmNlJyA9PiAkYm9va0JhbGFuY2UsCiAgICAgICAgICAgIC8vICAgICAncmVjb25jaWxpbmdfZW50cmllcycgPT4gJHJlY29uY2lsaW5nX2VudHJpZXMsCiAgICAgICAgICAgIC8vICAgICAncGVuZGluZ19lbnRyaWVzJyA9PiAkcGVuZGluZ19lbnRyaWVzLAogICAgICAgICAgICAvLyAgICAgJ3RvdGFsX2RlYml0JyA9PiAkdG90YWxfZGViaXQsCiAgICAgICAgICAgIC8vICAgICAndG90YWxfY3JlZGl0JyA9PiAkdG90YWxfY3JlZGl0LAogICAgICAgICAgICAvLyBdOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gJHJlY19kZWJpdCA9IDA7CiAgICAgICAgICAgIC8vICRyZWNfY3JlZGl0ID0gMDsKICAgICAgICAgICAgLy8gZm9yZWFjaCgkcmVxdWVzdC0+ZW50cmllcyBhcyAka2V5ID0+ICRlbnRyeV9pZCl7CiAgICAgICAgICAgIC8vICAgICAkcmVjX2RlYml0ICs9ICRyZXF1ZXN0LT5kZWJpdHNbJGVudHJ5X2lkXTsKICAgICAgICAgICAgLy8gICAgICRyZWNfY3JlZGl0ICs9ICRyZXF1ZXN0LT5jcmVkaXRzWyRlbnRyeV9pZF07CiAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgICRyZWNfYW1vdW50ID0gKCR0b3RhbF9kZWJpdC0kdG90YWxfY3JlZGl0KTsKICAgICAgICAgICAgJGRpZmYgPSBzeXN0ZW1Eb3VibGVWYWx1ZSgoKCgkYm9va0JhbGFuY2UrJHJlcXVlc3QtPmJhbmtfaW50ZXJlc3RfZWFybmVkKyRyZWNfYW1vdW50KS0kcmVxdWVzdC0+YmFua19iYWxhbmNlKS0kcmVxdWVzdC0+YmFua19jaGFyZ2VzKSwgMik7CgogICAgICAgICAgICAvLyByZXR1cm4gWwogICAgICAgICAgICAvLyAgICAgJ2Jvb2tCYWxhbmNlJyA9PiAkYm9va0JhbGFuY2UsCiAgICAgICAgICAgIC8vICAgICAncmVjX2RlYml0JyA9PiAkdG90YWxfZGViaXQsCiAgICAgICAgICAgIC8vICAgICAncmVjX2NyZWRpdCcgPT4gJHRvdGFsX2NyZWRpdCwKICAgICAgICAgICAgLy8gICAgICdyZWNfYW1vdW50JyA9PiAkcmVjX2Ftb3VudCwKICAgICAgICAgICAgLy8gICAgICdiYW5rX2JhbGFuY2UnID0+ICRyZXF1ZXN0LT5iYW5rX2JhbGFuY2UsCiAgICAgICAgICAgIC8vICAgICAnYmFua19jaGFyZ2VzJyA9PiAkcmVxdWVzdC0+YmFua19jaGFyZ2VzLAogICAgICAgICAgICAvLyAgICAgJ2RpZmYnID0+ICRkaWZmLAogICAgICAgICAgICAvLyBdOwoKICAgICAgICAgICAgLy8gaWYoJGRpZmYgPT0gMCl7CiAgICAgICAgICAgICAgICAvLyBmb3JlYWNoICgkcmVxdWVzdC0+ZW50cmllcyBhcyAka2V5ID0+ICRlbnRyeV9pZCkgewogICAgICAgICAgICAgICAgLy8gICAgIEVudHJ5SXRlbTo6d2hlcmUoJ2VudHJ5X2lkJywgJGVudHJ5X2lkKQogICAgICAgICAgICAgICAgLy8gICAgIC0+d2hlcmVOdWxsKCdyZWNvbmNpbGlhdGlvbl9kYXRlJykKICAgICAgICAgICAgICAgIC8vICAgICAtPndoZXJlSW4oJ2NoYXJ0X29mX2FjY291bnRfaWQnLCAkYWNjb3VudHMpCiAgICAgICAgICAgICAgICAvLyAgICAgLT51cGRhdGUoWwogICAgICAgICAgICAgICAgLy8gICAgICAgICAncmVjb25jaWxpYXRpb25fZGF0ZScgPT4gJHJlcXVlc3QtPmRhdGUsCiAgICAgICAgICAgICAgICAvLyAgICAgICAgICd1cGRhdGVkX2J5JyA9PiBhdXRoKCktPnVzZXIoKS0+aWQsCiAgICAgICAgICAgICAgICAvLyAgICAgICAgICd1cGRhdGVkX2F0JyA9PiBkYXRlKCdZLW0tZCBIOmk6cycpLAogICAgICAgICAgICAgICAgLy8gICAgIF0pOwogICAgICAgICAgICAgICAgLy8gfQoKICAgICAgICAgICAgICAgIEVudHJ5SXRlbTo6d2hlcmVJbignZW50cnlfaWQnLCAkcmVjb25jaWxpbmdfZW50cmllcykKICAgICAgICAgICAgICAgIC0+d2hlcmVOdWxsKCdyZWNvbmNpbGlhdGlvbl9kYXRlJykKICAgICAgICAgICAgICAgIC0+d2hlcmVJbignY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRhY2NvdW50cykKICAgICAgICAgICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgICAgICAgICAncmVjb25jaWxpYXRpb25fZGF0ZScgPT4gJHJlcXVlc3QtPmRhdGUsCiAgICAgICAgICAgICAgICAgICAgJ3VwZGF0ZWRfYnknID0+IGF1dGgoKS0+dXNlcigpLT5pZCwKICAgICAgICAgICAgICAgICAgICAndXBkYXRlZF9hdCcgPT4gZGF0ZSgnWS1tLWQgSDppOnMnKSwKICAgICAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgICAgIGlmKCRyZXF1ZXN0LT5iYW5rX2ludGVyZXN0X2Vhcm5lZCA+IDApewogICAgICAgICAgICAgICAgICAgICRpdGVtcyA9IGFycmF5KFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2lkJyA9PiAkcmVxdWVzdC0+Y29zdF9jZW50cmVfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiAkYmFua0FjY291bnQtPmNoYXJ0X29mX2FjY291bnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdkZWJpdCcgPT4gJHJlcXVlc3QtPmJhbmtfaW50ZXJlc3RfZWFybmVkLAogICAgICAgICAgICAgICAgICAgICAgICAnY3JlZGl0JyA9PiAwLAogICAgICAgICAgICAgICAgICAgICAgICAnbmFycmF0aW9uJyA9PiAnQmFuayBSZWNvbmNpbGxpYXRpb24gOjogQmFuayBJbnRlcmVzdCBFYXJuZWQgOjogQmFuayBBY2NvdW50IERlYml0JywKICAgICAgICAgICAgICAgICAgICBdLFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2lkJyA9PiAkcmVxdWVzdC0+Y29zdF9jZW50cmVfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiBhY2NvdW50RGVmYXVsdFNldHRpbmdzKClbJ2JhbmtfaW50ZXJlc3RfYWNjb3VudCddLAogICAgICAgICAgICAgICAgICAgICAgICAnZGViaXQnID0+IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICdjcmVkaXQnID0+ICRyZXF1ZXN0LT5iYW5rX2ludGVyZXN0X2Vhcm5lZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ25hcnJhdGlvbicgPT4gJ0JhbmsgUmVjb25jaWxsaWF0aW9uIDo6IEJhbmsgSW50ZXJlc3QgRWFybmVkIDo6IFJldmVudWUgQ3JlZGl0JywKICAgICAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICAgICAgJGVudHJ5ID0gc2F2ZUxlZGdlckVudHJpZXMoNSwgZGF0ZSgnWS1tLWQgSDppOnMnLCBzdHJ0b3RpbWUoJHJlcXVlc3QtPmRhdGUuJyAnLmRhdGUoJ0g6aTpzJykpKSwgMSwgJycsICdCYW5rIFJlY29uY2lsbGlhdGlvbiA6OiBCYW5rIEludGVyZXN0IEVhcm5lZCcsICRpdGVtcywgJGV4Y2hhbmdlX3JhdGVfaWQsIDAsIDAsIDAsIGdldENvc3RDZW50cmVDb21wYW55KCRyZXF1ZXN0LT5jb3N0X2NlbnRyZV9pZCkpOwogICAgICAgICAgICAgICAgICAgIGlmKCRlbnRyeVsnc3VjY2VzcyddKXsKICAgICAgICAgICAgICAgICAgICAgICAgRW50cnlJdGVtOjp3aGVyZSgnZW50cnlfaWQnLCAkZW50cnlbJ2VudHJ5J10tPmlkKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlKCdjaGFydF9vZl9hY2NvdW50X2lkJywgJGJhbmtBY2NvdW50LT5jaGFydF9vZl9hY2NvdW50X2lkKQogICAgICAgICAgICAgICAgICAgICAgICAtPnVwZGF0ZShbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmVjb25jaWxpYXRpb25fZGF0ZScgPT4gJHJlcXVlc3QtPmRhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXBkYXRlZF9ieScgPT4gYXV0aCgpLT51c2VyKCktPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3VwZGF0ZWRfYXQnID0+IGRhdGUoJ1ktbS1kIEg6aTpzJyksCiAgICAgICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZigkcmVxdWVzdC0+YmFua19jaGFyZ2VzID4gMCl7CiAgICAgICAgICAgICAgICAgICAgJGl0ZW1zID0gYXJyYXkoWwogICAgICAgICAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+ICRyZXF1ZXN0LT5jb3N0X2NlbnRyZV9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+ICRiYW5rQWNjb3VudC0+YmFua19jaGFyZ2VzX2FjY291bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICdkZWJpdCcgPT4gJHJlcXVlc3QtPmJhbmtfY2hhcmdlcywKICAgICAgICAgICAgICAgICAgICAgICAgJ2NyZWRpdCcgPT4gMCwKICAgICAgICAgICAgICAgICAgICAgICAgJ25hcnJhdGlvbicgPT4gJ0JhbmsgUmVjb25jaWxsaWF0aW9uIDo6IEJhbmsgQ2hhcmdlcyBQYXltZW50IDo6IEJhbmsgQ2hhcmdlcyBEZWJpdCcsCiAgICAgICAgICAgICAgICAgICAgXSxbCiAgICAgICAgICAgICAgICAgICAgICAgICdjb3N0X2NlbnRyZV9pZCcgPT4gJHJlcXVlc3QtPmNvc3RfY2VudHJlX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnY2hhcnRfb2ZfYWNjb3VudF9pZCcgPT4gJGJhbmtBY2NvdW50LT5jaGFydF9vZl9hY2NvdW50X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnZGViaXQnID0+IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICdjcmVkaXQnID0+ICRyZXF1ZXN0LT5iYW5rX2NoYXJnZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICduYXJyYXRpb24nID0+ICdCYW5rIFJlY29uY2lsbGlhdGlvbiA6OiBCYW5rIENoYXJnZXMgUGF5bWVudCA6OiBCYW5rIEFjY291bnQgQ3JlZGl0JywKICAgICAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICAgICAgICAkZW50cnkgPSBzYXZlTGVkZ2VyRW50cmllcyg0LCBkYXRlKCdZLW0tZCBIOmk6cycsIHN0cnRvdGltZSgkcmVxdWVzdC0+ZGF0ZS4nICcuZGF0ZSgnSDppOnMnKSkpLCAxLCAnJywgJ0JhbmsgUmVjb25jaWxsaWF0aW9uIDo6IEJhbmsgQ2hhcmdlcyBQYXltZW50JywgJGl0ZW1zLCAkZXhjaGFuZ2VfcmF0ZV9pZCwgMCwgMCwgMCwgZ2V0Q29zdENlbnRyZUNvbXBhbnkoJHJlcXVlc3QtPmNvc3RfY2VudHJlX2lkKSk7CiAgICAgICAgICAgICAgICAgICAgaWYoJGVudHJ5WydzdWNjZXNzJ10pewogICAgICAgICAgICAgICAgICAgICAgICBFbnRyeUl0ZW06OndoZXJlKCdlbnRyeV9pZCcsICRlbnRyeVsnZW50cnknXS0+aWQpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2NoYXJ0X29mX2FjY291bnRfaWQnLCAkYmFua0FjY291bnQtPmNoYXJ0X29mX2FjY291bnRfaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZWNvbmNpbGlhdGlvbl9kYXRlJyA9PiAkcmVxdWVzdC0+ZGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICd1cGRhdGVkX2J5JyA9PiBhdXRoKCktPnVzZXIoKS0+aWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXBkYXRlZF9hdCcgPT4gZGF0ZSgnWS1tLWQgSDppOnMnKSwKICAgICAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICAgICAkY29kZSA9ICcnOwogICAgICAgICAgICAgICAgaWYoaXNzZXQoJGJhbmtBY2NvdW50LT5pZCkpewogICAgICAgICAgICAgICAgICAgICRjb2RlID0gZW50cnlVbmlxdWVDb2RlKHN0cmxlbigkYmFua0FjY291bnQtPmNvZGUpKzYsICRiYW5rQWNjb3VudC0+Y29kZS4nLScsICdiYW5rX3JlY29uY2lsaWF0aW9uX3N0YXRlbWVudHMnLCAnY29kZScpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIEJhbmtSZWNvbmNpbGlhdGlvblN0YXRlbWVudDo6Y3JlYXRlKFsKICAgICAgICAgICAgICAgICAgICAnYmFua19hY2NvdW50X2lkJyA9PiAkYmFua0FjY291bnQtPmlkLAogICAgICAgICAgICAgICAgICAgICdjb2RlJyA9PiAkY29kZSwKICAgICAgICAgICAgICAgICAgICAnZGF0ZScgPT4gJHJlcXVlc3QtPmRhdGUsCiAgICAgICAgICAgICAgICAgICAgJ2Jvb2tfYmFsYW5jZScgPT4gJGJvb2tCYWxhbmNlLAogICAgICAgICAgICAgICAgICAgICdiYW5rX2ludGVyZXN0X2Vhcm5lZCcgPT4gJHJlcXVlc3QtPmJhbmtfaW50ZXJlc3RfZWFybmVkLAogICAgICAgICAgICAgICAgICAgICdiYW5rX2ludGVyZXN0X2Vhcm5lZF9uYXJyYXRpb24nID0+ICRyZXF1ZXN0LT5iYW5rX2ludGVyZXN0X2Vhcm5lZF9uYXJyYXRpb24sCiAgICAgICAgICAgICAgICAgICAgJ2JhbmtfYmFsYW5jZScgPT4gJGJvb2tCYWxhbmNlKyRyZXF1ZXN0LT5iYW5rX2ludGVyZXN0X2Vhcm5lZC0kcmVxdWVzdC0+YmFua19jaGFyZ2VzLAogICAgICAgICAgICAgICAgICAgICdyZWNvbmNpbGluZ19hbW91bnQnID0+ICRyZWNfYW1vdW50LAogICAgICAgICAgICAgICAgICAgICdiYW5rX2NoYXJnZXMnID0+ICRyZXF1ZXN0LT5iYW5rX2NoYXJnZXMsCiAgICAgICAgICAgICAgICAgICAgJ2JhbmtfY2hhcmdlc19uYXJyYXRpb24nID0+ICRyZXF1ZXN0LT5iYW5rX2NoYXJnZXNfbmFycmF0aW9uLAogICAgICAgICAgICAgICAgICAgICdkaWZmZXJlbmNlJyA9PiAkZGlmZiwKICAgICAgICAgICAgICAgICAgICAncmVjb25jaWxpbmdfZW50cmllcycgPT4ganNvbl9lbmNvZGUoJHJlY29uY2lsaW5nX2VudHJpZXMpLAogICAgICAgICAgICAgICAgICAgICdwZW5kaW5nX2VudHJpZXMnID0+IGpzb25fZW5jb2RlKCRwZW5kaW5nX2VudHJpZXMpLAogICAgICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgLy8gcmV0dXJuIFsKICAgICAgICAgICAgICAgIC8vICAgICAncmVjb25jaWxpbmdfZW50cmllcycgPT4gJHJlY29uY2lsaW5nX2VudHJpZXMsCiAgICAgICAgICAgICAgICAvLyAgICAgJ3BlbmRpbmdfZW50cmllcycgPT4gJHBlbmRpbmdfZW50cmllcywKICAgICAgICAgICAgICAgIC8vIF07CgogICAgICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICAgICAgc2Vzc2lvbigpLT5mbGFzaCgnbWVzc2FnZScsICJCYW5rIFJlY29uY2lsbGlhdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5IHdpdGggcmVmZXJlbmNlICMiLiRjb2RlKTsKICAgICAgICAgICAgICAgIHNlc3Npb24oKS0+Zmxhc2goJ2FsZXJ0LXR5cGUnLCAnc3VjY2VzcycpOwogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIC8vIH0KCiAgICAgICAgICAgIC8vIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgLy8gICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgLy8gICAgICdtZXNzYWdlJyA9PiAiVGhlIERpZmZlcmVuY2UgbXVzdCBiZSBaZXJvIHRvIGNvbXBsZXRlIHRoZSBSZWNvbmNpbGxpYXRpb24uIgogICAgICAgICAgICAvLyBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9Cn0K