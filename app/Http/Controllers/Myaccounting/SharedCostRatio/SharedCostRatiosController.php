<?php
bolt_decrypt( __FILE__ , 'sOY5kE'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nXFNoYXJlZENvc3RSYXRpbzsKCnVzZSBBcHBcSHR0cFxDb250cm9sbGVyc1xDb250cm9sbGVyOwp1c2UgSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3Q7Cgp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXENvbXBhbnk7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29zdENlbnRyZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDb3N0Q2VudHJlQWxsb2NhdGlvbjsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDb3N0Q2VudHJlQWxsb2NhdGlvblRhcmdldDsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xTaGFyZWRDb3N0UmF0aW87CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcU2hhcmVkQ29zdFJhdGlvRW50cnk7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ3VycmVuY3lUeXBlOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5SXRlbTsKdXNlIFxBcHBcVXNlcjsKdXNlIERCLCBEYXRhVGFibGVzOwoKY2xhc3MgU2hhcmVkQ29zdFJhdGlvc0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZSA9ICcnKQogICAgewogICAgICAgIHJldHVybiBhcnJheSgKICAgICAgICAgICAgWydTTCcsICdTTCddLAogICAgICAgICAgICBbJ2FsbG9jYXRpb25fbmFtZScsICdhbGxvY2F0aW9uX25hbWUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydhbGxvY2F0aW9uX2NvbXBhbnknLCAnYWxsb2NhdGlvbl9jb21wYW55JywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYWxsb2NhdGlvbl9jb3N0X2NlbnRyZScsICdhbGxvY2F0aW9uX2Nvc3RfY2VudHJlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYWxsb2NhdGlvbl9jaGFydF9vZl9hY2NvdW50JywgJ2FsbG9jYXRpb25fY2hhcnRfb2ZfYWNjb3VudCcsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2NvZGUnLCAnY29kZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2Rlc2NyaXB0aW9uJywgJ2Rlc2NyaXB0aW9uJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnZnJvbScsICdmcm9tJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsndG8nLCAndG8nLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydhbGxvY2F0aW9uJywgJ2FsbG9jYXRpb24nLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydiYWxhbmNlJywgJ2JhbGFuY2UnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydlbnRyaWVzJywgJ2VudHJpZXMnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydjcmVhdG9yJywgJ2NyZWF0b3InLCAndGV4dC1jZW50ZXInXSwKICAgICAgICApOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHJlcXVlc3QoKS0+YWpheCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVRhYmxlczo6b2YoCiAgICAgICAgICAgICAgICAgICAgICAgIFNoYXJlZENvc3RSYXRpbzo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29zdENlbnRyZUFsbG9jYXRpb24uY29zdENlbnRyZS5wcm9maXRDZW50cmUuY29tcGFueScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29zdENlbnRyZUFsbG9jYXRpb24uY2hhcnRPZkFjY291bnQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2VudHJpZXMuZW50cnknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NyZWF0b3InCiAgICAgICAgICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYWxsb2NhdGlvbl9uYW1lJywgZnVuY3Rpb24gKCRyYXRpbykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHJhdGlvLT5jb3N0Q2VudHJlQWxsb2NhdGlvbi0+bmFtZTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhbGxvY2F0aW9uX25hbWUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnY29zdENlbnRyZUFsbG9jYXRpb24nLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignYWxsb2NhdGlvbl9uYW1lJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIENvc3RDZW50cmVBbGxvY2F0aW9uOjpzZWxlY3QoJ2Nvc3RfY2VudHJlX2FsbG9jYXRpb25zLm5hbWUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignY29zdF9jZW50cmVfYWxsb2NhdGlvbnMuaWQnLCAnc2hhcmVkX2Nvc3RfcmF0aW9zLmNvc3RfY2VudHJlX2FsbG9jYXRpb25faWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FsbG9jYXRpb25fY29tcGFueScsIGZ1bmN0aW9uICgkcmF0aW8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdbJy4kcmF0aW8tPmNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPmNvZGUuJ10gJy4kcmF0aW8tPmNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPm5hbWU7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignYWxsb2NhdGlvbl9jb21wYW55JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2Nvc3RDZW50cmVBbGxvY2F0aW9uLmNvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZSgnY29kZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ2FsbG9jYXRpb25fY29tcGFueScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBDb3N0Q2VudHJlQWxsb2NhdGlvbjo6c2VsZWN0KCdjb21wYW5pZXMuY29kZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2NvbXBhbmllcycsICdjb21wYW5pZXMuaWQnLCAnPScsICdwcm9maXRfY2VudHJlcy5jb21wYW55X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+am9pbigncHJvZml0X2NlbnRyZXMnLCAncHJvZml0X2NlbnRyZXMuaWQnLCAnPScsICdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2Nvc3RfY2VudHJlcycsICdjb3N0X2NlbnRyZXMuaWQnLCAnPScsICdjb3N0X2NlbnRyZV9hbGxvY2F0aW9ucy5jb3N0X2NlbnRyZV9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdjb3N0X2NlbnRyZV9hbGxvY2F0aW9ucy5pZCcsICdzaGFyZWRfY29zdF9yYXRpb3MuY29zdF9jZW50cmVfYWxsb2NhdGlvbl9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYWxsb2NhdGlvbl9jb3N0X2NlbnRyZScsIGZ1bmN0aW9uICgkcmF0aW8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdbJy4kcmF0aW8tPmNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0Q2VudHJlLT5jb2RlLiddICcuJHJhdGlvLT5jb3N0Q2VudHJlQWxsb2NhdGlvbi0+Y29zdENlbnRyZS0+bmFtZTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhbGxvY2F0aW9uX2Nvc3RfY2VudHJlJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2Nvc3RDZW50cmVBbGxvY2F0aW9uLmNvc3RDZW50cmUnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZSgnY29kZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ2FsbG9jYXRpb25fY29zdF9jZW50cmUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgQ29zdENlbnRyZUFsbG9jYXRpb246OnNlbGVjdCgnY29zdF9jZW50cmVzLmNvZGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdjb3N0X2NlbnRyZXMnLCAnY29zdF9jZW50cmVzLmlkJywgJz0nLCAnY29zdF9jZW50cmVfYWxsb2NhdGlvbnMuY29zdF9jZW50cmVfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignY29zdF9jZW50cmVfYWxsb2NhdGlvbnMuaWQnLCAnc2hhcmVkX2Nvc3RfcmF0aW9zLmNvc3RfY2VudHJlX2FsbG9jYXRpb25faWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FsbG9jYXRpb25fY2hhcnRfb2ZfYWNjb3VudCcsIGZ1bmN0aW9uICgkcmF0aW8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdbJy4kcmF0aW8tPmNvc3RDZW50cmVBbGxvY2F0aW9uLT5jaGFydE9mQWNjb3VudC0+Y29kZS4nXSAnLiRyYXRpby0+Y29zdENlbnRyZUFsbG9jYXRpb24tPmNoYXJ0T2ZBY2NvdW50LT5uYW1lOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2FsbG9jYXRpb25fY2hhcnRfb2ZfYWNjb3VudCcsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdjb3N0Q2VudHJlQWxsb2NhdGlvbi5jaGFydE9mQWNjb3VudCcsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSAoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJyAuICRrZXl3b3JkIC4gJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignYWxsb2NhdGlvbl9jaGFydF9vZl9hY2NvdW50JywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIENvc3RDZW50cmVBbGxvY2F0aW9uOjpzZWxlY3QoJ2NoYXJ0X29mX2FjY291bnRzLmNvZGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdjaGFydF9vZl9hY2NvdW50cycsICdjaGFydF9vZl9hY2NvdW50cy5pZCcsICc9JywgJ2Nvc3RfY2VudHJlX2FsbG9jYXRpb25zLmNoYXJ0X29mX2FjY291bnRfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignY29zdF9jZW50cmVfYWxsb2NhdGlvbnMuaWQnLCAnc2hhcmVkX2Nvc3RfcmF0aW9zLmNvc3RfY2VudHJlX2FsbG9jYXRpb25faWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2VudHJpZXMnLCBmdW5jdGlvbiAoJHJhdGlvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0iJy51cmwoJ2FjY291bnRpbmcvc2hhcmVkLWNvc3QtcmF0aW9zLycuJHJhdGlvLT5pZCkuJyI+Jy4kcmF0aW8tPmVudHJpZXMtPnBsdWNrKCdlbnRyeS5jb2RlJyktPmltcGxvZGUoJywgJykuJzwvYT4nOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2VudHJpZXMnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZW50cmllcy5lbnRyeScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSAoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2NvZGUnLCAnTElLRScsICclJyAuICRrZXl3b3JkIC4gJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdlbnRyaWVzJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIFNoYXJlZENvc3RSYXRpb0VudHJ5OjpzZWxlY3QoJ2VudHJpZXMuY29kZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2VudHJpZXMnLCAnZW50cmllcy5pZCcsICc9JywgJ3NoYXJlZF9jb3N0X3JhdGlvX2VudHJpZXMuZW50cnlfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignc2hhcmVkX2Nvc3RfcmF0aW9fZW50cmllcy5pZCcsICdzaGFyZWRfY29zdF9yYXRpb3MuaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2NyZWF0b3InLCBmdW5jdGlvbiAoJHJhdGlvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcmF0aW8tPmNyZWF0b3IgPyAkcmF0aW8tPmNyZWF0b3ItPm5hbWUgOiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdjcmVhdG9yJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2NyZWF0b3InLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignY3JlYXRvcicsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBVc2VyOjpzZWxlY3QoJ3VzZXJzLm5hbWUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbigndXNlcnMuaWQnLCAnc2hhcmVkX2Nvc3RfcmF0aW9zLmNyZWF0ZWRfYnknKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFsnZW50cmllcyddKQogICAgICAgICAgICAgICAgICAgIC0+dG9Kc29uKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuc2hhcmVkQ29zdFJhdGlvLnNoYXJlZENvc3RSYXRpby5pbmRleCcsIFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJ1NoYXJlZCBDb3N0IFJhdGlvJywKICAgICAgICAgICAgICAgICdoZWFkZXJDb2x1bW5zJyA9PiAkdGhpcy0+aGVhZGVyQ29sdW1ucygpCiAgICAgICAgICAgIF0pOwogICAgICAgIH0gY2F0Y2ggKFxUaHJvd2FibGUgJHRoKSB7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgICRjdXJyZW5jeV9pZCA9IHJlcXVlc3QoKS0+aGFzKCdjdXJyZW5jeV9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ2N1cnJlbmN5X2lkJykgOiAxOwogICAgICAgICRmcm9tID0gcmVxdWVzdCgpLT5oYXMoJ2Zyb20nKSA/IHJlcXVlc3QoKS0+Z2V0KCdmcm9tJykgOiBkYXRlKCdZLW0tMDEnKTsKICAgICAgICAkdG8gPSByZXF1ZXN0KCktPmhhcygndG8nKSA/IHJlcXVlc3QoKS0+Z2V0KCd0bycpIDogZGF0ZSgnWS1tLWQnKTsKICAgICAgICAKICAgICAgICAkY29zdENlbnRyZUFsbG9jYXRpb24gPSBDb3N0Q2VudHJlQWxsb2NhdGlvbjo6d2l0aChbCiAgICAgICAgICAgICdjb3N0Q2VudHJlLnByb2ZpdENlbnRyZS5jb21wYW55JywKICAgICAgICAgICAgJ2NoYXJ0T2ZBY2NvdW50JywKICAgICAgICAgICAgJ3RhcmdldHMuY29zdENlbnRyZS5wcm9maXRDZW50cmUuY29tcGFueScsCiAgICAgICAgICAgICd0YXJnZXRzLmNoYXJ0T2ZBY2NvdW50JywKICAgICAgICBdKS0+d2hlcmVIYXMoJ2Nvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnkudXNlcnMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgndXNlcl9pZCcsIGF1dGgoKS0+dXNlcigpLT5pZCk7CiAgICAgICAgfSkKICAgICAgICAtPndoZXJlSGFzKCdjaGFydE9mQWNjb3VudC51c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd1c2VyX2lkJywgYXV0aCgpLT51c2VyKCktPmlkKTsKICAgICAgICB9KS0+ZmluZChyZXF1ZXN0KCktPmdldCgnY29zdF9jZW50cmVfYWxsb2NhdGlvbl9pZCcpKTsKCiAgICAgICAgJGRlYml0ID0gRW50cnlJdGVtOjp3aGVyZUhhcygnZW50cnkuZXhjaGFuZ2VSYXRlJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGN1cnJlbmN5X2lkKXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2N1cnJlbmN5X2lkJywgJGN1cnJlbmN5X2lkKTsKICAgICAgICB9KQogICAgICAgIC0+d2hlcmUoWwogICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+IGlzc2V0KCRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+Y29zdF9jZW50cmVfaWQpID8gJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0X2NlbnRyZV9pZCA6IDAsCiAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiBpc3NldCgkY29zdENlbnRyZUFsbG9jYXRpb24tPmNoYXJ0X29mX2FjY291bnRfaWQpID8gJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jaGFydF9vZl9hY2NvdW50X2lkIDogMCwKICAgICAgICAgICAgJ2Nvc3RfYWxsb2NhdGVkJyA9PiAwLAogICAgICAgICAgICAnZGViaXRfY3JlZGl0JyA9PiAnRCcsCiAgICAgICAgXSkKICAgICAgICAtPndoZXJlSGFzKCdlbnRyeScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRmcm9tLCAkdG8pewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZGF0ZScsICc+PScsICRmcm9tKQogICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZSgnZGF0ZScsICc8PScsICR0bykKICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2lzX2FwcHJvdmVkJywgJ2FwcHJvdmVkJyk7CiAgICAgICAgfSktPnN1bSgnYW1vdW50Jyk7CgogICAgICAgICRjcmVkaXQgPSBFbnRyeUl0ZW06OndoZXJlSGFzKCdlbnRyeS5leGNoYW5nZVJhdGUnLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkY3VycmVuY3lfaWQpewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnY3VycmVuY3lfaWQnLCAkY3VycmVuY3lfaWQpOwogICAgICAgIH0pCiAgICAgICAgLT53aGVyZShbCiAgICAgICAgICAgICdjb3N0X2NlbnRyZV9pZCcgPT4gaXNzZXQoJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0X2NlbnRyZV9pZCkgPyAkY29zdENlbnRyZUFsbG9jYXRpb24tPmNvc3RfY2VudHJlX2lkIDogMCwKICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+IGlzc2V0KCRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+Y2hhcnRfb2ZfYWNjb3VudF9pZCkgPyAkY29zdENlbnRyZUFsbG9jYXRpb24tPmNoYXJ0X29mX2FjY291bnRfaWQgOiAwLAogICAgICAgICAgICAnY29zdF9hbGxvY2F0ZWQnID0+IDAsCiAgICAgICAgICAgICdkZWJpdF9jcmVkaXQnID0+ICdDJywKICAgICAgICBdKQogICAgICAgIC0+d2hlcmVIYXMoJ2VudHJ5JywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGZyb20sICR0byl7CiAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdkYXRlJywgJz49JywgJGZyb20pCiAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlKCdkYXRlJywgJzw9JywgJHRvKQogICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZSgnaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKTsKICAgICAgICB9KS0+c3VtKCdhbW91bnQnKTsKICAgICAgICAkYmFsYW5jZSA9ICRkZWJpdC0kY3JlZGl0OwogICAgICAgICRiYWxhbmNlID0gKCRiYWxhbmNlICE9IDAgJiYgJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5hbGxvY2F0aW9uID4gMCA/ICRiYWxhbmNlKigkY29zdENlbnRyZUFsbG9jYXRpb24tPmFsbG9jYXRpb24vMTAwKSA6IDApOwoKICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgJ3RpdGxlJyA9PiAnTmV3IENvc3QgUmF0aW8gU2hhcmUnLAogICAgICAgICAgICAnY29zdENlbnRyZUFsbG9jYXRpb25zJyA9PiBDb3N0Q2VudHJlQWxsb2NhdGlvbjo6d2l0aChbCiAgICAgICAgICAgICAgICAnY29zdENlbnRyZS5wcm9maXRDZW50cmUuY29tcGFueScsCiAgICAgICAgICAgICAgICAnY2hhcnRPZkFjY291bnQnCiAgICAgICAgICAgIF0pLT53aGVyZUhhcygnY29zdENlbnRyZS5wcm9maXRDZW50cmUuY29tcGFueS51c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgndXNlcl9pZCcsIGF1dGgoKS0+dXNlcigpLT5pZCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2NoYXJ0T2ZBY2NvdW50LnVzZXJzJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd1c2VyX2lkJywgYXV0aCgpLT51c2VyKCktPmlkKTsKICAgICAgICAgICAgfSktPmdldCgpLAogICAgICAgICAgICAnY3VycmVuY3lUeXBlcycgPT4gQ3VycmVuY3lUeXBlOjp3aXRoKFsnY3VycmVuY2llcyddKS0+Z2V0KCksCiAgICAgICAgICAgICdjb3N0Q2VudHJlQWxsb2NhdGlvbicgPT4gJGNvc3RDZW50cmVBbGxvY2F0aW9uLAogICAgICAgICAgICAnY3VycmVuY3lfaWQnID0+ICRjdXJyZW5jeV9pZCwKICAgICAgICAgICAgJ2Zyb20nID0+ICRmcm9tLAogICAgICAgICAgICAndG8nID0+ICR0bywKICAgICAgICAgICAgJ2JhbGFuY2UnID0+ICRiYWxhbmNlCiAgICAgICAgXTsKCiAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5zaGFyZWRDb3N0UmF0aW8uc2hhcmVkQ29zdFJhdGlvLmNyZWF0ZScsICRkYXRhKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkcmVxdWVzdC0+dmFsaWRhdGUoWwogICAgICAgICAgICAnY29zdF9jZW50cmVfYWxsb2NhdGlvbl9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2N1cnJlbmN5X2lkJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnZnJvbScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3RvJyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJGNvc3RDZW50cmVBbGxvY2F0aW9uID0gQ29zdENlbnRyZUFsbG9jYXRpb246OndpdGgoWwogICAgICAgICAgICAgICAgJ2Nvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLAogICAgICAgICAgICAgICAgJ2NoYXJ0T2ZBY2NvdW50JywKICAgICAgICAgICAgICAgICd0YXJnZXRzLmNvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLAogICAgICAgICAgICAgICAgJ3RhcmdldHMuY2hhcnRPZkFjY291bnQnLAogICAgICAgICAgICBdKS0+d2hlcmVIYXMoJ2Nvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnkudXNlcnMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3VzZXJfaWQnLCBhdXRoKCktPnVzZXIoKS0+aWQpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZXJlSGFzKCdjaGFydE9mQWNjb3VudC51c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgndXNlcl9pZCcsIGF1dGgoKS0+dXNlcigpLT5pZCk7CiAgICAgICAgICAgIH0pLT5maW5kKCRyZXF1ZXN0LT5jb3N0X2NlbnRyZV9hbGxvY2F0aW9uX2lkKTsKCiAgICAgICAgICAgICRkZWJpdCA9IEVudHJ5SXRlbTo6d2hlcmVIYXMoJ2VudHJ5LmV4Y2hhbmdlUmF0ZScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRyZXF1ZXN0KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjdXJyZW5jeV9pZCcsICRyZXF1ZXN0LT5jdXJyZW5jeV9pZCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlcmUoWwogICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2lkJyA9PiAkY29zdENlbnRyZUFsbG9jYXRpb24tPmNvc3RfY2VudHJlX2lkLAogICAgICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+ICRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+Y2hhcnRfb2ZfYWNjb3VudF9pZCwKICAgICAgICAgICAgICAgICdjb3N0X2FsbG9jYXRlZCcgPT4gMCwKICAgICAgICAgICAgICAgICdkZWJpdF9jcmVkaXQnID0+ICdEJywKICAgICAgICAgICAgXSkKICAgICAgICAgICAgLT53aGVyZUhhcygnZW50cnknLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcmVxdWVzdCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZGF0ZScsICc+PScsICRyZXF1ZXN0LT5mcm9tKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2RhdGUnLCAnPD0nLCAkcmVxdWVzdC0+dG8pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZSgnaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKTsKICAgICAgICAgICAgfSktPnN1bSgnYW1vdW50Jyk7CgogICAgICAgICAgICAkY3JlZGl0ID0gRW50cnlJdGVtOjp3aGVyZUhhcygnZW50cnkuZXhjaGFuZ2VSYXRlJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHJlcXVlc3QpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2N1cnJlbmN5X2lkJywgJHJlcXVlc3QtPmN1cnJlbmN5X2lkKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVyZShbCiAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+ICRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+Y29zdF9jZW50cmVfaWQsCiAgICAgICAgICAgICAgICAnY2hhcnRfb2ZfYWNjb3VudF9pZCcgPT4gJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jaGFydF9vZl9hY2NvdW50X2lkLAogICAgICAgICAgICAgICAgJ2Nvc3RfYWxsb2NhdGVkJyA9PiAwLAogICAgICAgICAgICAgICAgJ2RlYml0X2NyZWRpdCcgPT4gJ0MnLAogICAgICAgICAgICBdKQogICAgICAgICAgICAtPndoZXJlSGFzKCdlbnRyeScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRyZXF1ZXN0KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdkYXRlJywgJz49JywgJHJlcXVlc3QtPmZyb20pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZSgnZGF0ZScsICc8PScsICRyZXF1ZXN0LT50bykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlKCdpc19hcHByb3ZlZCcsICdhcHByb3ZlZCcpOwogICAgICAgICAgICB9KS0+c3VtKCdhbW91bnQnKTsKICAgICAgICAgICAgJGJhbGFuY2UgPSAkZGViaXQtJGNyZWRpdDsKICAgICAgICAgICAgJGJhbGFuY2UgPSAoJGJhbGFuY2UgIT0gMCAmJiAkY29zdENlbnRyZUFsbG9jYXRpb24tPmFsbG9jYXRpb24gPiAwID8gJGJhbGFuY2UqKCRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+YWxsb2NhdGlvbi8xMDApIDogMCk7CgogICAgICAgICAgICAkc2hhcmVkQ29zdFJhdGlvID0gU2hhcmVkQ29zdFJhdGlvOjpjcmVhdGUoWwogICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2FsbG9jYXRpb25faWQnID0+ICRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+aWQsCiAgICAgICAgICAgICAgICAnY29kZScgPT4gZW50cnlVbmlxdWVDb2RlKDE1LCAnU0NSLScuZGF0ZSgneW1kJywgc3RydG90aW1lKGRhdGUoJ1ktbS1kIEg6aTpzJykpKS4nLScsICdzaGFyZWRfY29zdF9yYXRpb3MnLCAnY29kZScpLAogICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJyA9PiAnJywKICAgICAgICAgICAgICAgICdmcm9tJyA9PiAkcmVxdWVzdC0+ZnJvbSwKICAgICAgICAgICAgICAgICd0bycgPT4gJHJlcXVlc3QtPnRvLAogICAgICAgICAgICAgICAgJ2FsbG9jYXRpb24nID0+ICRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+YWxsb2NhdGlvbiwKICAgICAgICAgICAgICAgICdiYWxhbmNlJyA9PiAkYmFsYW5jZSwKICAgICAgICAgICAgICAgICdjcmVhdGVkX2J5JyA9PiBhdXRoKCktPnVzZXIoKS0+aWQsCiAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgJGVudHJpZXMgPSBbXTsKICAgICAgICAgICAgaWYoJGNvc3RDZW50cmVBbGxvY2F0aW9uLT50YXJnZXRzLT5jb3VudCgpID4gMCl7CiAgICAgICAgICAgICAgICBmb3JlYWNoKCRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+dGFyZ2V0cyBhcyAkdGFyZ2V0KXsKICAgICAgICAgICAgICAgICAgICAkYW1vdW50ID0gJHRhcmdldC0+YWxsb2NhdGlvbiA+IDAgJiYgJGJhbGFuY2UgIT0gMCA/ICRiYWxhbmNlKigkdGFyZ2V0LT5hbGxvY2F0aW9uLzEwMCkgOiAwOwoKICAgICAgICAgICAgICAgICAgICAkc291cmNlSXRlbXMgPSBbXTsKICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRzb3VyY2VJdGVtcywgWwogICAgICAgICAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+ICRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+Y29zdF9jZW50cmVfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiAkY29zdENlbnRyZUFsbG9jYXRpb24tPmNoYXJ0X29mX2FjY291bnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdkZWJpdCcgPT4gJGFtb3VudCA8IDAgPyAkYW1vdW50KigtMSkgOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAnY3JlZGl0JyA9PiAkYW1vdW50ID4gMCA/ICRhbW91bnQgOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAnYW1vdW50JyA9PiAoJGFtb3VudCA8IDAgPyAkYW1vdW50KigtMSkgOiAkYW1vdW50KSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2RlYml0X2NyZWRpdCcgPT4gKCRhbW91bnQgPCAwID8gJ0QnIDogJ0MnKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ25hcnJhdGlvbicgPT4gJ0xlZGdlciAnLigkYW1vdW50IDwgMCA/ICdEZWJpdCcgOiAnQ3JlZGl0JyksCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkc291cmNlSXRlbXMsIFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2lkJyA9PiAkY29zdENlbnRyZUFsbG9jYXRpb24tPmNvc3RfY2VudHJlX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnY2hhcnRfb2ZfYWNjb3VudF9pZCcgPT4gJGFtb3VudCA+IDAgPyAkY29zdENlbnRyZUFsbG9jYXRpb24tPmNvc3RDZW50cmUtPnByb2ZpdENlbnRyZS0+Y29tcGFueS0+aW50ZXJjb21wYW55X2RlYml0X2xlZGdlcl9pZCA6ICRjb3N0Q2VudHJlQWxsb2NhdGlvbi0+Y29zdENlbnRyZS0+cHJvZml0Q2VudHJlLT5jb21wYW55LT5pbnRlcmNvbXBhbnlfY3JlZGl0X2xlZGdlcl9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2RlYml0JyA9PiAkYW1vdW50ID4gMCA/ICRhbW91bnQgOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAnY3JlZGl0JyA9PiAkYW1vdW50IDwgMCA/ICRhbW91bnQqKC0xKSA6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICdhbW91bnQnID0+ICgkYW1vdW50ID4gMCA/ICRhbW91bnQgOiAkYW1vdW50KigtMSkpLAogICAgICAgICAgICAgICAgICAgICAgICAnZGViaXRfY3JlZGl0JyA9PiAoJGFtb3VudCA+IDAgPyAnRCcgOiAnQycpLAogICAgICAgICAgICAgICAgICAgICAgICAnbmFycmF0aW9uJyA9PiAnSW50ZXIgQ29tcGFueSBMZWRnZXIgJy4oJGFtb3VudCA+IDAgPyAnRGViaXQnIDogJ0NyZWRpdCcpLAogICAgICAgICAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgICAgICAgICAkZGVzdGluYXRpb25JdGVtcyA9IFtdOwogICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGRlc3RpbmF0aW9uSXRlbXMsIFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2lkJyA9PiAkdGFyZ2V0LT5jb3N0X2NlbnRyZV9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+ICR0YXJnZXQtPmNoYXJ0X29mX2FjY291bnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdkZWJpdCcgPT4gJGFtb3VudCA+IDAgPyAkYW1vdW50IDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NyZWRpdCcgPT4gJGFtb3VudCA8IDAgPyAkYW1vdW50KigtMSkgOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAnYW1vdW50JyA9PiAoJGFtb3VudCA+IDAgPyAkYW1vdW50KigtMSkgOiAkYW1vdW50KSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2RlYml0X2NyZWRpdCcgPT4gKCRhbW91bnQgPiAwID8gJ0QnIDogJ0MnKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ25hcnJhdGlvbicgPT4gJ0xlZGdlciAnLigkYW1vdW50ID4gMCA/ICdEZWJpdCcgOiAnQ3JlZGl0JyksCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkZGVzdGluYXRpb25JdGVtcywgWwogICAgICAgICAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+ICR0YXJnZXQtPmNvc3RfY2VudHJlX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnY2hhcnRfb2ZfYWNjb3VudF9pZCcgPT4gJGFtb3VudCA8IDAgPyAkdGFyZ2V0LT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPmludGVyY29tcGFueV9kZWJpdF9sZWRnZXJfaWQgOiAkdGFyZ2V0LT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPmludGVyY29tcGFueV9jcmVkaXRfbGVkZ2VyX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnZGViaXQnID0+ICRhbW91bnQgPCAwID8gJGFtb3VudCooLTEpIDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NyZWRpdCcgPT4gJGFtb3VudCA+IDAgPyAkYW1vdW50IDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2Ftb3VudCcgPT4gKCRhbW91bnQgPCAwID8gJGFtb3VudCA6ICRhbW91bnQqKC0xKSksCiAgICAgICAgICAgICAgICAgICAgICAgICdkZWJpdF9jcmVkaXQnID0+ICgkYW1vdW50IDwgMCA/ICdEJyA6ICdDJyksCiAgICAgICAgICAgICAgICAgICAgICAgICduYXJyYXRpb24nID0+ICdJbnRlciBDb21wYW55IExlZGdlciAnLigkYW1vdW50IDwgMCA/ICdEZWJpdCcgOiAnQ3JlZGl0JyksCiAgICAgICAgICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgICAgICRzYW1lID0gJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnlfaWQgPT0gJHRhcmdldC0+Y29zdENlbnRyZS0+cHJvZml0Q2VudHJlLT5jb21wYW55X2lkOwogICAgICAgICAgICAgICAgICAgICRlbnRyeSA9IHNhdmVMZWRnZXJFbnRyaWVzKDUsIGRhdGUoJ1ktbS1kIEg6aTpzJyksIDEsICRzaGFyZWRDb3N0UmF0aW8tPmNvZGUsICcnLCAkc2FtZSA/IGFycmF5X21lcmdlKCRzb3VyY2VJdGVtcywgJGRlc3RpbmF0aW9uSXRlbXMpIDogJHNvdXJjZUl0ZW1zLCBnZXRFeGNoYW5nZVJhdGVzKCRyZXF1ZXN0LT5jdXJyZW5jeV9pZCwgZGF0ZSgnWS1tLWQnLCBzdHJ0b3RpbWUoZGF0ZSgnWS1tLWQgSDppOnMnKSkpLCBkYXRlKCdIOmk6cycsIHN0cnRvdGltZShkYXRlKCdZLW0tZCBIOmk6cycpKSkpWydyYXRlJ10tPmlkLCAxLCBmYWxzZSwgMSwgJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnlfaWQsIGdldEFjdGl2ZUZpc2NhbFllYXIoJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnlfaWQpKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJGVudHJ5WydzdWNjZXNzJ10pICYmICRlbnRyeVsnc3VjY2VzcyddKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGVudHJpZXMsIFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzaGFyZWRfY29zdF9yYXRpb19pZCcgPT4gJHNoYXJlZENvc3RSYXRpby0+aWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZW50cnlfaWQnID0+ICRlbnRyeVsnZW50cnknXS0+aWQsCiAgICAgICAgICAgICAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYoISRzYW1lKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRlbnRyeSA9IHNhdmVMZWRnZXJFbnRyaWVzKDUsIGRhdGUoJ1ktbS1kIEg6aTpzJyksIDEsICRzaGFyZWRDb3N0UmF0aW8tPmNvZGUsICcnLCAkZGVzdGluYXRpb25JdGVtcywgZ2V0RXhjaGFuZ2VSYXRlcygkcmVxdWVzdC0+Y3VycmVuY3lfaWQsIGRhdGUoJ1ktbS1kJywgc3RydG90aW1lKGRhdGUoJ1ktbS1kIEg6aTpzJykpKSwgZGF0ZSgnSDppOnMnLCBzdHJ0b3RpbWUoZGF0ZSgnWS1tLWQgSDppOnMnKSkpKVsncmF0ZSddLT5pZCwgMSwgZmFsc2UsIDEsICR0YXJnZXQtPmNvc3RDZW50cmUtPnByb2ZpdENlbnRyZS0+Y29tcGFueV9pZCwgZ2V0QWN0aXZlRmlzY2FsWWVhcigkdGFyZ2V0LT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnlfaWQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkZW50cnlbJ3N1Y2Nlc3MnXSkgJiYgJGVudHJ5WydzdWNjZXNzJ10pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRlbnRyaWVzLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzaGFyZWRfY29zdF9yYXRpb19pZCcgPT4gJHNoYXJlZENvc3RSYXRpby0+aWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdlbnRyeV9pZCcgPT4gJGVudHJ5WydlbnRyeSddLT5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoaXNzZXQoJGVudHJpZXNbMF0pKXsKICAgICAgICAgICAgICAgIFNoYXJlZENvc3RSYXRpb0VudHJ5OjppbnNlcnQoJGVudHJpZXMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBFbnRyeUl0ZW06OndoZXJlSGFzKCdlbnRyeS5leGNoYW5nZVJhdGUnLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcmVxdWVzdCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnY3VycmVuY3lfaWQnLCAkcmVxdWVzdC0+Y3VycmVuY3lfaWQpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZXJlKFsKICAgICAgICAgICAgICAgICdjb3N0X2NlbnRyZV9pZCcgPT4gJGNvc3RDZW50cmVBbGxvY2F0aW9uLT5jb3N0X2NlbnRyZV9pZCwKICAgICAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiAkY29zdENlbnRyZUFsbG9jYXRpb24tPmNoYXJ0X29mX2FjY291bnRfaWQsCiAgICAgICAgICAgICAgICAnY29zdF9hbGxvY2F0ZWQnID0+IDAsCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2VudHJ5JywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHJlcXVlc3QpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2RhdGUnLCAnPj0nLCAkcmVxdWVzdC0+ZnJvbSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlKCdkYXRlJywgJzw9JywgJHJlcXVlc3QtPnRvKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2lzX2FwcHJvdmVkJywgJ2FwcHJvdmVkJyk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgICAgICdjb3N0X2FsbG9jYXRlZCcgPT4gMQogICAgICAgICAgICBdKTsKCiAgICAgICAgICAgIEVudHJ5SXRlbTo6d2hlcmVJbignZW50cnlfaWQnLCBjb2xsZWN0KCRlbnRyaWVzKS0+cGx1Y2soJ2VudHJ5X2lkJyktPnRvQXJyYXkoKSktPnVwZGF0ZShbCiAgICAgICAgICAgICAgICAnY29zdF9hbGxvY2F0ZWQnID0+IDEKICAgICAgICAgICAgXSk7CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHNlc3Npb24oKS0+Zmxhc2goJ2FsZXJ0LXR5cGUnLCAic3VjY2VzcyIpOwogICAgICAgICAgICBzZXNzaW9uKCktPmZsYXNoKCdtZXNzYWdlJywgIkNvc3QgUmF0aW8gaGFzIGJlZW4gc2hhcmVkIHN1Y2Nlc3NmdWxseS4iKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgIF0pOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICR0aC0+Z2V0TWVzc2FnZSgpCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc2hvdygkaWQpCiAgICB7CiAgICAgICAgJHNoYXJlZENvc3RSYXRpbyA9IFNoYXJlZENvc3RSYXRpbzo6d2l0aChbCiAgICAgICAgICAgICdjb3N0Q2VudHJlQWxsb2NhdGlvbi5jb3N0Q2VudHJlLnByb2ZpdENlbnRyZS5jb21wYW55JywKICAgICAgICAgICAgJ2Nvc3RDZW50cmVBbGxvY2F0aW9uLnRhcmdldHMuY29zdENlbnRyZS5wcm9maXRDZW50cmUuY29tcGFueScsCiAgICAgICAgICAgICdlbnRyaWVzLmVudHJ5LmZpc2NhbFllYXInLAogICAgICAgICAgICAnZW50cmllcy5lbnRyeS5leGNoYW5nZVJhdGUuY3VycmVuY3knLAogICAgICAgICAgICAnZW50cmllcy5lbnRyeS5pdGVtcy5jaGFydE9mQWNjb3VudCcsCiAgICAgICAgICAgICdlbnRyaWVzLmVudHJ5LmVudHJ5VHlwZScsCiAgICAgICAgICAgICdlbnRyaWVzLmVudHJ5Lml0ZW1zLmNvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLAogICAgICAgICAgICAnZW50cmllcy5lbnRyeS5hcHByb3ZhbHMuYXBwcm92YWxMZXZlbCcsCiAgICAgICAgICAgICdjcmVhdG9yJwogICAgICAgIF0pLT5maW5kT3JGYWlsKCRpZCk7CgogICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuc2hhcmVkQ29zdFJhdGlvLnNoYXJlZENvc3RSYXRpby5lbnRyaWVzJywgWwogICAgICAgICAgICAndGl0bGUnID0+ICdTaGFyZWQgQ29zdCBSYXRpbyAjJy4kc2hhcmVkQ29zdFJhdGlvLT5jb2RlLAogICAgICAgICAgICAnc2hhcmVkQ29zdFJhdGlvJyA9PiAkc2hhcmVkQ29zdFJhdGlvLAogICAgICAgICAgICAnYXBwcm92YWxzJyA9PiBhdXRoKCktPnVzZXIoKS0+YXBwcm92YWxzLT5wbHVjaygnYXBwcm92YWxfbGV2ZWxfaWQnKS0+dG9BcnJheSgpCiAgICAgICAgXSk7CiAgICB9Cn0K