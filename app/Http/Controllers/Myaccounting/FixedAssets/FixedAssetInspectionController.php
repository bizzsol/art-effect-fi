<?php
bolt_decrypt( __FILE__ , 'kjt85J'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nXEZpeGVkQXNzZXRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXEZpeGVkQXNzZXRCYXRjaDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbTsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI7CnVzZSBBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXEZpeGVkQXNzZXRJdGVtUGh5c2ljYWxTdGF0dXM7CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXENhdGVnb3J5Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHJvZHVjdDsKCnVzZSBBcHAsIERCLCBEYXRhVGFibGVzOwp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XEZhY2FkZXNcQXV0aDsKCmNsYXNzIEZpeGVkQXNzZXRJbnNwZWN0aW9uQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIGhlYWRlckNvbHVtbnMoJHZhbHVlPScnKXsKICAgICAgICAkcm93cyA9ICBhcnJheSgKICAgICAgICAgICAgWydTTCcsICdTTCddLAogICAgICAgICAgICBbJ2NvbXBhbnknLCAnY29tcGFueScsJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYXNzZXQnLCAnYXNzZXQnLCd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ0dSTicsICdHUk4nLCd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2JhdGNoX2lkJywgJ2JhdGNoX2lkJywndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydhc3NldF9jb2RlJywgJ2Fzc2V0X2NvZGUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydjdXJyZW50X2xvY2F0aW9uJywgJ2N1cnJlbnRfbG9jYXRpb24nLCAndGV4dC1jZW50ZXInXSwgCiAgICAgICAgICAgIFsnY3VycmVudF91c2VyJywgJ2N1cnJlbnRfdXNlcicsICd0ZXh0LWNlbnRlciddLCAKICAgICAgICAgICAgWydvcHRpb25zJywgJ29wdGlvbnMnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICApOwogICAgICAgIHJldHVybiAkcm93czsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGFUYWJsZXM6Om9mKAogICAgICAgICAgICAgICAgICAgIEZpeGVkQXNzZXRCYXRjaEl0ZW06OndpdGgoWwogICAgICAgICAgICAgICAgICAgICAgICAnZmluYWxBc3NldC5hdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbi5hdHRyaWJ1dGUnLAogICAgICAgICAgICAgICAgICAgICAgICAnYmF0Y2guZ29vZHNSZWNlaXZlZEl0ZW1zU3RvY2tJbi5yZWxHb29kc1JlY2VpdmVkSXRlbXMucmVsR29vZHNSZWNlaXZlZE5vdGUnLAogICAgICAgICAgICAgICAgICAgICAgICAndXNlcnMudXNlcicsCiAgICAgICAgICAgICAgICAgICAgICAgICdjdXJyZW50VXNlci51c2VyJywKCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXRjaC5jb3N0Q2VudHJlLnByb2ZpdENlbnRyZS5jb21wYW55JwogICAgICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgICAgICAgLT53aGVyZUhhcygnYmF0Y2guY29zdENlbnRyZS5wcm9maXRDZW50cmUnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUluKCdjb21wYW55X2lkJywgYXV0aCgpLT51c2VyKCktPmNvbXBhbmllcy0+cGx1Y2soJ2NvbXBhbnlfaWQnKS0+dG9BcnJheSgpKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2lzX2Rpc3Bvc2VkJywgMCkKICAgICAgICAgICAgICAgICAgICAtPmdyb3VwQnkoJ2Fzc2V0X2NvZGUnKQogICAgICAgICAgICAgICAgICAgIC0+d2hlbighZGF0YXRhYmxlT3JkZXJpbmcoKSwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaWQnLCAnZGVzYycpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAtPmFkZEluZGV4Q29sdW1uKCkKCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY29tcGFueScsIGZ1bmN0aW9uKCRpdGVtKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJGl0ZW0tPmJhdGNoLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPmNvZGUpID8gJGl0ZW0tPmJhdGNoLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPmNvZGUgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY29tcGFueScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoLmNvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnY29kZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhc3NldCcsIGZ1bmN0aW9uKCRpdGVtKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJGl0ZW0tPmZpbmFsQXNzZXQtPm5hbWUpID8gJGl0ZW0tPmZpbmFsQXNzZXQtPm5hbWUuJyAnLmdldFByb2R1Y3RBdHRyaWJ1dGVzRmFzdGVyKCRpdGVtLT5maW5hbEFzc2V0KSA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhc3NldCcsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoLmZpbmFsQXNzZXQnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ0dSTicsIGZ1bmN0aW9uKCRpdGVtKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJGl0ZW0tPmJhdGNoLT5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLT5yZWxHb29kc1JlY2VpdmVkSXRlbXMtPnJlbEdvb2RzUmVjZWl2ZWROb3RlLT5ncm5fcmVmZXJlbmNlX25vKSA/ICRpdGVtLT5iYXRjaC0+Z29vZHNSZWNlaXZlZEl0ZW1zU3RvY2tJbi0+cmVsR29vZHNSZWNlaXZlZEl0ZW1zLT5yZWxHb29kc1JlY2VpdmVkTm90ZS0+Z3JuX3JlZmVyZW5jZV9ubyA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdHUk4nLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy5yZWxHb29kc1JlY2VpdmVkTm90ZScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdncm5fcmVmZXJlbmNlX25vJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYmF0Y2hfaWQnLCBmdW5jdGlvbigkaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRpdGVtLT5iYXRjaC0+YmF0Y2gpPyRpdGVtLT5iYXRjaC0+YmF0Y2g6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2JhdGNoX2lkJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2gnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnYmF0Y2gnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhc3NldF9jb2RlJywgZnVuY3Rpb24oJGl0ZW0pewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkaXRlbS0+YXNzZXRfY29kZSk/JGl0ZW0tPmFzc2V0X2NvZGU6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2Fzc2V0X2NvZGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdhc3NldF9jb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY3VycmVudF9sb2NhdGlvbicsIGZ1bmN0aW9uKCRpdGVtKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmZpeGVkQXNzZXRzLnBoeXNpY2FsSW5zcGVjdGlvbnMubG9jYXRpb24nLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICdpdGVtJyA9PiAkaXRlbQogICAgICAgICAgICAgICAgICAgIF0pLT5yZW5kZXIoKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY3VycmVudF9sb2NhdGlvbicsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2N1cnJlbnRVc2VyLmZpeGVkQXNzZXRMb2NhdGlvbicsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY3VycmVudF91c2VyJywgZnVuY3Rpb24oJGl0ZW0pewogICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMucGh5c2ljYWxJbnNwZWN0aW9ucy51c2VyJywgWwogICAgICAgICAgICAgICAgICAgICAgICAnaXRlbScgPT4gJGl0ZW0KICAgICAgICAgICAgICAgICAgICBdKS0+cmVuZGVyKCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2N1cnJlbnRfdXNlcicsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2N1cnJlbnRVc2VyLnVzZXInLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdwaG9uZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ29wdGlvbnMnLCBmdW5jdGlvbigkaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5waHlzaWNhbEluc3BlY3Rpb25zLm9wdGlvbnMnLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICdpdGVtJyA9PiAkaXRlbQogICAgICAgICAgICAgICAgICAgIF0pLT5yZW5kZXIoKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPnJhd0NvbHVtbnMoWydjdXJyZW50X2xvY2F0aW9uJywgJ2N1cnJlbnRfdXNlcicsICdvcHRpb25zJ10pCiAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnRml4ZWQgQXNzZXQgaW5zcGVjdGlvbnMnLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCksCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMucGh5c2ljYWxJbnNwZWN0aW9ucy5pbmRleCcsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNyZWF0ZSgpCiAgICB7CiAgICAgICAgaWYocmVxdWVzdCgpLT5nZXQoJ2FjdGlvbicpID09ICdiYXRjaGVzJyl7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ2JhdGNoZXMnID0+IEZpeGVkQXNzZXRCYXRjaDo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgJ3JlcXVpc2l0aW9uRGVsaXZlcnlJdGVtLnJlbFJlcXVpc2l0aW9uRGVsaXZlcnkucmVsUmVxdWlzaXRpb24nCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgLT53aGVyZUhhcygnaXRlbXMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdpc19kaXNwb3NlZCcsIDApOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+d2hlcmVIYXMoJ3JlcXVpc2l0aW9uRGVsaXZlcnlJdGVtJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgncHJvZHVjdF9pZCcsIHJlcXVlc3QoKS0+Z2V0KCdwcm9kdWN0X2lkJykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+Z2V0KCksCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMucGh5c2ljYWxJbnNwZWN0aW9ucy5iYXRjaGVzJywgJGRhdGEpOwogICAgICAgIH1lbHNlaWYocmVxdWVzdCgpLT5nZXQoJ2FjdGlvbicpID09ICdkaXN0cmlidXRpb24taGlzdG9yeScpewogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd1c2VycycgPT4gRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI6OndpdGgoWydmaXhlZEFzc2V0TG9jYXRpb24nLCd1c2VyJ10pLT53aGVyZSgnZml4ZWRfYXNzZXRfYmF0Y2hfaXRlbV9pZCcsIHJlcXVlc3QoKS0+Z2V0KCdmaXhlZF9hc3NldF9iYXRjaF9pdGVtX2lkJykpLT5nZXQoKQogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmZpeGVkQXNzZXRzLnBoeXNpY2FsSW5zcGVjdGlvbnMuaGlzdG9yeScsICRkYXRhKTsKICAgICAgICB9ZWxzZWlmKHJlcXVlc3QoKS0+Z2V0KCdhY3Rpb24nKSA9PSAnaW5zcGVjdGlvbi1oaXN0b3J5Jyl7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3BoeXNpY2FsU3RhdHVzZXMnID0+IEZpeGVkQXNzZXRJdGVtUGh5c2ljYWxTdGF0dXM6OndpdGgoWwogICAgICAgICAgICAgICAgICAgICdiYXRjaEl0ZW0uYmF0Y2gnLAogICAgICAgICAgICAgICAgICAgICd1c2VyJywKICAgICAgICAgICAgICAgICAgICAnaW5zcGVjdG9yJwogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2ZpeGVkX2Fzc2V0X2JhdGNoX2l0ZW1faWQnLCByZXF1ZXN0KCktPmdldCgnZml4ZWRfYXNzZXRfYmF0Y2hfaXRlbV9pZCcpKS0+Z2V0KCkKICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5waHlzaWNhbEluc3BlY3Rpb25zLmluc3BlY3Rpb24taGlzdG9yeScsICRkYXRhKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgImZpeGVkX2Fzc2V0X2JhdGNoX2l0ZW1faWQiID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICJ1c2VyX2lkIiA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAiZGF0ZSIgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgInRpbWUiID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICJyYXRpbmdzIiA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBpZigkcmVxdWVzdC0+aGFzRmlsZSgnZmlsZScpKXsKICAgICAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgICAgICJmaWxlIiA9PiAncmVxdWlyZWR8aW1hZ2V8bWF4OjEwMDAwJywKICAgICAgICAgICAgXSk7CiAgICAgICAgfQoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJGluc3BlY3Rpb24gPSBGaXhlZEFzc2V0SXRlbVBoeXNpY2FsU3RhdHVzOjpjcmVhdGUoWwogICAgICAgICAgICAgICAgJ2ZpeGVkX2Fzc2V0X2JhdGNoX2l0ZW1faWQnID0+ICRyZXF1ZXN0LT5maXhlZF9hc3NldF9iYXRjaF9pdGVtX2lkLAogICAgICAgICAgICAgICAgJ2ZpeGVkX2Fzc2V0X2xvY2F0aW9uX2lkJyA9PiAkcmVxdWVzdC0+Zml4ZWRfYXNzZXRfbG9jYXRpb25faWQsCiAgICAgICAgICAgICAgICAndXNlcl9pZCcgPT4gJHJlcXVlc3QtPnVzZXJfaWQsCiAgICAgICAgICAgICAgICAnaW5zcGVjdG9yX2lkJyA9PiBhdXRoKCktPnVzZXIoKS0+aWQsCiAgICAgICAgICAgICAgICAnZGF0ZScgPT4gJHJlcXVlc3QtPmRhdGUsCiAgICAgICAgICAgICAgICAndGltZScgPT4gJHJlcXVlc3QtPnRpbWUsCiAgICAgICAgICAgICAgICAncmVtYXJrcycgPT4gJHJlcXVlc3QtPnJlbWFya3MsCiAgICAgICAgICAgICAgICAncmF0aW5ncycgPT4gJHJlcXVlc3QtPnJhdGluZ3MsCiAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgaWYoJGluc3BlY3Rpb24pewogICAgICAgICAgICAgICAgaWYoJHJlcXVlc3QtPmhhc0ZpbGUoJ2ZpbGUnKSl7CiAgICAgICAgICAgICAgICAgICAgJGluc3BlY3Rpb24tPmltYWdlID0gJHRoaXMtPmZpbGVVcGxvYWQoJHJlcXVlc3QtPmZpbGUoJ2ZpbGUnKSwndXBsb2FkL2ZpeGVkLWFzc2V0cy9pbnNwZWN0aW9ucycpOwogICAgICAgICAgICAgICAgICAgICRpbnNwZWN0aW9uLT5zYXZlKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIkZpeGVkIEl0ZW1zIGhhcyBiZWVuIGluc3BlY3RlZCBTdWNjZXNzZnVsbHkuIgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHNob3coJGlkKQogICAgewogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAnaXRlbScgPT4gRml4ZWRBc3NldEJhdGNoSXRlbTo6d2l0aChbCiAgICAgICAgICAgICAgICAnYmF0Y2guZ29vZHNSZWNlaXZlZEl0ZW1zU3RvY2tJbi5yZWxHb29kc1JlY2VpdmVkSXRlbXMucmVsUHJvZHVjdC5hdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbi5hdHRyaWJ1dGUnLAogICAgICAgICAgICAgICAgJ2JhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsR29vZHNSZWNlaXZlZEl0ZW1zLnJlbEdvb2RzUmVjZWl2ZWROb3RlJywKICAgICAgICAgICAgICAgICd1c2Vycy51c2VyJywgJ2N1cnJlbnRVc2VyLnVzZXInCiAgICAgICAgICAgIF0pLT5maW5kT3JGYWlsKCRpZCksCiAgICAgICAgXTsKICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmZpeGVkQXNzZXRzLnBoeXNpY2FsSW5zcGVjdGlvbnMuaW5zcGVjdCcsICRkYXRhKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZWRpdCgkaWQpCiAgICB7CgogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGUoUmVxdWVzdCAkcmVxdWVzdCwgJGlkKQogICAgewoKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveSgkaWQpCiAgICB7CgogICAgfQp9Cg==