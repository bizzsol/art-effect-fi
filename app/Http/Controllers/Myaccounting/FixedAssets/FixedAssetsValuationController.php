<?php
bolt_decrypt( __FILE__ , 'RVAeFl'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nXEZpeGVkQXNzZXRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXEZpeGVkQXNzZXRCYXRjaDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbTsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbURlcHJlY2lhdGlvbjsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI7CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXENhdGVnb3J5Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHJvZHVjdDsKCnVzZSBBcHAsIERCLCBEYXRhVGFibGVzOwp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XEZhY2FkZXNcQXV0aDsKCmNsYXNzIEZpeGVkQXNzZXRzVmFsdWF0aW9uQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIGhlYWRlckNvbHVtbnMoJHZhbHVlPScnKXsKICAgICAgICAkcm93cyA9ICBhcnJheSgKICAgICAgICAgICAgWydTTCcsICdTTCddLAogICAgICAgICAgICBbJ2Fzc2V0JywgJ2Fzc2V0JywndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydiYXRjaF9pZCcsICdiYXRjaF9pZCcsJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYXNzZXRfY29kZScsICdhc3NldF9jb2RlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnY3VycmVudF9sb2NhdGlvbicsICdjdXJyZW50X2xvY2F0aW9uJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnY3VycmVudF91c2VyJywgJ2N1cnJlbnRfdXNlcicsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2N1cnJlbmN5JywgJ2N1cnJlbmN5JywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsncHVyY2hhc2VfcHJpY2UnLCAncHVyY2hhc2VfcHJpY2UnLCAndGV4dC1yaWdodCddLAogICAgICAgICAgICBbJ2RlcHJlY2lhdGlvbl9zdGFydHMnLCAnZGVwcmVjaWF0aW9uX3N0YXJ0cycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3RvdGFsX2RlcHJlY2lhdGlvbicsICd0b3RhbF9kZXByZWNpYXRpb24nLCAndGV4dC1yaWdodCddLAogICAgICAgICAgICBbJ2Jvb2tfdmFsdWUnLCAnYm9va192YWx1ZScsICd0ZXh0LXJpZ2h0J10sCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gJHJvd3M7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkaXRlbXMgPSBGaXhlZEFzc2V0QmF0Y2hJdGVtOjp3aXRoKFsKICAgICAgICAgICAgICAgICdiYXRjaC5pdGVtcycsCiAgICAgICAgICAgICAgICAnZmluYWxBc3NldC5hdHRyaWJ1dGVzLmF0dHJpYnV0ZU9wdGlvbi5hdHRyaWJ1dGUnLAogICAgICAgICAgICAgICAgJ2JhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsR29vZHNSZWNlaXZlZEl0ZW1zLnJlbEdvb2RzUmVjZWl2ZWROb3RlJywKICAgICAgICAgICAgICAgICdiYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbFB1cmNoYXNlT3JkZXIucmVsUXVvdGF0aW9uLmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsCiAgICAgICAgICAgICAgICAnZGVwcmVjaWF0aW9ucycsCiAgICAgICAgICAgICAgICAnY3VycmVudFVzZXIudXNlcicsCgogICAgICAgICAgICAgICAgJ2JhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsUHVyY2hhc2VPcmRlci5yZWxQdXJjaGFzZU9yZGVySXRlbXMnLAogICAgICAgICAgICAgICAgJ2JhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsUHVyY2hhc2VPcmRlci5yZWxRdW90YXRpb24ucmVsUXVvdGF0aW9uSXRlbXMnLAogICAgICAgICAgICAgICAgJ2JhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4uYXNzZXRDb3N0aW5nRW50cmllcycsCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmUoJ2lzX2Rpc3Bvc2VkJywgMCkKICAgICAgICAgICAgLT5ncm91cEJ5KCdhc3NldF9jb2RlJykKICAgICAgICAgICAgLT53aGVuKCFkYXRhdGFibGVPcmRlcmluZygpLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaWQnLCAnZGVzYycpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGFUYWJsZXM6Om9mKCRpdGVtcykKICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2Fzc2V0JywgZnVuY3Rpb24oJGl0ZW0pewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkaXRlbS0+ZmluYWxBc3NldC0+bmFtZSkgPyAkaXRlbS0+ZmluYWxBc3NldC0+bmFtZS4nICcuZ2V0UHJvZHVjdEF0dHJpYnV0ZXNGYXN0ZXIoJGl0ZW0tPmZpbmFsQXNzZXQpIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2Fzc2V0JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZmluYWxBc3NldCcsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYmF0Y2hfaWQnLCBmdW5jdGlvbigkaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRpdGVtLT5iYXRjaC0+YmF0Y2gpPyRpdGVtLT5iYXRjaC0+YmF0Y2g6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2JhdGNoX2lkJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0uYmF0Y2gnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnYmF0Y2gnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhc3NldF9jb2RlJywgZnVuY3Rpb24oJGl0ZW0pewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkaXRlbS0+YXNzZXRfY29kZSk/JGl0ZW0tPmFzc2V0X2NvZGU6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2Fzc2V0X2NvZGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdhc3NldF9jb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY3VycmVudF9sb2NhdGlvbicsIGZ1bmN0aW9uKCRpdGVtKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJGl0ZW0tPmN1cnJlbnRVc2VyLT5pZCkgPyAoJGl0ZW0tPmN1cnJlbnRVc2VyLT5maXhlZEFzc2V0TG9jYXRpb24gPyAkaXRlbS0+Y3VycmVudFVzZXItPmZpeGVkQXNzZXRMb2NhdGlvbi0+bmFtZSA6ICcnKSA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdjdXJyZW50X2xvY2F0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnY3VycmVudFVzZXIuZml4ZWRBc3NldExvY2F0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjdXJyZW50X3VzZXInLCBmdW5jdGlvbigkaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRpdGVtLT5jdXJyZW50VXNlci0+aWQpID8gKCRpdGVtLT5jdXJyZW50VXNlci0+dXNlciA/ICRpdGVtLT5jdXJyZW50VXNlci0+dXNlci0+bmFtZS4nICgnLiRpdGVtLT5jdXJyZW50VXNlci0+dXNlci0+cGhvbmUuJyknIDogJycpIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2N1cnJlbnRfdXNlcicsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2N1cnJlbnRVc2VyLnVzZXInLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyktPndoZXJlKCdwaG9uZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2N1cnJlbmN5JywgZnVuY3Rpb24oJGl0ZW0pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkaXRlbS0+YmF0Y2gtPmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4tPnJlbFB1cmNoYXNlT3JkZXItPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+Y29kZTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbFB1cmNoYXNlT3JkZXIucmVsUXVvdGF0aW9uLmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbigncHVyY2hhc2VfcHJpY2UnLCBmdW5jdGlvbigkaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbU1vbmV5Rm9ybWF0KEZpeGVkQXNzZXRCYXRjaEl0ZW06OndoZXJlKCdhc3NldF9jb2RlJywgJGl0ZW0tPmFzc2V0X2NvZGUpLT5zdW0oJ2Fzc2V0X3ZhbHVlJykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdkZXByZWNpYXRpb25fc3RhcnRzJywgZnVuY3Rpb24oJGl0ZW0pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkaXRlbS0+YmF0Y2gtPmRlcHJlY2lhdGlvbl9zdGFydF9kYXRlOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdkZXByZWNpYXRpb25fc3RhcnRzJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2gnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnZGVwcmVjaWF0aW9uX3N0YXJ0X2RhdGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCd0b3RhbF9kZXByZWNpYXRpb24nLCBmdW5jdGlvbigkaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgJGFtb3VudCA9IEZpeGVkQXNzZXRCYXRjaEl0ZW1EZXByZWNpYXRpb246OndoZXJlSGFzKCdiYXRjaEl0ZW0nLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdhc3NldF9jb2RlJywgJGl0ZW0tPmFzc2V0X2NvZGUpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT53aGVuKHJlcXVlc3QoKS0+aGFzKCdmcm9tJykgJiYgc3RydG90aW1lKHJlcXVlc3QoKS0+Z2V0KCdmcm9tJykpID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Zyb20nLCAnPj0nLCByZXF1ZXN0KCktPmdldCgnZnJvbScpKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+d2hlbihyZXF1ZXN0KCktPmhhcygndG8nKSAmJiBzdHJ0b3RpbWUocmVxdWVzdCgpLT5nZXQoJ3RvJykpID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3RvJywgJzw9JywgcmVxdWVzdCgpLT5nZXQoJ3RvJykpOwogICAgICAgICAgICAgICAgICAgIH0pLT5zdW0oJ2Ftb3VudCcpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBzeXN0ZW1Nb25leUZvcm1hdCgkYW1vdW50KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYm9va192YWx1ZScsIGZ1bmN0aW9uKCRpdGVtKXsKICAgICAgICAgICAgICAgICAgICAkYXNzZXRfdmFsdWUgPSBGaXhlZEFzc2V0QmF0Y2hJdGVtOjp3aGVyZSgnYXNzZXRfY29kZScsICRpdGVtLT5hc3NldF9jb2RlKS0+c3VtKCdhc3NldF92YWx1ZScpOwogICAgICAgICAgICAgICAgICAgICRkZXByZWNpYXRpb25zID0gRml4ZWRBc3NldEJhdGNoSXRlbURlcHJlY2lhdGlvbjo6d2hlcmVIYXMoJ2JhdGNoSXRlbScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRpdGVtKXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Fzc2V0X2NvZGUnLCAkaXRlbS0+YXNzZXRfY29kZSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPndoZW4ocmVxdWVzdCgpLT5oYXMoJ3RvJykgJiYgc3RydG90aW1lKHJlcXVlc3QoKS0+Z2V0KCd0bycpKSA+IDAsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd0bycsICc8PScsIHJlcXVlc3QoKS0+Z2V0KCd0bycpKTsKICAgICAgICAgICAgICAgICAgICB9KS0+c3VtKCdhbW91bnQnKTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbU1vbmV5Rm9ybWF0KCRhc3NldF92YWx1ZS0kZGVwcmVjaWF0aW9ucyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFtdKQogICAgICAgICAgICAgICAgLT5tYWtlKHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmZpeGVkQXNzZXRzLmZpeGVkQXNzZXRzVmFsdWF0aW9ucy5pbmRleCcsIFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJ0ZpeGVkIEFzc2V0IEJvb2sgVmFsdWUnLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgIGlmKHJlcXVlc3QoKS0+Z2V0KCdhY3Rpb24nKSA9PSAnYmF0Y2hlcycpewogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICdiYXRjaGVzJyA9PiBGaXhlZEFzc2V0QmF0Y2g6OndoZXJlSGFzKCdpdGVtcycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2lzX2Rpc3Bvc2VkJywgMCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT53aGVuKHJlcXVlc3QoKS0+Z2V0KCdwcm9kdWN0X2lkJykgPiAwLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdyZXF1aXNpdGlvbkRlbGl2ZXJ5SXRlbScsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdwcm9kdWN0X2lkJywgcmVxdWVzdCgpLT5nZXQoJ3Byb2R1Y3RfaWQnKSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5nZXQoKSwKICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5maXhlZEFzc2V0c1ZhbHVhdGlvbnMuYmF0Y2hlcycsICRkYXRhKTsKICAgICAgICB9ZWxzZWlmKHJlcXVlc3QoKS0+Z2V0KCdhY3Rpb24nKSA9PSAnaXRlbXMnKXsKCiAgICAgICAgICAgICRpdGVtcyA9IEZpeGVkQXNzZXRCYXRjaEl0ZW06OndpdGgoWwogICAgICAgICAgICAgICAgICAgICdiYXRjaC5pdGVtcycsCiAgICAgICAgICAgICAgICAgICAgJ2JhdGNoLnJlcXVpc2l0aW9uRGVsaXZlcnlJdGVtLnByb2R1Y3QuYXR0cmlidXRlcy5hdHRyaWJ1dGVPcHRpb24uYXR0cmlidXRlJywKICAgICAgICAgICAgICAgICAgICAnYmF0Y2guZ29vZHNSZWNlaXZlZEl0ZW1zU3RvY2tJbi5yZWxQdXJjaGFzZU9yZGVyLnJlbFF1b3RhdGlvbi5leGNoYW5nZVJhdGUuY3VycmVuY3knLAogICAgICAgICAgICAgICAgICAgICdkZXByZWNpYXRpb25zJwogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2lzX2Rpc3Bvc2VkJywgMCkKICAgICAgICAgICAgICAgIC0+d2hlbihyZXF1ZXN0KCktPmdldCgnZml4ZWRfYXNzZXRfYmF0Y2hfaWQnKSA+IDAsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2ZpeGVkX2Fzc2V0X2JhdGNoX2lkJywgcmVxdWVzdCgpLT5nZXQoJ2ZpeGVkX2Fzc2V0X2JhdGNoX2lkJykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+d2hlbighZW1wdHkocmVxdWVzdCgpLT5nZXQoJ2Fzc2V0X2NvZGUnKSksIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Fzc2V0X2NvZGUnLCByZXF1ZXN0KCktPmdldCgnYXNzZXRfY29kZScpKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmdldCgpOwoKICAgICAgICAgICAgICAgIGZvcmVhY2goJGl0ZW1zIGFzICRpdGVtKXsKICAgICAgICAgICAgICAgICAgICAkaXRlbVsnY3VycmVudFVzZXInXSA9IFxBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXEZpeGVkQXNzZXRCYXRjaEl0ZW1Vc2VyOjp3aGVyZShbCiAgICAgICAgICAgICAgICAgICAgICAgICdmaXhlZF9hc3NldF9iYXRjaF9pdGVtX2lkJyA9PiAkaXRlbS0+aWQsCiAgICAgICAgICAgICAgICAgICAgICAgICdpc190YWtlbicgPT4gMAogICAgICAgICAgICAgICAgICAgIF0pLT5vcmRlckJ5KCdmcm9tJywgJ2Rlc2MnKS0+Zmlyc3QoKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3VzZXJzJyA9PiBVc2VyOjphbGwoKSwKICAgICAgICAgICAgICAgICdmcm9tJyA9PiAoIWVtcHR5KHJlcXVlc3QoKS0+Z2V0KCdmcm9tJykpICYmIHN0cnRvdGltZShyZXF1ZXN0KCktPmdldCgnZnJvbScpKSA+IDAgPyByZXF1ZXN0KCktPmdldCgnZnJvbScpIDogZmFsc2UpLAogICAgICAgICAgICAgICAgJ3RvJyA9PiAoIWVtcHR5KHJlcXVlc3QoKS0+Z2V0KCd0bycpKSAmJiBzdHJ0b3RpbWUocmVxdWVzdCgpLT5nZXQoJ3RvJykpID4gMCA/IHJlcXVlc3QoKS0+Z2V0KCd0bycpIDogZmFsc2UpLAogICAgICAgICAgICAgICAgJ2l0ZW1zJyA9PiAkaXRlbXMsCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMuZml4ZWRBc3NldHNWYWx1YXRpb25zLml0ZW1zJywgJGRhdGEpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc2hvdygkaWQpCiAgICB7CiAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICd1c2VycycgPT4gRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI6OndoZXJlKCdmaXhlZF9hc3NldF9iYXRjaF9pdGVtX2lkJywgJGlkKS0+Z2V0KCkKICAgICAgICBdOwogICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMuZml4ZWRBc3NldHNWYWx1YXRpb25zLmhpc3RvcnknLCAkZGF0YSk7CiAgICB9Cgp9Cg==