<?php
bolt_decrypt( __FILE__ , 'In03wo'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nXEZpeGVkQXNzZXRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXEZpeGVkQXNzZXRCYXRjaDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbTsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEl0ZW1Nb3ZlbWVudDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI7CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXENhdGVnb3J5Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHJvZHVjdDsKCnVzZSBBcHAsREIsIERhdGFUYWJsZXM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwoKY2xhc3MgRml4ZWRBc3NldE1vdmVtZW50Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKeyAgIAogICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgICB7CiAgICAgICAgJHJvd3MgPSAgYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwKICAgICAgICAgICAgWydhc3NldCcsICdhc3NldCcsJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnR1JOJywgJ0dSTicsJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYmF0Y2hfaWQnLCAnYmF0Y2hfaWQnLCd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2Fzc2V0X2NvZGUnLCAnYXNzZXRfY29kZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3JlcXVlc3RlZF9ieScsICdyZXF1ZXN0ZWRfYnknLCAndGV4dC1jZW50ZXInXSwgCiAgICAgICAgICAgIFsnbG9jYXRpb24nLCAnbG9jYXRpb24nLCAndGV4dC1jZW50ZXInXSwgCiAgICAgICAgICAgIFsnbW92ZV90bycsICdtb3ZlX3RvJywgJ3RleHQtY2VudGVyJ10sIAogICAgICAgICAgICBbJ3JlbWFya3MnLCAncmVtYXJrcycsICd0ZXh0LWNlbnRlciddLCAKICAgICAgICAgICAgWydhY3Rpb25zJywgJ2FjdGlvbnMnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICApOwogICAgICAgIHJldHVybiAkcm93czsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgICR0aXRsZSA9ICdGaXhlZCBBc3NldCBNb3ZlbWVudHMnOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRtb3ZlbWVudHM9IEZpeGVkQXNzZXRJdGVtTW92ZW1lbnQ6OndpdGgoWwogICAgICAgICAgICAgICAgJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtLmJhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsR29vZHNSZWNlaXZlZEl0ZW1zLnJlbFByb2R1Y3QuYXR0cmlidXRlcy5hdHRyaWJ1dGVPcHRpb24uYXR0cmlidXRlJywKICAgICAgICAgICAgICAgICdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5iYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy5yZWxHb29kc1JlY2VpdmVkTm90ZScsCiAgICAgICAgICAgICAgICAnYmF0Y2hJdGVtVXNlci51c2VyJywKICAgICAgICAgICAgICAgICd1c2VyJwogICAgICAgICAgICBdKQogICAgICAgICAgICAtPndoZXJlSGFzKCdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5iYXRjaC5jb3N0Q2VudHJlLnByb2ZpdENlbnRyZScsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUluKCdjb21wYW55X2lkJywgYXV0aCgpLT51c2VyKCktPmNvbXBhbmllcy0+cGx1Y2soJ2NvbXBhbnlfaWQnKS0+dG9BcnJheSgpKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0nLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2lzX2Rpc3Bvc2VkJywgMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlbighZGF0YXRhYmxlT3JkZXJpbmcoKSwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2lkJywgJ2Rlc2MnKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAocmVxdWVzdCgpLT5hamF4KCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBEYXRhdGFibGVzOjpvZigkbW92ZW1lbnRzKQogICAgICAgICAgICAgICAgLT5hZGRJbmRleENvbHVtbigpCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYXNzZXQnLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+ZmluYWxBc3NldC0+bmFtZSkgPyAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+ZmluYWxBc3NldC0+bmFtZS4nICcuZ2V0UHJvZHVjdEF0dHJpYnV0ZXNGYXN0ZXIoJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmZpbmFsQXNzZXQpIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2Fzc2V0JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0uZmluYWxBc3NldCcsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignR1JOJywgZnVuY3Rpb24oJG1vdmVtZW50KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmJhdGNoLT5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLT5yZWxHb29kc1JlY2VpdmVkSXRlbXMtPnJlbEdvb2RzUmVjZWl2ZWROb3RlLT5ncm5fcmVmZXJlbmNlX25vKSA/ICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5iYXRjaC0+Z29vZHNSZWNlaXZlZEl0ZW1zU3RvY2tJbi0+cmVsR29vZHNSZWNlaXZlZEl0ZW1zLT5yZWxHb29kc1JlY2VpdmVkTm90ZS0+Z3JuX3JlZmVyZW5jZV9ubyA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdHUk4nLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5iYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy5yZWxHb29kc1JlY2VpdmVkTm90ZScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdncm5fcmVmZXJlbmNlX25vJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYmF0Y2hfaWQnLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+YmF0Y2gtPmJhdGNoKT8kbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+YmF0Y2gtPmJhdGNoOicnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdiYXRjaF9pZCcsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtLmJhdGNoJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2JhdGNoJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYXNzZXRfY29kZScsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5hc3NldF9jb2RlKT8kbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+YXNzZXRfY29kZTonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignYXNzZXRfY29kZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2Fzc2V0X2NvZGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdyZXF1ZXN0ZWRfYnknLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAgJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT51c2VyLT5uYW1lLicgKCcuJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT51c2VyLT5waG9uZS4nKSc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3JlcXVlc3RlZF9ieScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoSXRlbVVzZXIudXNlcicsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ3Bob25lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignbG9jYXRpb24nLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkbW92ZW1lbnQtPmZpeGVkQXNzZXRMb2NhdGlvbiA/ICRtb3ZlbWVudC0+Zml4ZWRBc3NldExvY2F0aW9uLT5uYW1lIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2xvY2F0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZml4ZWRBc3NldExvY2F0aW9uJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdtb3ZlX3RvJywgZnVuY3Rpb24oJG1vdmVtZW50KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJG1vdmVtZW50LT51c2VyID8gJG1vdmVtZW50LT51c2VyLT5uYW1lLicgKCcuJG1vdmVtZW50LT51c2VyLT5waG9uZS4nKScgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignbW92ZV90bycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3VzZXInLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdwaG9uZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FjdGlvbnMnLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMuZml4ZWRBc3NldE1vdmVtZW50cy5hY3Rpb24nLGNvbXBhY3QoJ21vdmVtZW50JykpLT5yZW5kZXIoKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPnJhd0NvbHVtbnMoWydyZXF1ZXN0ZWRfYnknLCdtb3ZlX3RvJywnYWN0aW9ucyddKQogICAgICAgICAgICAgICAgLT5tYWtlKHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJHRpdGxlLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCksCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMuZml4ZWRBc3NldE1vdmVtZW50cy5pbmRleCcsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGNyZWF0ZSgpCiAgICB7CiAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICdiYXRjaGVzJyA9PiBGaXhlZEFzc2V0QmF0Y2g6OndoZXJlSGFzKCdpdGVtcycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnaXNfZGlzcG9zZWQnLCAwKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVyZUhhcygncmVxdWlzaXRpb25EZWxpdmVyeUl0ZW0nLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3Byb2R1Y3RfaWQnLCByZXF1ZXN0KCktPmdldCgncHJvZHVjdF9pZCcpKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT5nZXQoKSwKICAgICAgICAgICAgJ3NlbGVjdGVkJyA9PiByZXF1ZXN0KCktPmhhcygnc2VsZWN0ZWQnKT9yZXF1ZXN0KCktPmdldCgnc2VsZWN0ZWQnKTonJywKICAgICAgICBdOwogICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMuZml4ZWRBc3NldE1vdmVtZW50cy5iYXRjaGVzJywgJGRhdGEpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzaG93KCRpZCkKICAgIHsKICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgJ21vdmVtZW50JyA9PiBGaXhlZEFzc2V0SXRlbU1vdmVtZW50OjpmaW5kT3JGYWlsKCRpZCksCiAgICAgICAgICAgICdzdGF0dXMnID0+IHJlcXVlc3QoKS0+Z2V0KCdzdGF0dXMnKQogICAgICAgIF07CiAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5maXhlZEFzc2V0TW92ZW1lbnRzLmFwcHJvdmFsJywgJGRhdGEpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGUoUmVxdWVzdCAkcmVxdWVzdCwgJGlkKQogICAgewogICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkbW92ZW1lbnQgPSBGaXhlZEFzc2V0SXRlbU1vdmVtZW50OjpmaW5kT3JGYWlsKCRpZCk7CiAgICAgICAgICAgICRtb3ZlbWVudC0+c3RhdHVzID0gJHJlcXVlc3QtPnN0YXR1czsKCiAgICAgICAgICAgIGlmKGluX2FycmF5KCRyZXF1ZXN0LT5zdGF0dXMsIFsnYXBwcm92ZWQnLCAnY2FuY2VsbGVkJ10pKXsKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+YXBwcm92YWxfcmVtYXJrcyA9ICRyZXF1ZXN0LT5yZW1hcmtzOwogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5hcHByb3ZlZF9ieSA9IGF1dGgoKS0+dXNlcigpLT5pZDsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPm1vdmVtZW50X3JlbWFya3MgPSAkcmVxdWVzdC0+cmVtYXJrczsKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+bW92ZWRfYnkgPSBhdXRoKCktPnVzZXIoKS0+aWQ7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRtb3ZlbWVudC0+c2F2ZSgpOwoKICAgICAgICAgICAgaWYoJHJlcXVlc3QtPnN0YXR1cyA9PSAibW92ZWQiKXsKCiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPnRvID0gZGF0ZSgnWS1tLWQnLCBzdHJ0b3RpbWUoZGF0ZSgnWS1tLWQnLCBzdHJ0b3RpbWUoJG1vdmVtZW50LT5leHBlY3RlZF9kYXRlKSkuJyAtMSBkYXlzJykpOwogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5pc190YWtlbiA9IDE7CiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPnRha2VuX3JlbWFya3MgPSAkcmVxdWVzdC0+cmVtYXJrczsKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+c2F2ZSgpOwoKICAgICAgICAgICAgICAgIEZpeGVkQXNzZXRCYXRjaEl0ZW1Vc2VyOjpjcmVhdGUoWwogICAgICAgICAgICAgICAgICAgICdmaXhlZF9hc3NldF9iYXRjaF9pdGVtX2lkJyA9PiAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmZpeGVkX2Fzc2V0X2JhdGNoX2l0ZW1faWQsCiAgICAgICAgICAgICAgICAgICAgJ2ZpeGVkX2Fzc2V0X2xvY2F0aW9uX2lkJyA9PiAkbW92ZW1lbnQtPmZpeGVkX2Fzc2V0X2xvY2F0aW9uX2lkLAogICAgICAgICAgICAgICAgICAgICdjb3N0X2NlbnRyZV9pZCcgPT4gXEFwcFxVc2VyOjpmaW5kT3JGYWlsKCRtb3ZlbWVudC0+dXNlcl9pZCktPmNvc3RfY2VudHJlX2lkLAogICAgICAgICAgICAgICAgICAgICd1c2VyX2lkJyA9PiAkbW92ZW1lbnQtPnVzZXJfaWQsCiAgICAgICAgICAgICAgICAgICAgJ2Zyb20nID0+ICRtb3ZlbWVudC0+ZXhwZWN0ZWRfZGF0ZSwKICAgICAgICAgICAgICAgICAgICAnZ2l2aW5nX3JlbWFya3MnID0+ICRyZXF1ZXN0LT5yZW1hcmtzLAogICAgICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgaWYoJG1vdmVtZW50LT51c2VyX2lkID4gMCl7CiAgICAgICAgICAgICAgICAgICAgJG1lc3NhZ2VzID0gJzxzcGFuIGNsYXNzPSJub3RpZmljYXRpb24tbGlua3MiIGRhdGEtdGl0bGU9IkZpeGVkIEFzc2V0IERpc3RyaWJ1dGlvbiI+QSBOZXcgRml4ZWQgQXNzZXQgd2l0aCBBc3NldCBjb2RlICMnLiRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5hc3NldF9jb2RlLicgaGFzIGJlZW4gZ2l2ZW4gdG8geW91Ljwvc3Bhbj4nOwogICAgICAgICAgICAgICAgICAgIENyZWF0ZU9yVXBkYXRlTm90aWZpY2F0aW9uKCRtZXNzYWdlcywgJ3VucmVhZCcsICcnLCAnJywgJG1vdmVtZW50LT51c2VyX2lkLCcnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAiRml4ZWQgSXRlbXMgTW92ZW1lbnQgUmVxdWlzaXRpb24gaGFzIGJlZW4gIi51Y3dvcmRzKCRyZXF1ZXN0LT5zdGF0dXMpLiIgU3VjY2Vzc2Z1bGx5LiIKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIERCOjpyb2xsYmFjaygpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJHRoLT5nZXRNZXNzYWdlKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfQogICAgfQp9Cg==