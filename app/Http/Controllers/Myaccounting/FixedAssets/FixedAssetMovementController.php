<?php
bolt_decrypt( __FILE__ , 'QdoX7M'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nXEZpeGVkQXNzZXRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXEZpeGVkQXNzZXRCYXRjaDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbTsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEl0ZW1Nb3ZlbWVudDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI7CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXENhdGVnb3J5Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHJvZHVjdDsKCnVzZSBBcHAsREIsIERhdGFUYWJsZXM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwoKY2xhc3MgRml4ZWRBc3NldE1vdmVtZW50Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKeyAgIAogICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgICB7CiAgICAgICAgJHJvd3MgPSAgYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwKICAgICAgICAgICAgWydjb21wYW55JywgJ2NvbXBhbnknLCd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2Fzc2V0JywgJ2Fzc2V0JywndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydHUk4nLCAnR1JOJywndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydiYXRjaF9pZCcsICdiYXRjaF9pZCcsJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYXNzZXRfY29kZScsICdhc3NldF9jb2RlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsncmVxdWVzdGVkX2J5JywgJ3JlcXVlc3RlZF9ieScsICd0ZXh0LWNlbnRlciddLCAKICAgICAgICAgICAgWydsb2NhdGlvbicsICdsb2NhdGlvbicsICd0ZXh0LWNlbnRlciddLCAKICAgICAgICAgICAgWydtb3ZlX3RvJywgJ21vdmVfdG8nLCAndGV4dC1jZW50ZXInXSwgCiAgICAgICAgICAgIFsncmVtYXJrcycsICdyZW1hcmtzJywgJ3RleHQtY2VudGVyJ10sIAogICAgICAgICAgICBbJ2FjdGlvbnMnLCAnYWN0aW9ucycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICk7CiAgICAgICAgcmV0dXJuICRyb3dzOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHJlcXVlc3QoKS0+YWpheCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YXRhYmxlczo6b2YoCiAgICAgICAgICAgICAgICAgICAgRml4ZWRBc3NldEl0ZW1Nb3ZlbWVudDo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5iYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy5yZWxQcm9kdWN0LmF0dHJpYnV0ZXMuYXR0cmlidXRlT3B0aW9uLmF0dHJpYnV0ZScsCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5iYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy5yZWxHb29kc1JlY2VpdmVkTm90ZScsCiAgICAgICAgICAgICAgICAgICAgICAgICdiYXRjaEl0ZW1Vc2VyLnVzZXInLAogICAgICAgICAgICAgICAgICAgICAgICAndXNlcicsCgogICAgICAgICAgICAgICAgICAgICAgICAnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0uYmF0Y2guY29zdENlbnRyZS5wcm9maXRDZW50cmUuY29tcGFueScKICAgICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtLmJhdGNoLmNvc3RDZW50cmUucHJvZml0Q2VudHJlJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVJbignY29tcGFueV9pZCcsIGF1dGgoKS0+dXNlcigpLT5jb21wYW5pZXMtPnBsdWNrKCdjb21wYW55X2lkJyktPnRvQXJyYXkoKSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbScsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdpc19kaXNwb3NlZCcsIDApOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT53aGVuKCFkYXRhdGFibGVPcmRlcmluZygpLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCdpZCcsICdkZXNjJyk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQoKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjb21wYW55JywgZnVuY3Rpb24oJG1vdmVtZW50KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmJhdGNoLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPmNvZGUpID8gJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmJhdGNoLT5jb3N0Q2VudHJlLT5wcm9maXRDZW50cmUtPmNvbXBhbnktPmNvZGUgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY29tcGFueScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtLmJhdGNoLmNvc3RDZW50cmUucHJvZml0Q2VudHJlLmNvbXBhbnknLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnY29kZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhc3NldCcsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5maW5hbEFzc2V0LT5uYW1lKSA/ICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5maW5hbEFzc2V0LT5uYW1lLicgJy5nZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+ZmluYWxBc3NldCkgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignYXNzZXQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5maW5hbEFzc2V0JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdHUk4nLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+YmF0Y2gtPmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4tPnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy0+cmVsR29vZHNSZWNlaXZlZE5vdGUtPmdybl9yZWZlcmVuY2Vfbm8pID8gJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmJhdGNoLT5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLT5yZWxHb29kc1JlY2VpdmVkSXRlbXMtPnJlbEdvb2RzUmVjZWl2ZWROb3RlLT5ncm5fcmVmZXJlbmNlX25vIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ0dSTicsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtLmJhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsR29vZHNSZWNlaXZlZEl0ZW1zLnJlbEdvb2RzUmVjZWl2ZWROb3RlJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2dybl9yZWZlcmVuY2Vfbm8nLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdiYXRjaF9pZCcsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5iYXRjaC0+YmF0Y2gpPyRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5iYXRjaC0+YmF0Y2g6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2JhdGNoX2lkJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0uYmF0Y2gnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnYmF0Y2gnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhc3NldF9jb2RlJywgZnVuY3Rpb24oJG1vdmVtZW50KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmFzc2V0X2NvZGUpPyRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5hc3NldF9jb2RlOicnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhc3NldF9jb2RlJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0nLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnYXNzZXRfY29kZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3JlcXVlc3RlZF9ieScsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPnVzZXItPm5hbWUuJyAoJy4kbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPnVzZXItPnBob25lLicpJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncmVxdWVzdGVkX2J5JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci51c2VyJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZSgncGhvbmUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdsb2NhdGlvbicsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRtb3ZlbWVudC0+Zml4ZWRBc3NldExvY2F0aW9uID8gJG1vdmVtZW50LT5maXhlZEFzc2V0TG9jYXRpb24tPm5hbWUgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignbG9jYXRpb24nLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdmaXhlZEFzc2V0TG9jYXRpb24nLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ21vdmVfdG8nLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkbW92ZW1lbnQtPnVzZXIgPyAkbW92ZW1lbnQtPnVzZXItPm5hbWUuJyAoJy4kbW92ZW1lbnQtPnVzZXItPnBob25lLicpJyA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdtb3ZlX3RvJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygndXNlcicsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ3Bob25lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYWN0aW9ucycsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5maXhlZEFzc2V0TW92ZW1lbnRzLmFjdGlvbicsY29tcGFjdCgnbW92ZW1lbnQnKSktPnJlbmRlcigpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbJ3JlcXVlc3RlZF9ieScsJ21vdmVfdG8nLCdhY3Rpb25zJ10pCiAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnRml4ZWQgQXNzZXQgTW92ZW1lbnRzJywKICAgICAgICAgICAgICAgICdoZWFkZXJDb2x1bW5zJyA9PiAkdGhpcy0+aGVhZGVyQ29sdW1ucygpLAogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmZpeGVkQXNzZXRzLmZpeGVkQXNzZXRNb3ZlbWVudHMuaW5kZXgnLCAkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAnYmF0Y2hlcycgPT4gRml4ZWRBc3NldEJhdGNoOjp3aGVyZUhhcygnaXRlbXMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2lzX2Rpc3Bvc2VkJywgMCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ3JlcXVpc2l0aW9uRGVsaXZlcnlJdGVtJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdwcm9kdWN0X2lkJywgcmVxdWVzdCgpLT5nZXQoJ3Byb2R1Y3RfaWQnKSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+Z2V0KCksCiAgICAgICAgICAgICdzZWxlY3RlZCcgPT4gcmVxdWVzdCgpLT5oYXMoJ3NlbGVjdGVkJyk/cmVxdWVzdCgpLT5nZXQoJ3NlbGVjdGVkJyk6JycsCiAgICAgICAgXTsKICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmZpeGVkQXNzZXRzLmZpeGVkQXNzZXRNb3ZlbWVudHMuYmF0Y2hlcycsICRkYXRhKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc2hvdygkaWQpCiAgICB7CiAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICdtb3ZlbWVudCcgPT4gRml4ZWRBc3NldEl0ZW1Nb3ZlbWVudDo6ZmluZE9yRmFpbCgkaWQpLAogICAgICAgICAgICAnc3RhdHVzJyA9PiByZXF1ZXN0KCktPmdldCgnc3RhdHVzJykKICAgICAgICBdOwogICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuZml4ZWRBc3NldHMuZml4ZWRBc3NldE1vdmVtZW50cy5hcHByb3ZhbCcsICRkYXRhKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gdXBkYXRlKFJlcXVlc3QgJHJlcXVlc3QsICRpZCkKICAgIHsKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJG1vdmVtZW50ID0gRml4ZWRBc3NldEl0ZW1Nb3ZlbWVudDo6ZmluZE9yRmFpbCgkaWQpOwogICAgICAgICAgICAkbW92ZW1lbnQtPnN0YXR1cyA9ICRyZXF1ZXN0LT5zdGF0dXM7CgogICAgICAgICAgICBpZihpbl9hcnJheSgkcmVxdWVzdC0+c3RhdHVzLCBbJ2FwcHJvdmVkJywgJ2NhbmNlbGxlZCddKSl7CiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPmFwcHJvdmFsX3JlbWFya3MgPSAkcmVxdWVzdC0+cmVtYXJrczsKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+YXBwcm92ZWRfYnkgPSBhdXRoKCktPnVzZXIoKS0+aWQ7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5tb3ZlbWVudF9yZW1hcmtzID0gJHJlcXVlc3QtPnJlbWFya3M7CiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPm1vdmVkX2J5ID0gYXV0aCgpLT51c2VyKCktPmlkOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkbW92ZW1lbnQtPnNhdmUoKTsKCiAgICAgICAgICAgIGlmKCRyZXF1ZXN0LT5zdGF0dXMgPT0gIm1vdmVkIil7CgogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT50byA9IGRhdGUoJ1ktbS1kJywgc3RydG90aW1lKGRhdGUoJ1ktbS1kJywgc3RydG90aW1lKCRtb3ZlbWVudC0+ZXhwZWN0ZWRfZGF0ZSkpLicgLTEgZGF5cycpKTsKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+aXNfdGFrZW4gPSAxOwogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT50YWtlbl9yZW1hcmtzID0gJHJlcXVlc3QtPnJlbWFya3M7CiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPnNhdmUoKTsKCiAgICAgICAgICAgICAgICBGaXhlZEFzc2V0QmF0Y2hJdGVtVXNlcjo6Y3JlYXRlKFsKICAgICAgICAgICAgICAgICAgICAnZml4ZWRfYXNzZXRfYmF0Y2hfaXRlbV9pZCcgPT4gJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5maXhlZF9hc3NldF9iYXRjaF9pdGVtX2lkLAogICAgICAgICAgICAgICAgICAgICdmaXhlZF9hc3NldF9sb2NhdGlvbl9pZCcgPT4gJG1vdmVtZW50LT5maXhlZF9hc3NldF9sb2NhdGlvbl9pZCwKICAgICAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+IFxBcHBcVXNlcjo6ZmluZE9yRmFpbCgkbW92ZW1lbnQtPnVzZXJfaWQpLT5jb3N0X2NlbnRyZV9pZCwKICAgICAgICAgICAgICAgICAgICAndXNlcl9pZCcgPT4gJG1vdmVtZW50LT51c2VyX2lkLAogICAgICAgICAgICAgICAgICAgICdmcm9tJyA9PiAkbW92ZW1lbnQtPmV4cGVjdGVkX2RhdGUsCiAgICAgICAgICAgICAgICAgICAgJ2dpdmluZ19yZW1hcmtzJyA9PiAkcmVxdWVzdC0+cmVtYXJrcywKICAgICAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgICAgIGlmKCRtb3ZlbWVudC0+dXNlcl9pZCA+IDApewogICAgICAgICAgICAgICAgICAgICRtZXNzYWdlcyA9ICc8c3BhbiBjbGFzcz0ibm90aWZpY2F0aW9uLWxpbmtzIiBkYXRhLXRpdGxlPSJGaXhlZCBBc3NldCBEaXN0cmlidXRpb24iPkEgTmV3IEZpeGVkIEFzc2V0IHdpdGggQXNzZXQgY29kZSAjJy4kbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+YXNzZXRfY29kZS4nIGhhcyBiZWVuIGdpdmVuIHRvIHlvdS48L3NwYW4+JzsKICAgICAgICAgICAgICAgICAgICBDcmVhdGVPclVwZGF0ZU5vdGlmaWNhdGlvbigkbWVzc2FnZXMsICd1bnJlYWQnLCAnJywgWyRtb3ZlbWVudC0+dXNlcl9pZF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJGaXhlZCBJdGVtcyBNb3ZlbWVudCBSZXF1aXNpdGlvbiBoYXMgYmVlbiAiLnVjd29yZHMoJHJlcXVlc3QtPnN0YXR1cykuIiBTdWNjZXNzZnVsbHkuIgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9Cn0K