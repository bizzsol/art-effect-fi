<?php
bolt_decrypt( __FILE__ , 'FWAt6x'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nXEZpeGVkQXNzZXRzOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBBcHBcTW9kZWxzXEZpeGVkQXNzZXRzXEZpeGVkQXNzZXRCYXRjaDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbTsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEl0ZW1Nb3ZlbWVudDsKdXNlIEFwcFxNb2RlbHNcRml4ZWRBc3NldHNcRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI7CnVzZSBBcHBcVXNlcjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXENhdGVnb3J5Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHJvZHVjdDsKCnVzZSBBcHAsREIsIERhdGFUYWJsZXM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwoKY2xhc3MgRml4ZWRBc3NldE1vdmVtZW50Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKeyAgIAogICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgICB7CiAgICAgICAgJHJvd3MgPSAgYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwKICAgICAgICAgICAgWydhc3NldCcsICdhc3NldCcsJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnR1JOJywgJ0dSTicsJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYmF0Y2hfaWQnLCAnYmF0Y2hfaWQnLCd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2Fzc2V0X2NvZGUnLCAnYXNzZXRfY29kZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3JlcXVlc3RlZF9ieScsICdyZXF1ZXN0ZWRfYnknLCAndGV4dC1jZW50ZXInXSwgCiAgICAgICAgICAgIFsnbG9jYXRpb24nLCAnbG9jYXRpb24nLCAndGV4dC1jZW50ZXInXSwgCiAgICAgICAgICAgIFsnbW92ZV90bycsICdtb3ZlX3RvJywgJ3RleHQtY2VudGVyJ10sIAogICAgICAgICAgICBbJ3JlbWFya3MnLCAncmVtYXJrcycsICd0ZXh0LWNlbnRlciddLCAKICAgICAgICAgICAgWydhY3Rpb25zJywgJ2FjdGlvbnMnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICApOwogICAgICAgIHJldHVybiAkcm93czsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgICR0aXRsZSA9ICdGaXhlZCBBc3NldCBNb3ZlbWVudHMnOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRtb3ZlbWVudHM9IEZpeGVkQXNzZXRJdGVtTW92ZW1lbnQ6OndpdGgoWwogICAgICAgICAgICAgICAgJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtLmJhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsR29vZHNSZWNlaXZlZEl0ZW1zLnJlbFByb2R1Y3QuYXR0cmlidXRlcy5hdHRyaWJ1dGVPcHRpb24uYXR0cmlidXRlJywKICAgICAgICAgICAgICAgICdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5iYXRjaC5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy5yZWxHb29kc1JlY2VpdmVkTm90ZScsCiAgICAgICAgICAgICAgICAnYmF0Y2hJdGVtVXNlci51c2VyJywKICAgICAgICAgICAgICAgICd1c2VyJwogICAgICAgICAgICBdKQogICAgICAgICAgICAtPndoZXJlSGFzKCdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbScsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnaXNfZGlzcG9zZWQnLCAwKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVuKCFkYXRhdGFibGVPcmRlcmluZygpLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaWQnLCAnZGVzYycpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGF0YWJsZXM6Om9mKCRtb3ZlbWVudHMpCiAgICAgICAgICAgICAgICAtPmFkZEluZGV4Q29sdW1uKCkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhc3NldCcsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5maW5hbEFzc2V0LT5uYW1lKSA/ICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5maW5hbEFzc2V0LT5uYW1lLicgJy5nZXRQcm9kdWN0QXR0cmlidXRlc0Zhc3RlcigkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+ZmluYWxBc3NldCkgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignYXNzZXQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYXRjaEl0ZW1Vc2VyLmJhdGNoSXRlbS5maW5hbEFzc2V0JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdHUk4nLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmJhdGNoSXRlbS0+YmF0Y2gtPmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4tPnJlbEdvb2RzUmVjZWl2ZWRJdGVtcy0+cmVsR29vZHNSZWNlaXZlZE5vdGUtPmdybl9yZWZlcmVuY2Vfbm8pID8gJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmJhdGNoLT5nb29kc1JlY2VpdmVkSXRlbXNTdG9ja0luLT5yZWxHb29kc1JlY2VpdmVkSXRlbXMtPnJlbEdvb2RzUmVjZWl2ZWROb3RlLT5ncm5fcmVmZXJlbmNlX25vIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ0dSTicsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhdGNoSXRlbVVzZXIuYmF0Y2hJdGVtLmJhdGNoLmdvb2RzUmVjZWl2ZWRJdGVtc1N0b2NrSW4ucmVsR29vZHNSZWNlaXZlZEl0ZW1zLnJlbEdvb2RzUmVjZWl2ZWROb3RlJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2dybl9yZWZlcmVuY2Vfbm8nLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdiYXRjaF9pZCcsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5iYXRjaC0+YmF0Y2gpPyRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5iYXRjaC0+YmF0Y2g6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2JhdGNoX2lkJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0uYmF0Y2gnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnYmF0Y2gnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhc3NldF9jb2RlJywgZnVuY3Rpb24oJG1vdmVtZW50KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmFzc2V0X2NvZGUpPyRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+YmF0Y2hJdGVtLT5hc3NldF9jb2RlOicnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhc3NldF9jb2RlJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci5iYXRjaEl0ZW0nLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnYXNzZXRfY29kZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3JlcXVlc3RlZF9ieScsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPnVzZXItPm5hbWUuJyAoJy4kbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPnVzZXItPnBob25lLicpJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncmVxdWVzdGVkX2J5JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmF0Y2hJdGVtVXNlci51c2VyJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZSgncGhvbmUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdsb2NhdGlvbicsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRtb3ZlbWVudC0+Zml4ZWRBc3NldExvY2F0aW9uID8gJG1vdmVtZW50LT5maXhlZEFzc2V0TG9jYXRpb24tPm5hbWUgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignbG9jYXRpb24nLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdmaXhlZEFzc2V0TG9jYXRpb24nLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ21vdmVfdG8nLCBmdW5jdGlvbigkbW92ZW1lbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkbW92ZW1lbnQtPnVzZXIgPyAkbW92ZW1lbnQtPnVzZXItPm5hbWUuJyAoJy4kbW92ZW1lbnQtPnVzZXItPnBob25lLicpJyA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdtb3ZlX3RvJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygndXNlcicsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ3Bob25lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYWN0aW9ucycsIGZ1bmN0aW9uKCRtb3ZlbWVudCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5maXhlZEFzc2V0TW92ZW1lbnRzLmFjdGlvbicsY29tcGFjdCgnbW92ZW1lbnQnKSktPnJlbmRlcigpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbJ3JlcXVlc3RlZF9ieScsJ21vdmVfdG8nLCdhY3Rpb25zJ10pCiAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAkdGl0bGUsCiAgICAgICAgICAgICAgICAnaGVhZGVyQ29sdW1ucycgPT4gJHRoaXMtPmhlYWRlckNvbHVtbnMoKSwKICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5maXhlZEFzc2V0TW92ZW1lbnRzLmluZGV4JywgJGRhdGEpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY3JlYXRlKCkKICAgIHsKICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgJ2JhdGNoZXMnID0+IEZpeGVkQXNzZXRCYXRjaDo6d2hlcmVIYXMoJ2l0ZW1zJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdpc19kaXNwb3NlZCcsIDApOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZXJlSGFzKCdyZXF1aXNpdGlvbkRlbGl2ZXJ5SXRlbScsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgncHJvZHVjdF9pZCcsIHJlcXVlc3QoKS0+Z2V0KCdwcm9kdWN0X2lkJykpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPmdldCgpLAogICAgICAgICAgICAnc2VsZWN0ZWQnID0+IHJlcXVlc3QoKS0+aGFzKCdzZWxlY3RlZCcpP3JlcXVlc3QoKS0+Z2V0KCdzZWxlY3RlZCcpOicnLAogICAgICAgIF07CiAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5maXhlZEFzc2V0cy5maXhlZEFzc2V0TW92ZW1lbnRzLmJhdGNoZXMnLCAkZGF0YSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHNob3coJGlkKQogICAgewogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAnbW92ZW1lbnQnID0+IEZpeGVkQXNzZXRJdGVtTW92ZW1lbnQ6OmZpbmRPckZhaWwoJGlkKSwKICAgICAgICAgICAgJ3N0YXR1cycgPT4gcmVxdWVzdCgpLT5nZXQoJ3N0YXR1cycpCiAgICAgICAgXTsKICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmZpeGVkQXNzZXRzLmZpeGVkQXNzZXRNb3ZlbWVudHMuYXBwcm92YWwnLCAkZGF0YSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRtb3ZlbWVudCA9IEZpeGVkQXNzZXRJdGVtTW92ZW1lbnQ6OmZpbmRPckZhaWwoJGlkKTsKICAgICAgICAgICAgJG1vdmVtZW50LT5zdGF0dXMgPSAkcmVxdWVzdC0+c3RhdHVzOwoKICAgICAgICAgICAgaWYoaW5fYXJyYXkoJHJlcXVlc3QtPnN0YXR1cywgWydhcHByb3ZlZCcsICdjYW5jZWxsZWQnXSkpewogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5hcHByb3ZhbF9yZW1hcmtzID0gJHJlcXVlc3QtPnJlbWFya3M7CiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPmFwcHJvdmVkX2J5ID0gYXV0aCgpLT51c2VyKCktPmlkOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+bW92ZW1lbnRfcmVtYXJrcyA9ICRyZXF1ZXN0LT5yZW1hcmtzOwogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5tb3ZlZF9ieSA9IGF1dGgoKS0+dXNlcigpLT5pZDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJG1vdmVtZW50LT5zYXZlKCk7CgogICAgICAgICAgICBpZigkcmVxdWVzdC0+c3RhdHVzID09ICJtb3ZlZCIpewoKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+dG8gPSBkYXRlKCdZLW0tZCcsIHN0cnRvdGltZShkYXRlKCdZLW0tZCcsIHN0cnRvdGltZSgkbW92ZW1lbnQtPmV4cGVjdGVkX2RhdGUpKS4nIC0xIGRheXMnKSk7CiAgICAgICAgICAgICAgICAkbW92ZW1lbnQtPmJhdGNoSXRlbVVzZXItPmlzX3Rha2VuID0gMTsKICAgICAgICAgICAgICAgICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+dGFrZW5fcmVtYXJrcyA9ICRyZXF1ZXN0LT5yZW1hcmtzOwogICAgICAgICAgICAgICAgJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5zYXZlKCk7CgogICAgICAgICAgICAgICAgRml4ZWRBc3NldEJhdGNoSXRlbVVzZXI6OmNyZWF0ZShbCiAgICAgICAgICAgICAgICAgICAgJ2ZpeGVkX2Fzc2V0X2JhdGNoX2l0ZW1faWQnID0+ICRtb3ZlbWVudC0+YmF0Y2hJdGVtVXNlci0+Zml4ZWRfYXNzZXRfYmF0Y2hfaXRlbV9pZCwKICAgICAgICAgICAgICAgICAgICAnZml4ZWRfYXNzZXRfbG9jYXRpb25faWQnID0+ICRtb3ZlbWVudC0+Zml4ZWRfYXNzZXRfbG9jYXRpb25faWQsCiAgICAgICAgICAgICAgICAgICAgJ3VzZXJfaWQnID0+ICRtb3ZlbWVudC0+dXNlcl9pZCwKICAgICAgICAgICAgICAgICAgICAnZnJvbScgPT4gJG1vdmVtZW50LT5leHBlY3RlZF9kYXRlLAogICAgICAgICAgICAgICAgICAgICdnaXZpbmdfcmVtYXJrcycgPT4gJHJlcXVlc3QtPnJlbWFya3MsCiAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICBpZigkbW92ZW1lbnQtPnVzZXJfaWQgPiAwKXsKICAgICAgICAgICAgICAgICAgICAkbWVzc2FnZXMgPSAnPHNwYW4gY2xhc3M9Im5vdGlmaWNhdGlvbi1saW5rcyIgZGF0YS10aXRsZT0iRml4ZWQgQXNzZXQgRGlzdHJpYnV0aW9uIj5BIE5ldyBGaXhlZCBBc3NldCB3aXRoIEFzc2V0IGNvZGUgIycuJG1vdmVtZW50LT5iYXRjaEl0ZW1Vc2VyLT5iYXRjaEl0ZW0tPmFzc2V0X2NvZGUuJyBoYXMgYmVlbiBnaXZlbiB0byB5b3UuPC9zcGFuPic7CiAgICAgICAgICAgICAgICAgICAgQ3JlYXRlT3JVcGRhdGVOb3RpZmljYXRpb24oJG1lc3NhZ2VzLCAndW5yZWFkJywgJycsICcnLCAkbW92ZW1lbnQtPnVzZXJfaWQsJycpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJGaXhlZCBJdGVtcyBNb3ZlbWVudCBSZXF1aXNpdGlvbiBoYXMgYmVlbiAiLnVjd29yZHMoJHJlcXVlc3QtPnN0YXR1cykuIiBTdWNjZXNzZnVsbHkuIgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9Cn0K