<?php
bolt_decrypt( __FILE__ , '5q5wAm'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29tcGFueTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xQcm9maXRDZW50cmU7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29zdENlbnRyZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5VHlwZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xUYWc7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ2hhcnRPZkFjY291bnQ7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcU3ViTGVkZ2VyOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5SXRlbTsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ3VycmVuY3lUeXBlOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEN1cnJlbmN5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEV4Y2hhbmdlUmF0ZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyQ2xvc2luZzsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyQ2xvc2luZ0xlZGdlcjsKCnVzZSBBcHAsREI7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwoKY2xhc3MgTGVkZ2VyU3RhdGVtZW50Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygnZ2V0LWNvYScpKXsKICAgICAgICAgICAgcmV0dXJuIGNoYXJ0T2ZBY2NvdW50c09wdGlvbnMoW10sIHJlcXVlc3QoKS0+Z2V0KCdjaGFydF9vZl9hY2NvdW50X2lkJyksIDAsIGdldEFsbEdyb3VwQW5kTGVkZ2VycyhmYWxzZSwgdHJ1ZSkpOwogICAgICAgIH0KCiAgICAgICAgJHRpdGxlID0gJ1JlcG9ydCAtIExlZGdlciBTdGF0ZW1lbnQnOwoKICAgICAgICAkY29tcGFueV9pZCA9IHJlcXVlc3QoKS0+aGFzKCdjb21wYW55X2lkJykgPyByZXF1ZXN0KCktPmdldCgnY29tcGFueV9pZCcpIDogMDsKICAgICAgICAkcHJvZml0X2NlbnRyZV9pZCA9IHJlcXVlc3QoKS0+aGFzKCdwcm9maXRfY2VudHJlX2lkJykgPyByZXF1ZXN0KCktPmdldCgncHJvZml0X2NlbnRyZV9pZCcpIDogMDsKICAgICAgICAkY29zdF9jZW50cmVfaWQgPSByZXF1ZXN0KCktPmhhcygnY29zdF9jZW50cmVfaWQnKSA/IHJlcXVlc3QoKS0+Z2V0KCdjb3N0X2NlbnRyZV9pZCcpIDogMDsKICAgICAgICAKICAgICAgICAkY2hhcnRfb2ZfYWNjb3VudF9pZCA9IHJlcXVlc3QoKS0+aGFzKCdjaGFydF9vZl9hY2NvdW50X2lkJykgPyByZXF1ZXN0KCktPmdldCgnY2hhcnRfb2ZfYWNjb3VudF9pZCcpIDogW107CiAgICAgICAgJGNoYXJ0X29mX2FjY291bnRfaWQgPSBpc19hcnJheSgkY2hhcnRfb2ZfYWNjb3VudF9pZCkgJiYgaXNzZXQoJGNoYXJ0X29mX2FjY291bnRfaWRbMF0pID8gJGNoYXJ0X29mX2FjY291bnRfaWQgOiAoIWlzX2FycmF5KCRjaGFydF9vZl9hY2NvdW50X2lkKSAmJiAoaW50KSgkY2hhcnRfb2ZfYWNjb3VudF9pZCkgPiAwID8gWyRjaGFydF9vZl9hY2NvdW50X2lkXSA6IFtdKTsKICAgICAgICAkbmFycmF0aW9uID0gcmVxdWVzdCgpLT5oYXMoJ25hcnJhdGlvbicpID8gcmVxdWVzdCgpLT5nZXQoJ25hcnJhdGlvbicpIDogJyc7CiAgICAgICAgCiAgICAgICAgJHN1Yl9sZWRnZXJfaWQgPSByZXF1ZXN0KCktPmhhcygnc3ViX2xlZGdlcl9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ3N1Yl9sZWRnZXJfaWQnKSA6IFtdOwogICAgICAgICRzdWJfbGVkZ2VyX2lkID0gaXNfYXJyYXkoJHN1Yl9sZWRnZXJfaWQpICYmIGlzc2V0KCRzdWJfbGVkZ2VyX2lkWzBdKSA/ICRzdWJfbGVkZ2VyX2lkIDogKCFpc19hcnJheSgkc3ViX2xlZGdlcl9pZCkgJiYgKGludCkoJHN1Yl9sZWRnZXJfaWQpID4gMCA/IFskc3ViX2xlZGdlcl9pZF0gOiBbXSk7CgogICAgICAgICRjdXJyZW5jeV9pZCA9IHJlcXVlc3QoKS0+aGFzKCdjdXJyZW5jeV9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ2N1cnJlbmN5X2lkJykgOiAwOwogICAgICAgICRmcm9tID0gcmVxdWVzdCgpLT5oYXMoJ2Zyb20nKSA/IHJlcXVlc3QoKS0+Z2V0KCdmcm9tJykgOiBkYXRlKCdZLW0tMDEnKTsKICAgICAgICAkdG8gPSByZXF1ZXN0KCktPmhhcygndG8nKSA/IHJlcXVlc3QoKS0+Z2V0KCd0bycpIDogZGF0ZSgnWS1tLXQnKTsKICAgICAgICAkc2VhcmNoQWNjb3VudHMgPSBDaGFydE9mQWNjb3VudDo6d2l0aChbCiAgICAgICAgICAgICdhY2NvdW50R3JvdXAnCiAgICAgICAgXSkKICAgICAgICAtPndoZXJlSW4oJ2lkJywgJGNoYXJ0X29mX2FjY291bnRfaWQpCiAgICAgICAgLT5nZXQoKTsKICAgICAgICAkZW50cmllcyA9IGZhbHNlOwogICAgICAgICRvcGVuaW5nX2JhbGFuY2UgPSAwOwogICAgICAgIGlmKGlzc2V0KCRjaGFydF9vZl9hY2NvdW50X2lkWzBdKSl7CiAgICAgICAgICAgICRhbGwgPSBnZXRBbGxHcm91cEFuZExlZGdlcnMoKTsKICAgICAgICAgICAgJGFjdGl2ZUZpc2NhbFllYXIgPSBnZXRBY3RpdmVGaXNjYWxZZWFyKCRjb21wYW55X2lkKTsKICAgICAgICAgICAgJHN5c3RlbUN1cnJlbmN5ID0gc3lzdGVtQ3VycmVuY3koKTsKCiAgICAgICAgICAgICRyYXRlID0gMTsKICAgICAgICAgICAgaWYoJHN5c3RlbUN1cnJlbmN5LT5pZCAhPSAkY3VycmVuY3lfaWQpewogICAgICAgICAgICAgICAgJHJhdGVzID0gZ2V0RXhjaGFuZ2VSYXRlcygkc3lzdGVtQ3VycmVuY3ktPmlkKTsKICAgICAgICAgICAgICAgICRyYXRlID0gaXNzZXQoJHJhdGVzWydyYXRlcyddWyRjdXJyZW5jeV9pZF1bJ3JhdGUnXSkgPyAkcmF0ZXNbJ3JhdGVzJ11bJGN1cnJlbmN5X2lkXVsncmF0ZSddIDogMTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGRlYml0RW50cnlJdGVtcyA9IEVudHJ5SXRlbTo6am9pbignZW50cmllcycsICdlbnRyaWVzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuZW50cnlfaWQnKQogICAgICAgICAgICAtPmpvaW4oJ2Nvc3RfY2VudHJlcycsICdjb3N0X2NlbnRyZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jb3N0X2NlbnRyZV9pZCcpCiAgICAgICAgICAgIC0+am9pbigncHJvZml0X2NlbnRyZXMnLCAncHJvZml0X2NlbnRyZXMuaWQnLCAnPScsICdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcpCgogICAgICAgICAgICAtPmpvaW4oJ2NoYXJ0X29mX2FjY291bnRzJywgJ2NoYXJ0X29mX2FjY291bnRzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCiAgICAgICAgICAgIC0+am9pbignYWNjb3VudF9ncm91cHMnLCAnYWNjb3VudF9ncm91cHMuaWQnLCAnPScsICdjaGFydF9vZl9hY2NvdW50cy5hY2NvdW50X2dyb3VwX2lkJykKCiAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKQogICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmRhdGUnLCAnPD0nLCBkYXRlKCdZLW0tZCcsIHN0cnRvdGltZSgkZnJvbS4nIC0xIGRheXMnKSkpCiAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZmlzY2FsX3llYXJfaWQnLCAkYWN0aXZlRmlzY2FsWWVhci0+aWQpCiAgICAgICAgICAgIC0+d2hlcmUoJ3Byb2ZpdF9jZW50cmVzLmNvbXBhbnlfaWQnLCAkY29tcGFueV9pZCkKCiAgICAgICAgICAgIC0+d2hlbigkcHJvZml0X2NlbnRyZV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRwcm9maXRfY2VudHJlX2lkKXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcsICRwcm9maXRfY2VudHJlX2lkKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVuKCRjb3N0X2NlbnRyZV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRjb3N0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZW50cnlfaXRlbXMuY29zdF9jZW50cmVfaWQnLCAkY29zdF9jZW50cmVfaWQpOwogICAgICAgICAgICB9KQoKICAgICAgICAgICAgLT53aGVyZSgnZW50cnlfaXRlbXMuZGViaXRfY3JlZGl0JywgJ0QnKQoKICAgICAgICAgICAgLT5ncm91cEJ5KCdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJykKCiAgICAgICAgICAgIC0+Z2V0KFsKICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcy5zdWJfbGVkZ2VyX2lkJywKICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJywKICAgICAgICAgICAgICAgIERCOjpyYXcoJ3N1bShlbnRyeV9pdGVtcy5yZXBvcnRpbmdfYW1vdW50KSBhcyByZXBvcnRpbmdfYW1vdW50JykKICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAkY3JlZGl0RW50cnlJdGVtcyA9IEVudHJ5SXRlbTo6am9pbignZW50cmllcycsICdlbnRyaWVzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuZW50cnlfaWQnKQogICAgICAgICAgICAtPmpvaW4oJ2Nvc3RfY2VudHJlcycsICdjb3N0X2NlbnRyZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jb3N0X2NlbnRyZV9pZCcpCiAgICAgICAgICAgIC0+am9pbigncHJvZml0X2NlbnRyZXMnLCAncHJvZml0X2NlbnRyZXMuaWQnLCAnPScsICdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcpCgogICAgICAgICAgICAtPmpvaW4oJ2NoYXJ0X29mX2FjY291bnRzJywgJ2NoYXJ0X29mX2FjY291bnRzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCiAgICAgICAgICAgIC0+am9pbignYWNjb3VudF9ncm91cHMnLCAnYWNjb3VudF9ncm91cHMuaWQnLCAnPScsICdjaGFydF9vZl9hY2NvdW50cy5hY2NvdW50X2dyb3VwX2lkJykKCiAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKQogICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmRhdGUnLCAnPD0nLCBkYXRlKCdZLW0tZCcsIHN0cnRvdGltZSgkZnJvbS4nIC0xIGRheXMnKSkpCiAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZmlzY2FsX3llYXJfaWQnLCAkYWN0aXZlRmlzY2FsWWVhci0+aWQpCiAgICAgICAgICAgIC0+d2hlcmUoJ3Byb2ZpdF9jZW50cmVzLmNvbXBhbnlfaWQnLCAkY29tcGFueV9pZCkKCiAgICAgICAgICAgIC0+d2hlbigkcHJvZml0X2NlbnRyZV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRwcm9maXRfY2VudHJlX2lkKXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcsICRwcm9maXRfY2VudHJlX2lkKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVuKCRjb3N0X2NlbnRyZV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRjb3N0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZW50cnlfaXRlbXMuY29zdF9jZW50cmVfaWQnLCAkY29zdF9jZW50cmVfaWQpOwogICAgICAgICAgICB9KQoKICAgICAgICAgICAgLT53aGVyZSgnZW50cnlfaXRlbXMuZGViaXRfY3JlZGl0JywgJ0MnKQoKICAgICAgICAgICAgLT5ncm91cEJ5KCdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJykKCiAgICAgICAgICAgIC0+Z2V0KFsKICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcy5zdWJfbGVkZ2VyX2lkJywKICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJywKICAgICAgICAgICAgICAgIERCOjpyYXcoJ3N1bShlbnRyeV9pdGVtcy5yZXBvcnRpbmdfYW1vdW50KSBhcyByZXBvcnRpbmdfYW1vdW50JykKICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAkY2FycnlGb3J3YXJkZWQgPSBGaXNjYWxZZWFyQ2xvc2luZ0xlZGdlcjo6am9pbignZmlzY2FsX3llYXJfY2xvc2luZ3MnLCAnZmlzY2FsX3llYXJfY2xvc2luZ3MuaWQnLCAnPScsICdmaXNjYWxfeWVhcl9jbG9zaW5nX2xlZGdlcnMuZmlzY2FsX3llYXJfY2xvc2luZ19pZCcpCgogICAgICAgICAgICAtPmpvaW4oJ2NoYXJ0X29mX2FjY291bnRzJywgJ2NoYXJ0X29mX2FjY291bnRzLmlkJywgJz0nLCAnZmlzY2FsX3llYXJfY2xvc2luZ19sZWRnZXJzLmNoYXJ0X29mX2FjY291bnRfaWQnKQogICAgICAgICAgICAtPmpvaW4oJ2FjY291bnRfZ3JvdXBzJywgJ2FjY291bnRfZ3JvdXBzLmlkJywgJz0nLCAnY2hhcnRfb2ZfYWNjb3VudHMuYWNjb3VudF9ncm91cF9pZCcpCiAgICAgICAgICAgIAogICAgICAgICAgICAtPndoZXJlKCdmaXNjYWxfeWVhcl9jbG9zaW5ncy5jb21wYW55X2lkJywgJGNvbXBhbnlfaWQpCiAgICAgICAgICAgIC0+d2hlcmUoJ2Zpc2NhbF95ZWFyX2Nsb3NpbmdzLnRvX2Zpc2NhbF95ZWFyX2lkJywgJGFjdGl2ZUZpc2NhbFllYXItPmlkKQogICAgICAgICAgICAKICAgICAgICAgICAgLT5ncm91cEJ5KCdmaXNjYWxfeWVhcl9jbG9zaW5nX2xlZGdlcnMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCgogICAgICAgICAgICAtPmdldChbCiAgICAgICAgICAgICAgICAnZmlzY2FsX3llYXJfY2xvc2luZ19sZWRnZXJzLmNoYXJ0X29mX2FjY291bnRfaWQnLAogICAgICAgICAgICAgICAgREI6OnJhdygnc3VtKGZpc2NhbF95ZWFyX2Nsb3NpbmdfbGVkZ2Vycy5jYXJyeV9mb3J3YXJkaW5nX2Ftb3VudCkgYXMgY2FycnlfZm9yd2FyZGluZ19hbW91bnQnKQogICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICRvcGVuaW5nX2JhbGFuY2UgPSAwOwogICAgICAgICAgICBpZihpc3NldCgkc2VhcmNoQWNjb3VudHNbMF0pKXsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRzZWFyY2hBY2NvdW50cyBhcyAka2V5ID0+ICRzZWFyY2hBY2NvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgJG9wZW5pbmdfYmFsYW5jZSArPSBsZWRnZXJDbG9zaW5nQmFsYW5jZSgkc2VhcmNoQWNjb3VudC0+YWNjb3VudEdyb3VwLCAkc2VhcmNoQWNjb3VudCwgWydEJyA9PiAkZGViaXRFbnRyeUl0ZW1zLCAnQycgPT4gJGNyZWRpdEVudHJ5SXRlbXNdLCAkYWxsLCAkY2FycnlGb3J3YXJkZWQsICRyYXRlLCBbXSwgJHN1Yl9sZWRnZXJfaWQpWydiYWxhbmNlJ107CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgICRlbnRyaWVzID0gRW50cnk6OndpdGgoWwogICAgICAgICAgICAgICAgJ2VudHJ5VHlwZScsCiAgICAgICAgICAgICAgICAnaXRlbXMuY2hhcnRPZkFjY291bnQuYWNjb3VudEdyb3VwLmFjY291bnRDbGFzcycsCiAgICAgICAgICAgICAgICAnaXRlbXMuc3ViTGVkZ2VyJywKICAgICAgICAgICAgICAgICdleGNoYW5nZVJhdGUuY3VycmVuY3knCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2l0ZW1zLmNvc3RDZW50cmUucHJvZml0Q2VudHJlJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGNvbXBhbnlfaWQpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2NvbXBhbnlfaWQnLCAkY29tcGFueV9pZCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlcmUoJ2lzX2FwcHJvdmVkJywgJ2FwcHJvdmVkJykKICAgICAgICAgICAgLT53aGVyZUJldHdlZW4oJ2RhdGUnLCBbJGZyb20sICR0b10pCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2l0ZW1zJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHNlYXJjaEFjY291bnRzKXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSW4oJ2NoYXJ0X29mX2FjY291bnRfaWQnLCAkc2VhcmNoQWNjb3VudHMtPnBsdWNrKCdpZCcpLT50b0FycmF5KCkpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZW4oaXNzZXQoJHN1Yl9sZWRnZXJfaWRbMF0pLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkc3ViX2xlZGdlcl9pZCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnaXRlbXMnLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkc3ViX2xlZGdlcl9pZCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVJbignc3ViX2xlZGdlcl9pZCcsICRzdWJfbGVkZ2VyX2lkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZW4oJHByb2ZpdF9jZW50cmVfaWQgPiAwLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcHJvZml0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnaXRlbXMuY29zdENlbnRyZScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRwcm9maXRfY2VudHJlX2lkKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgncHJvZml0X2NlbnRyZV9pZCcsICRwcm9maXRfY2VudHJlX2lkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZW4oJGNvc3RfY2VudHJlX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGNvc3RfY2VudHJlX2lkKXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdpdGVtcycsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRjb3N0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Nvc3RfY2VudHJlX2lkJywgJGNvc3RfY2VudHJlX2lkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPndoZW4oIWVtcHR5KCRuYXJyYXRpb24pLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkbmFycmF0aW9uKXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRuYXJyYXRpb24pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdub3RlcycsICdMSUtFJywgJyUnLiRuYXJyYXRpb24uJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmVIYXMoJ2l0ZW1zJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJG5hcnJhdGlvbil7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCduYXJyYXRpb24nLCAnTElLRScsICclJy4kbmFycmF0aW9uLiclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykgJiYgaW5fYXJyYXkocmVxdWVzdCgpLT5nZXQoJ3JlcG9ydF90eXBlJyksIFsncGRmJywgJ2V4Y2VsJ10pKXsKICAgICAgICAgICAgICAgICRlbnRyaWVzID0gJGVudHJpZXMtPmdldCgpOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICRlbnRyaWVzID0gJGVudHJpZXMtPnBhZ2luYXRlKDEwMCktPndpdGhRdWVyeVN0cmluZygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAkY29tcGFuaWVzID0gQ29tcGFueTo6aGFzKCdwcm9maXRDZW50cmVzLmNvc3RDZW50cmVzJykKICAgICAgICAtPndoZXJlSGFzKCd1c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd1c2VyX2lkJywgYXV0aCgpLT51c2VyKCktPmlkKTsKICAgICAgICB9KQogICAgICAgIC0+Z2V0KCk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAkdGl0bGUsCiAgICAgICAgICAgICAgICAnc2VhcmNoQWNjb3VudHMnID0+ICRzZWFyY2hBY2NvdW50cywKICAgICAgICAgICAgICAgICdzdWJfbGVkZ2VyX2lkJyA9PiAkc3ViX2xlZGdlcl9pZCwKICAgICAgICAgICAgICAgICdzdWJMZWRnZXJzJyA9PiBTdWJMZWRnZXI6OndoZXJlSW4oJ2lkJywgJHN1Yl9sZWRnZXJfaWQpLT5nZXQoKSwKICAgICAgICAgICAgICAgICdmcm9tJyA9PiAkZnJvbSwKICAgICAgICAgICAgICAgICd0bycgPT4gJHRvLAogICAgICAgICAgICAgICAgJ2FjY291bnREZWZhdWx0U2V0dGluZ3MnID0+IGFjY291bnREZWZhdWx0U2V0dGluZ3MoKSwKICAgICAgICAgICAgICAgICdvcGVuaW5nX2JhbGFuY2UnID0+ICRvcGVuaW5nX2JhbGFuY2UsCiAgICAgICAgICAgICAgICAnY3VycmVuY3knID0+IEN1cnJlbmN5OjpmaW5kKCRjdXJyZW5jeV9pZCksCiAgICAgICAgICAgICAgICAnY3VycmVuY3lUeXBlcycgPT4gQ3VycmVuY3lUeXBlOjp3aXRoKFsnY3VycmVuY2llcyddKS0+Z2V0KCksCiAgICAgICAgICAgICAgICAnZW50cmllcycgPT4gJGVudHJpZXMsCiAgICAgICAgICAgICAgICAnY29tcGFuaWVzJyA9PiAkY29tcGFuaWVzLAogICAgICAgICAgICAgICAgJ3Byb2ZpdENlbnRyZXMnID0+IFByb2ZpdENlbnRyZTo6d2hlcmUoJ2NvbXBhbnlfaWQnLCAkY29tcGFuaWVzLT5maXJzdCgpLT5pZCktPm9yZGVyQnkoJ2NvZGUnLCAnYXNjJyktPmdldCgpLAogICAgICAgICAgICAgICAgJ3RoaXNfY29tcGFueScgPT4gJGNvbXBhbmllcy0+d2hlcmUoJ2lkJywgJGNvbXBhbnlfaWQpLT5maXJzdCgpCiAgICAgICAgICAgIF07CgogICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiByZXF1ZXN0KCktPmdldCgncmVwb3J0X3R5cGUnKSA9PSAncGRmJyl7CiAgICAgICAgICAgICAgICByZXR1cm4gdmlld01QREYoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5yZXBvcnRzLmxlZGdlclN0YXRlbWVudHMucGRmJywgJGRhdGEsICR0aXRsZSwgJHRpdGxlLCAnYTMnLCAnTCcpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiByZXF1ZXN0KCktPmdldCgncmVwb3J0X3R5cGUnKSA9PSAnZXhjZWwnKXsKICAgICAgICAgICAgICAgIHJldHVybiBkb3dubG9hZEV4Y2VsKCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy5sZWRnZXJTdGF0ZW1lbnRzLmV4Y2VsJywgJGRhdGEsICR0aXRsZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmIHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdyZXBvcnQnKXsKICAgICAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy5sZWRnZXJTdGF0ZW1lbnRzLnJlcG9ydCcsICRkYXRhKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5yZXBvcnRzLmxlZGdlclN0YXRlbWVudHMuaW5kZXgnLCAkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmIHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdyZXBvcnQnKXsKICAgICAgICAgICAgICAgIHJldHVybiAkdGgtPmdldE1lc3NhZ2UoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9Cn0K