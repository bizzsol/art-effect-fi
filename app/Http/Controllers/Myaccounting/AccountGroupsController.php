<?php
bolt_decrypt( __FILE__ , 'rg8TEV'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29tcGFueTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xBY2NvdW50Q2xhc3M7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQWNjb3VudEdyb3VwOwoKdXNlIERCOwoKY2xhc3MgQWNjb3VudEdyb3Vwc0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgICR0aXRsZSA9ICdOZXcgQWNjb3VudCBHcm91cCc7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICR0aXRsZSwKICAgICAgICAgICAgICAgICdjbGFzc2VzJyA9PiBBY2NvdW50Q2xhc3M6OmFsbCgpLAogICAgICAgICAgICAgICAgJ2FjY291bnRHcm91cE9wdGlvbnMnID0+IGFjY291bnRHcm91cE9wdGlvbnMoW10sIDAsIDAsIGdldEFsbEdyb3VwQW5kTGVkZ2VycygpKSwKICAgICAgICAgICAgICAgIC8vICdjb2RlJyA9PiB1bmlxdWVDb2RlV2l0aG91dFByZWZpeCg0LCdhY2NvdW50X2dyb3VwcycsJ2lkJykKICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5hY2NvdW50R3JvdXBzLmNyZWF0ZScsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgJ3BhcmVudF9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2FjY291bnRfY2xhc3NfaWQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdjb2RlJyA9PiAncmVxdWlyZWR8dW5pcXVlOmFjY291bnRfZ3JvdXBzJywKICAgICAgICAgICAgJ25hbWUnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgIC8vICdncm91cF9jb2RlX3N0YXJ0c19hdCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgLy8gJ2dyb3VwX2NvZGVfZW5kc19hdCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgLy8gJ2NvYV9jb2RlX3N0YXJ0c19hdCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgLy8gJ2NvYV9jb2RlX2VuZHNfYXQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgXSk7CgogICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkZ3JvdXAgPSBBY2NvdW50R3JvdXA6OmNyZWF0ZSgkcmVxdWVzdC0+YWxsKCkpOwogICAgICAgICAgICByZXZpZXdTdGF0dXMoJGdyb3VwKTsKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnJlZGlyZWN0QmFja1dpdGhTdWNjZXNzKCJBY2NvdW50IGdyb3VwIGhhcyBiZWVuIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5IiwgJ2FjY291bnRpbmcuYWNjb3VudC1ncm91cHMuY3JlYXRlJyk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIERCOjpyb2xsYmFjaygpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc2hvdygkaWQpCiAgICB7CiAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ2dyb3VwX2lkJykpewogICAgICAgICAgICAkZ3JvdXAgPSBBY2NvdW50R3JvdXA6OndpdGgoWwogICAgICAgICAgICAgICAgJ2NoaWxkcmVuR3JvdXBzJwogICAgICAgICAgICBdKS0+ZmluZChyZXF1ZXN0KCktPmdldCgnZ3JvdXBfaWQnKSk7CiAgICAgICAgICAgIGlmKCRncm91cC0+cGFyZW50X2lkID09ICRpZCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJGdyb3VwLT5jb2RlOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAkZ3JvdXAgPSBBY2NvdW50R3JvdXA6OmZpbmQoJGlkKTsKICAgICAgICBpZihpc3NldCgkZ3JvdXAtPmlkKSl7CiAgICAgICAgICAgIGlmKCRncm91cC0+Y2hpbGRyZW5Hcm91cHMtPmNvdW50KCkgPiAwKXsKICAgICAgICAgICAgICAgIHJldHVybiBBY2NvdW50R3JvdXA6OndoZXJlKCdwYXJlbnRfaWQnLCAkZ3JvdXAtPmlkKS0+b3JkZXJCeSgnaWQnLCAnZGVzYycpLT5maXJzdCgpLT5jb2RlKzE7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgcmV0dXJuICRncm91cC0+Z3JvdXBfY29kZV9zdGFydHNfYXQgPiAwID8gJGdyb3VwLT5ncm91cF9jb2RlX3N0YXJ0c19hdCA6ICcnOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gQWNjb3VudEdyb3VwOjp3aGVyZSgncGFyZW50X2lkJywgMCktPm1heCgnY29kZScpKzEwOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBlZGl0KCRpZCkKICAgIHsKICAgICAgICAkdGl0bGUgPSAnRWRpdCBBY2NvdW50IEdyb3VwJzsKICAgICAgICB0cnkgewogICAgICAgICAgICAkZ3JvdXAgPSBBY2NvdW50R3JvdXA6OmZpbmQoJGlkKTsKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICR0aXRsZSwKICAgICAgICAgICAgICAgICdjbGFzc2VzJyA9PiBBY2NvdW50Q2xhc3M6OmFsbCgpLAogICAgICAgICAgICAgICAgJ2FjY291bnRHcm91cE9wdGlvbnMnID0+IGFjY291bnRHcm91cE9wdGlvbnMoW10sICRncm91cC0+cGFyZW50X2lkLCAwLCBnZXRBbGxHcm91cEFuZExlZGdlcnMoKSksCiAgICAgICAgICAgICAgICAnZ3JvdXAnID0+ICRncm91cAogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmFjY291bnRHcm91cHMuZWRpdCcsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgJ3BhcmVudF9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2FjY291bnRfY2xhc3NfaWQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdjb2RlJyA9PiAncmVxdWlyZWR8dW5pcXVlOmFjY291bnRfZ3JvdXBzLGNvZGUsJy4kaWQsCiAgICAgICAgICAgICduYW1lJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAvLyAnZ3JvdXBfY29kZV9zdGFydHNfYXQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgIC8vICdncm91cF9jb2RlX2VuZHNfYXQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgIC8vICdjb2FfY29kZV9zdGFydHNfYXQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgIC8vICdjb2FfY29kZV9lbmRzX2F0JyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJGdyb3VwID0gQWNjb3VudEdyb3VwOjpmaW5kKCRpZCk7CiAgICAgICAgICAgICRncm91cC0+ZmlsbCgkcmVxdWVzdC0+YWxsKCkpLT5zYXZlKCk7CgogICAgICAgICAgICByZXZpZXdTdGF0dXMoJGdyb3VwKTsKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnJlZGlyZWN0QmFja1dpdGhTdWNjZXNzKCJBY2NvdW50IGdyb3VwIGhhcyBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IiwgJ2FjY291bnRpbmcuY2hhcnQtb2YtYWNjb3VudHMuaW5kZXgnKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBkZXN0cm95KCRpZCkKICAgIHsKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJGdyb3VwID0gQWNjb3VudEdyb3VwOjpmaW5kKCRpZCk7CiAgICAgICAgICAgIGlmKCghaXNzZXQoJGdyb3VwLT5wYXJlbnQtPmlkKSAmJiAoJGdyb3VwLT5jaGlsZHJlbkdyb3Vwcy0+Y291bnQoKSA+IDAgfHwgJGdyb3VwLT5jaGFydE9mQWNjb3VudHMtPmNvdW50KCkgPiAwKSkgfHwgKGlzc2V0KCRncm91cC0+cGFyZW50LT5pZCkgJiYgKCRncm91cC0+Y2hpbGRyZW5Hcm91cHMtPmNvdW50KCkgPiAwIHx8ICRncm91cC0+Y2hhcnRPZkFjY291bnRzLT5jb3VudCgpID4gMCkpKXsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJBY2NvdW50IEdyb3VwIENhbm5vdCBiZSBEZWxldGVkISIKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRncm91cC0+ZGVsZXRlKCk7CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJBY2NvdW50IEdyb3VwIGhhcyBiZWVuIERlbGV0ZWQhIgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9Cn0K