<?php
bolt_decrypt( __FILE__ , 'dCGsj5'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcCwgREIsIERhdGFUYWJsZXM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwoKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDb21wYW55Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEFjY291bnRHcm91cDsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5VHlwZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xUYWc7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ2hhcnRPZkFjY291bnQ7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRW50cnk7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRW50cnlJdGVtOwoKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDdXJyZW5jeVR5cGU7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ3VycmVuY3k7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRXhjaGFuZ2VSYXRlOwoKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyQ2xvc2luZ0xlZGdlcjsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDbGVhcmluZzsKCmNsYXNzIFJlY2VpdmFibGVDbGVhcmluZ0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5jbGVhcmluZ3MucmVjZWl2YWJsZS5pbmRleCcsIFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJ1JlY2VpdmFibGUgQ2xlYXJpbmdzJywKICAgICAgICAgICAgICAgICdncm91cHMnID0+IEFjY291bnRHcm91cDo6ZG9lc250SGF2ZSgncGFyZW50JyktPndoZXJlKCdhY2NvdW50X2NsYXNzX2lkJywgMSktPmdldCgpLAogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkemVybykKICAgIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkZGF0ZSA9ICRyZXF1ZXN0LT5kYXRlOwogICAgICAgICAgICAkYWNjb3VudERlZmF1bHRTZXR0aW5ncyA9IGFjY291bnREZWZhdWx0U2V0dGluZ3MoKTsKCiAgICAgICAgICAgICRsZWRnZXJzID0gQ2hhcnRPZkFjY291bnQ6OndpdGgoWwogICAgICAgICAgICAgICAgJ2FjY291bnRHcm91cC5hY2NvdW50Q2xhc3MnCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmVJbignaWQnLCBpc3NldCgkcmVxdWVzdC0+bGVkZ2Vyc1swXSkgPyAkcmVxdWVzdC0+bGVkZ2VycyA6IFtdKQogICAgICAgICAgICAtPm9yZGVyQnkoJ2NvZGUnLCAnYXNjJykKICAgICAgICAgICAgLT5nZXQoKTsKCiAgICAgICAgICAgICRlbnRyaWVzID0gRW50cnlJdGVtOjp3aXRoKFsKICAgICAgICAgICAgICAgICdlbnRyeS5lbnRyeVR5cGUnLAogICAgICAgICAgICAgICAgJ2VudHJ5LmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+d2hlcmVEb2VzbnRIYXZlKCdlbnRyeS5wdXJjaGFzZU9yZGVyJykKICAgICAgICAgICAgLT53aGVyZURvZXNudEhhdmUoJ2VudHJ5LnNhbGVPcmRlcicpCiAgICAgICAgICAgIC0+d2hlbigkZGF0ZSwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGRhdGUpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2VudHJ5JywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGRhdGUpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdkYXRlJywgJzw9JywgJGRhdGUpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+d2hlcmVJbignY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRsZWRnZXJzLT5wbHVjaygnaWQnKS0+dG9BcnJheSgpKQogICAgICAgICAgICAtPndoZXJlKCdyZWFsaXplZCcsIDApCiAgICAgICAgICAgIC0+Z2V0KCk7CgogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmNsZWFyaW5ncy5yZWNlaXZhYmxlLmZvcm0nLCBbCiAgICAgICAgICAgICAgICAnZGF0ZScgPT4gJGRhdGUsCiAgICAgICAgICAgICAgICAnbGVkZ2VycycgPT4gJGxlZGdlcnMsCiAgICAgICAgICAgICAgICAnYWNjb3VudERlZmF1bHRTZXR0aW5ncycgPT4gJGFjY291bnREZWZhdWx0U2V0dGluZ3MsCiAgICAgICAgICAgICAgICAnZW50cmllcycgPT4gJGVudHJpZXMsCiAgICAgICAgICAgICAgICAnc3lzdGVtQ3VycmVuY3knID0+IHN5c3RlbUN1cnJlbmN5KCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGgtPmdldE1lc3NhZ2UoKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgJ2RhdGUnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgXSk7CgogICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAKICAgICAgICAgICAgJGFjY291bnREZWZhdWx0U2V0dGluZ3MgPSBhY2NvdW50RGVmYXVsdFNldHRpbmdzKCk7CiAgICAgICAgICAgICR1bnJlYWxpemVkQ3VycmVuY3lFdmVudFNldHRpbmdzID0gdW5yZWFsaXplZEN1cnJlbmN5RXZlbnRTZXR0aW5ncygpOwogICAgICAgICAgICAkc3lzdGVtQ3VycmVuY3kgPSBzeXN0ZW1DdXJyZW5jeSgpOwoKICAgICAgICAgICAgJGVudHJpZXMgPSBFbnRyeUl0ZW06OndpdGgoWwogICAgICAgICAgICAgICAgJ2VudHJ5LmVudHJ5VHlwZScsCiAgICAgICAgICAgICAgICAnZW50cnkuZXhjaGFuZ2VSYXRlLmN1cnJlbmN5JywKICAgICAgICAgICAgXSkKICAgICAgICAgICAgLT53aGVyZURvZXNudEhhdmUoJ2VudHJ5LnB1cmNoYXNlT3JkZXInKQogICAgICAgICAgICAtPndoZXJlRG9lc250SGF2ZSgnZW50cnkuc2FsZU9yZGVyJykKICAgICAgICAgICAgLT53aGVuKCRyZXF1ZXN0LT5kYXRlLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcmVxdWVzdCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZW50cnknLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcmVxdWVzdCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2RhdGUnLCAnPD0nLCAkcmVxdWVzdC0+ZGF0ZSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVyZUluKCdjaGFydF9vZl9hY2NvdW50X2lkJywgYXJyYXlfdW5pcXVlKCRyZXF1ZXN0LT5sZWRnZXJzKSkKICAgICAgICAgICAgLT53aGVyZSgncmVhbGl6ZWQnLCAwKQogICAgICAgICAgICAtPmdldCgpOwoKICAgICAgICAgICAgJGRlYml0cyA9IFtdOwogICAgICAgICAgICAkZGViaXRfZW50cmllcyA9IFtdOwogICAgICAgICAgICAkc2wgPSAwOwogICAgICAgICAgICBpZigkZW50cmllcy0+d2hlcmUoJ2RlYml0X2NyZWRpdCcsICdEJyktPmNvdW50KCkgPiAwKXsKICAgICAgICAgICAgICAgIGZvcmVhY2goJGVudHJpZXMtPndoZXJlKCdkZWJpdF9jcmVkaXQnLCAnRCcpIGFzICRrZXkgPT4gJGVudHJ5KXsKICAgICAgICAgICAgICAgICAgICAkc2wrKzsKICAgICAgICAgICAgICAgICAgICAkcmF0ZSA9IGlzc2V0KGpzb25fZGVjb2RlKCRlbnRyeS0+ZW50cnktPmV4Y2hhbmdlUmF0ZS0+cmF0ZXMsIHRydWUpWyRzeXN0ZW1DdXJyZW5jeS0+aWRdWydyYXRlJ10pID8ganNvbl9kZWNvZGUoJGVudHJ5LT5lbnRyeS0+ZXhjaGFuZ2VSYXRlLT5yYXRlcywgdHJ1ZSlbJHN5c3RlbUN1cnJlbmN5LT5pZF1bJ3JhdGUnXSA6IDE7CiAgICAgICAgICAgICAgICAgICAgJGFtb3VudCA9ICRlbnRyeS0+YW1vdW50KiRyYXRlOwogICAgICAgICAgICAgICAgICAgICRkZWJpdHNbJ0QtJy4kc2xdID0gJGFtb3VudDsKICAgICAgICAgICAgICAgICAgICAkZGViaXRfZW50cmllc1snRC0nLiRzbF0gPSAkZW50cnktPmlkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkY3JlZGl0cyA9IFtdOwogICAgICAgICAgICBpZigkZW50cmllcy0+d2hlcmUoJ2RlYml0X2NyZWRpdCcsICdDJyktPmNvdW50KCkgPiAwKXsKICAgICAgICAgICAgICAgIGZvcmVhY2goJGVudHJpZXMtPndoZXJlKCdkZWJpdF9jcmVkaXQnLCAnQycpIGFzICRrZXkgPT4gJGVudHJ5KXsKICAgICAgICAgICAgICAgICAgICAkcmF0ZSA9IGlzc2V0KGpzb25fZGVjb2RlKCRlbnRyeS0+ZW50cnktPmV4Y2hhbmdlUmF0ZS0+cmF0ZXMsIHRydWUpWyRzeXN0ZW1DdXJyZW5jeS0+aWRdWydyYXRlJ10pID8ganNvbl9kZWNvZGUoJGVudHJ5LT5lbnRyeS0+ZXhjaGFuZ2VSYXRlLT5yYXRlcywgdHJ1ZSlbJHN5c3RlbUN1cnJlbmN5LT5pZF1bJ3JhdGUnXSA6IDE7CiAgICAgICAgICAgICAgICAgICAgJGFtb3VudCA9ICRlbnRyeS0+YW1vdW50KiRyYXRlOwogICAgICAgICAgICAgICAgICAgICRjcmVkaXRzWyRlbnRyeS0+aWRdID0gJGFtb3VudDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGFycmF5ID0gW107CiAgICAgICAgICAgICRyZWFsaXplZF9lbnRyaWVzID0gW107CiAgICAgICAgICAgICR0b3RhbF9nYWluID0gMDsKICAgICAgICAgICAgJHRvdGFsX2xvc3MgPSAwOwogICAgICAgICAgICBpZihpc3NldCgkcmVxdWVzdC0+ZGViaXRzKSAmJiBpc19hcnJheSgkcmVxdWVzdC0+ZGViaXRzKSAmJiBjb3VudCgkcmVxdWVzdC0+ZGViaXRzKSA+IDApewogICAgICAgICAgICAgICAgZm9yZWFjaCgkcmVxdWVzdC0+ZGViaXRzIGFzICRlbnRyeV9pZCA9PiAkZGViaXRfa2V5KXsKICAgICAgICAgICAgICAgICAgICBpZihpc3NldCgkZGViaXRzWyRkZWJpdF9rZXldKSl7CiAgICAgICAgICAgICAgICAgICAgICAgICRjcmVkaXRfcmF0ZSA9IGlzc2V0KGpzb25fZGVjb2RlKCRlbnRyaWVzLT53aGVyZSgnaWQnLCAkZW50cnlfaWQpLT5maXJzdCgpLT5lbnRyeS0+ZXhjaGFuZ2VSYXRlLT5yYXRlcywgdHJ1ZSlbJHN5c3RlbUN1cnJlbmN5LT5pZF1bJ3JhdGUnXSkgPyBqc29uX2RlY29kZSgkZW50cmllcy0+d2hlcmUoJ2lkJywgJGVudHJ5X2lkKS0+Zmlyc3QoKS0+ZW50cnktPmV4Y2hhbmdlUmF0ZS0+cmF0ZXMsIHRydWUpWyRzeXN0ZW1DdXJyZW5jeS0+aWRdWydyYXRlJ10gOiAxOwogICAgICAgICAgICAgICAgICAgICAgICAkZGViaXRfcmF0ZSA9IGlzc2V0KGpzb25fZGVjb2RlKCRlbnRyaWVzLT53aGVyZSgnaWQnLCAkZGViaXRfZW50cmllc1skZGViaXRfa2V5XSktPmZpcnN0KCktPmVudHJ5LT5leGNoYW5nZVJhdGUtPnJhdGVzLCB0cnVlKVskc3lzdGVtQ3VycmVuY3ktPmlkXVsncmF0ZSddKSA/IGpzb25fZGVjb2RlKCRlbnRyaWVzLT53aGVyZSgnaWQnLCAkZGViaXRfZW50cmllc1skZGViaXRfa2V5XSktPmZpcnN0KCktPmVudHJ5LT5leGNoYW5nZVJhdGUtPnJhdGVzLCB0cnVlKVskc3lzdGVtQ3VycmVuY3ktPmlkXVsncmF0ZSddIDogMTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGFycmF5LCBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+IGF1dGgoKS0+dXNlcigpLT5jb3N0Q2VudHJlLT5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiAkZW50cmllcy0+d2hlcmUoJ2lkJywgJGVudHJ5X2lkKS0+Zmlyc3QoKS0+Y2hhcnRfb2ZfYWNjb3VudF9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkZWJpdCcgPT4gJGVudHJpZXMtPndoZXJlKCdpZCcsICRlbnRyeV9pZCktPmZpcnN0KCktPmFtb3VudCokY3JlZGl0X3JhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY3JlZGl0JyA9PiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25hcnJhdGlvbicgPT4gJ1JlY2VpdmFibGUgRGViaXQnLAogICAgICAgICAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGFycmF5LCBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+IGF1dGgoKS0+dXNlcigpLT5jb3N0Q2VudHJlLT5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiAkZW50cmllcy0+d2hlcmUoJ2lkJywgJGRlYml0X2VudHJpZXNbJGRlYml0X2tleV0pLT5maXJzdCgpLT5jaGFydF9vZl9hY2NvdW50X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RlYml0JyA9PiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2NyZWRpdCcgPT4gJGVudHJpZXMtPndoZXJlKCdpZCcsICRkZWJpdF9lbnRyaWVzWyRkZWJpdF9rZXldKS0+Zmlyc3QoKS0+YW1vdW50KiRkZWJpdF9yYXRlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ25hcnJhdGlvbicgPT4gJ1JlY2VpdmFibGUgQ3JlZGl0JywKICAgICAgICAgICAgICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgICAgICAgICAkZ2Fpbl9sb3NzID0gJGNyZWRpdHNbJGVudHJ5X2lkXSAtICRkZWJpdHNbJGRlYml0X2tleV07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRnYWluX2xvc3MgPj0gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdG90YWxfZ2FpbiArPSAkZ2Fpbl9sb3NzOwogICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZWlmKCRnYWluX2xvc3MgPCAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0b3RhbF9sb3NzICs9ICgkZ2Fpbl9sb3NzKigtMSkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRyZWFsaXplZF9lbnRyaWVzLCAkZW50cnlfaWQpOwogICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRyZWFsaXplZF9lbnRyaWVzLCAkZGViaXRfZW50cmllc1skZGViaXRfa2V5XSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZigkdG90YWxfbG9zcyA+IDApewogICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkYXJyYXksIFsKICAgICAgICAgICAgICAgICAgICAnY29zdF9jZW50cmVfaWQnID0+IGF1dGgoKS0+dXNlcigpLT5jb3N0Q2VudHJlLT5pZCwKICAgICAgICAgICAgICAgICAgICAnY2hhcnRfb2ZfYWNjb3VudF9pZCcgPT4gJGFjY291bnREZWZhdWx0U2V0dGluZ3NbJ2N1cnJlbmN5X2dhaW5fbG9zc19hY2NvdW50J10sCiAgICAgICAgICAgICAgICAgICAgJ2RlYml0JyA9PiAkdG90YWxfbG9zcywKICAgICAgICAgICAgICAgICAgICAnY3JlZGl0JyA9PiAwLAogICAgICAgICAgICAgICAgICAgICduYXJyYXRpb24nID0+ICdSZWFsaXplZCBMb3NzIEdhaW4vTG9zcyBEZWJpdCcsCiAgICAgICAgICAgICAgICBdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoJHRvdGFsX2dhaW4gPj0gMCAmJiAkdG90YWxfbG9zcyA8PSAwKXsKICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGFycmF5LCBbCiAgICAgICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2lkJyA9PiBhdXRoKCktPnVzZXIoKS0+Y29zdENlbnRyZS0+aWQsCiAgICAgICAgICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+ICRhY2NvdW50RGVmYXVsdFNldHRpbmdzWydjdXJyZW5jeV9nYWluX2xvc3NfYWNjb3VudCddLAogICAgICAgICAgICAgICAgICAgICdkZWJpdCcgPT4gMCwKICAgICAgICAgICAgICAgICAgICAnY3JlZGl0JyA9PiAkdG90YWxfZ2FpbiwKICAgICAgICAgICAgICAgICAgICAnbmFycmF0aW9uJyA9PiAnUmVhbGl6ZWQgR2FpbiBHYWluL0xvc3MgQ3JlZGl0JywKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkZXhjaGFuZ2VfcmF0ZV9pZCA9IGdldEV4Y2hhbmdlUmF0ZXMoJHN5c3RlbUN1cnJlbmN5LT5pZCwgJHJlcXVlc3QtPmRhdGUsICcyMzo1OTo1OScpWydyYXRlJ10tPmlkOwogICAgICAgICAgICAkZW50cnkgPSBzYXZlTGVkZ2VyRW50cmllcyg1LCBkYXRlKCdZLW0tZCBIOmk6cycsIHN0cnRvdGltZSgkcmVxdWVzdC0+ZGF0ZSkpLCAxLCAnJywgJ1JlYWxpemVkIEN1cnJlbmN5IEV2YWx1YXRpb24nLCAkYXJyYXksICRleGNoYW5nZV9yYXRlX2lkLCAwLCAwLCAwLCBnZXRDb3N0Q2VudHJlQ29tcGFueShhdXRoKCktPnVzZXIoKS0+Y29zdENlbnRyZS0+aWQpKTsKCiAgICAgICAgICAgIGlmKGlzc2V0KCRlbnRyeVsnZW50cnknXS0+aWQpKXsKICAgICAgICAgICAgICAgIEVudHJ5SXRlbTo6d2hlcmUoJ2VudHJ5X2lkJywgJGVudHJ5WydlbnRyeSddLT5pZCkKICAgICAgICAgICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgICAgICAgICAncmVhbGl6ZWQnID0+IDEKICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBFbnRyeUl0ZW06OndoZXJlSW4oJ2lkJywgJHJlYWxpemVkX2VudHJpZXMpCiAgICAgICAgICAgIC0+d2hlcmUoJ3JlYWxpemVkJywgMCkKICAgICAgICAgICAgLT51cGRhdGUoWwogICAgICAgICAgICAgICAgJ3JlYWxpemVkJyA9PiAxCiAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgaWYoaXNzZXQoJGVudHJ5WydlbnRyeSddLT5pZCkpewogICAgICAgICAgICAgICAgQ2xlYXJpbmc6OmNyZWF0ZShbCiAgICAgICAgICAgICAgICAgICAgJ3JlZmVyZW5jZScgPT4gXFN0cjo6c2x1ZygzMiksCiAgICAgICAgICAgICAgICAgICAgJ3R5cGUnID0+ICdyZWNlaXZhYmxlJywKICAgICAgICAgICAgICAgICAgICAnbGVkZ2VycycgPT4ganNvbl9lbmNvZGUoYXJyYXlfdW5pcXVlKCRyZXF1ZXN0LT5sZWRnZXJzKSksCiAgICAgICAgICAgICAgICAgICAgJ2VudHJ5X2lkJyA9PiAkZW50cnlbJ2VudHJ5J10tPmlkLAogICAgICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcycgPT4ganNvbl9lbmNvZGUoJHJlYWxpemVkX2VudHJpZXMpLAogICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgc2Vzc2lvbigpLT5mbGFzaCgnYWxlcnQtdHlwZScsICdzdWNjZXNzJyk7CiAgICAgICAgICAgIHNlc3Npb24oKS0+Zmxhc2goJ21lc3NhZ2UnLCAiQ2xlYXJpbmcgUG9zdGluZ3MgaGFzIGJlZW4gcG9zdGVkIHN1Y2Nlc3NmdWxseS4iKTsKICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0KCktPmJhY2soKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHNlc3Npb24oKS0+Zmxhc2goJ2FsZXJ0LXR5cGUnLCAnZXJyb3InKTsKICAgICAgICAgICAgc2Vzc2lvbigpLT5mbGFzaCgnbWVzc2FnZScsICR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0KCktPmJhY2soKTsKICAgICAgICB9CiAgICB9Cn0K