<?php
bolt_decrypt( __FILE__ , '1Fvv9d'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29tcGFueTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xQcm9maXRDZW50cmU7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29zdENlbnRyZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5VHlwZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xUYWc7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ2hhcnRPZkFjY291bnQ7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcU3ViTGVkZ2VyOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5SXRlbTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xFbnRyeUxvZzsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ3VycmVuY3lUeXBlOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEN1cnJlbmN5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEV4Y2hhbmdlUmF0ZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyQ2xvc2luZzsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyQ2xvc2luZ0xlZGdlcjsKCnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllclBheW1lbnQ7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllckxlZGdlcnM7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllcnM7Cgp1c2UgQXBwLERCOwp1c2UgSWxsdW1pbmF0ZVxTdXBwb3J0XEZhY2FkZXNcQXV0aDsKCmNsYXNzIFN1cHBsaWVyQWdlaW5nQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIGdldFN1cHBsaWVycygkY29tcGFueV9pZCwgJHByb2ZpdF9jZW50cmVfaWQgPSAwLCAkc3VwcGxpZXJfaWQgPSBudWxsLCAkcGFnaW5hdGlvbiA9IGZhbHNlLCAkcGFnZSA9IGZhbHNlLCAkcGVyX3BhZ2UgPSAxMDAwMDAwMCl7CiAgICAgICAgJHN1cHBsaWVycyA9IFN1cHBsaWVyczo6d2hlcmUoJ3N0YXR1cycsICdBY3RpdmUnKQogICAgICAgIC0+d2hlcmUoZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGNvbXBhbnlfaWQpewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUGF5bWVudHMucmVsUHVyY2hhc2VPcmRlci5Vbml0JywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGNvbXBhbnlfaWQpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2NvbXBhbnlfaWQnLCAkY29tcGFueV9pZCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+b3JXaGVyZUhhcygnc3VwcGxpZXJMZWRnZXJzLmVudHJ5Lml0ZW1zLmNvc3RDZW50cmUucHJvZml0Q2VudHJlJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGNvbXBhbnlfaWQpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2NvbXBhbnlfaWQnLCAkY29tcGFueV9pZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICAgICAgLT53aGVuKHJlcXVlc3QoKS0+Z2V0KCdwcm9maXRfY2VudHJlX2lkJykgPiAwLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZShmdW5jdGlvbigkcXVlcnkpIHVzZSgkcHJvZml0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUGF5bWVudHMucmVsUHVyY2hhc2VPcmRlci5jb3N0Q2VudHJlJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHByb2ZpdF9jZW50cmVfaWQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdwcm9maXRfY2VudHJlX2lkJywgJHByb2ZpdF9jZW50cmVfaWQpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+b3JXaGVyZUhhcygnc3VwcGxpZXJMZWRnZXJzLmVudHJ5Lml0ZW1zLmNvc3RDZW50cmUnLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcHJvZml0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3Byb2ZpdF9jZW50cmVfaWQnLCAkcHJvZml0X2NlbnRyZV9pZCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSkKICAgICAgICAtPndoZW4oJHN1cHBsaWVyX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHN1cHBsaWVyX2lkKXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2lkJywgJHN1cHBsaWVyX2lkKTsKICAgICAgICB9KQogICAgICAgIC0+c2VsZWN0KCdpZCcsICduYW1lJywgJ2NvZGUnKTsKCiAgICAgICAgaWYoJHBhZ2luYXRpb24pewogICAgICAgICAgICByZXR1cm4gKCRwYWdlID8gJHN1cHBsaWVycy0+cGFnaW5hdGUoJHBlcl9wYWdlLCBbJyonXSwgJ3BhZ2UnLCAkcGFnZSktPndpdGhRdWVyeVN0cmluZygpIDogJHN1cHBsaWVycy0+cGFnaW5hdGUoJHBlcl9wYWdlKS0+d2l0aFF1ZXJ5U3RyaW5nKCkpOwogICAgICAgIH1lbHNlewogICAgICAgICAgICByZXR1cm4gJHN1cHBsaWVycy0+Z2V0KCk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ2dldC1zdXBwbGllcnMnKSl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+Z2V0U3VwcGxpZXJzKHJlcXVlc3QoKS0+Z2V0KCdjb21wYW55X2lkJyksIHJlcXVlc3QoKS0+Z2V0KCdwcm9maXRfY2VudHJlX2lkJykpOwogICAgICAgIH0KCiAgICAgICAgJHRpdGxlID0gJ1JlcG9ydCAtIFN1cHBsaWVyIEFnZWluZyc7CgogICAgICAgICRjb21wYW55X2lkID0gcmVxdWVzdCgpLT5oYXMoJ2NvbXBhbnlfaWQnKSA/IHJlcXVlc3QoKS0+Z2V0KCdjb21wYW55X2lkJykgOiAwOwogICAgICAgICRwcm9maXRfY2VudHJlX2lkID0gcmVxdWVzdCgpLT5oYXMoJ3Byb2ZpdF9jZW50cmVfaWQnKSA/IHJlcXVlc3QoKS0+Z2V0KCdwcm9maXRfY2VudHJlX2lkJykgOiAwOwogICAgICAgICRzdXBwbGllcl9pZCA9IHJlcXVlc3QoKS0+aGFzKCdzdXBwbGllcl9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ3N1cHBsaWVyX2lkJykgOiAnJzsKICAgICAgICAKICAgICAgICAkY2hhcnRfb2ZfYWNjb3VudF9pZCA9IHJlcXVlc3QoKS0+aGFzKCdjaGFydF9vZl9hY2NvdW50X2lkJykgPyByZXF1ZXN0KCktPmdldCgnY2hhcnRfb2ZfYWNjb3VudF9pZCcpIDogW107CiAgICAgICAgJGNoYXJ0X29mX2FjY291bnRfaWQgPSBpc19hcnJheSgkY2hhcnRfb2ZfYWNjb3VudF9pZCkgJiYgaXNzZXQoJGNoYXJ0X29mX2FjY291bnRfaWRbMF0pID8gJGNoYXJ0X29mX2FjY291bnRfaWQgOiAoIWlzX2FycmF5KCRjaGFydF9vZl9hY2NvdW50X2lkKSAmJiAoaW50KSgkY2hhcnRfb2ZfYWNjb3VudF9pZCkgPiAwID8gWyRjaGFydF9vZl9hY2NvdW50X2lkXSA6IFtdKTsKICAgICAgICAkbmFycmF0aW9uID0gcmVxdWVzdCgpLT5oYXMoJ25hcnJhdGlvbicpID8gcmVxdWVzdCgpLT5nZXQoJ25hcnJhdGlvbicpIDogJyc7CgogICAgICAgICRjdXJyZW5jeV9pZCA9IHJlcXVlc3QoKS0+aGFzKCdjdXJyZW5jeV9pZCcpID8gcmVxdWVzdCgpLT5nZXQoJ2N1cnJlbmN5X2lkJykgOiAwOwogICAgICAgICRkYXRlID0gcmVxdWVzdCgpLT5oYXMoJ2RhdGUnKSA/IHJlcXVlc3QoKS0+Z2V0KCdkYXRlJykgOiBkYXRlKCdZLW0tZCcpOwoKICAgICAgICAkc3VwcGxpZXJzID0gJHRoaXMtPmdldFN1cHBsaWVycygkY29tcGFueV9pZCwgJHByb2ZpdF9jZW50cmVfaWQsICRzdXBwbGllcl9pZCwgdHJ1ZSwgcmVxdWVzdCgpLT5oYXMoJ3BhZ2UnKSA/IHJlcXVlc3QoKS0+Z2V0KCdwYWdlJykgOiBmYWxzZSwgcmVxdWVzdCgpLT5nZXQoJ3Blcl9wYWdlJykpOwoKICAgICAgICAkZW50cnlMZWRnZXJzID0gREI6OnRhYmxlKCdzdXBwbGllcl9sZWRnZXJzJykKCiAgICAgICAgLT5qb2luKCdleGNoYW5nZV9yYXRlcycsICdleGNoYW5nZV9yYXRlcy5pZCcsICc9JywgJ3N1cHBsaWVyX2xlZGdlcnMuZXhjaGFuZ2VfcmF0ZV9pZCcpCiAgICAgICAgCiAgICAgICAgLT5qb2luKCdlbnRyaWVzJywgJ2VudHJpZXMuaWQnLCAnPScsICdzdXBwbGllcl9sZWRnZXJzLmVudHJ5X2lkJykKICAgICAgICAtPmpvaW4oJ2VudHJ5X2l0ZW1zJywgJ2VudHJ5X2l0ZW1zLmVudHJ5X2lkJywgJz0nLCAnZW50cmllcy5pZCcpCiAgICAgICAgLT5qb2luKCdjb3N0X2NlbnRyZXMnLCAnY29zdF9jZW50cmVzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuY29zdF9jZW50cmVfaWQnKQogICAgICAgIC0+am9pbigncHJvZml0X2NlbnRyZXMnLCAncHJvZml0X2NlbnRyZXMuaWQnLCAnPScsICdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcpCgogICAgICAgIC0+d2hlcmVJbignZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRjaGFydF9vZl9hY2NvdW50X2lkKQogICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKQogICAgICAgIC0+d2hlcmUoJ3Byb2ZpdF9jZW50cmVzLmNvbXBhbnlfaWQnLCAkY29tcGFueV9pZCkKICAgICAgICAtPndoZXJlKCdzdXBwbGllcl9sZWRnZXJzLmRhdGUnLCAnPD0nLCAkZGF0ZSkKCiAgICAgICAgLT53aGVuKCFlbXB0eSgkbmFycmF0aW9uKSwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJG5hcnJhdGlvbil7CiAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRuYXJyYXRpb24pewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2VudHJpZXMubm90ZXMnLCAnTElLRScsICclJy4kbmFycmF0aW9uLiclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ2VudHJ5X2l0ZW1zLm5hcnJhdGlvbicsICdMSUtFJywgJyUnLiRuYXJyYXRpb24uJyUnKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSkKCiAgICAgICAgLT53aGVuKCRwcm9maXRfY2VudHJlX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHByb2ZpdF9jZW50cmVfaWQpewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnY29zdF9jZW50cmVzLnByb2ZpdF9jZW50cmVfaWQnLCAkcHJvZml0X2NlbnRyZV9pZCk7CiAgICAgICAgfSkKICAgICAgICAtPndoZW4oJGN1cnJlbmN5X2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGN1cnJlbmN5X2lkKXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2V4Y2hhbmdlX3JhdGVzLmN1cnJlbmN5X2lkJywgJGN1cnJlbmN5X2lkKTsKICAgICAgICB9KQogICAgICAgIC0+d2hlbigkc3VwcGxpZXJfaWQgPiAwLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkc3VwcGxpZXJfaWQpewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnc3VwcGxpZXJfbGVkZ2Vycy5zdXBwbGllcl9pZCcsICRzdXBwbGllcl9pZCk7CiAgICAgICAgfSkKICAgICAgICAtPnNlbGVjdChbCiAgICAgICAgICAgICdzdXBwbGllcl9sZWRnZXJzLmlkJywKICAgICAgICAgICAgJ3N1cHBsaWVyX2xlZGdlcnMuc3VwcGxpZXJfaWQnLAogICAgICAgICAgICAnc3VwcGxpZXJfbGVkZ2Vycy5kYXRlJywKICAgICAgICAgICAgJ3N1cHBsaWVyX2xlZGdlcnMuZGViaXQnLAogICAgICAgICAgICAnc3VwcGxpZXJfbGVkZ2Vycy5jcmVkaXQnLAogICAgICAgICAgICAnY29zdF9jZW50cmVzLnByb2ZpdF9jZW50cmVfaWQnCiAgICAgICAgXSkKICAgICAgICAtPmdldCgpOwoKICAgICAgICAkbm9uRW50cnlMZWRnZXJzID0gREI6OnRhYmxlKCdzdXBwbGllcl9sZWRnZXJzJykKCiAgICAgICAgLT5qb2luKCdleGNoYW5nZV9yYXRlcycsICdleGNoYW5nZV9yYXRlcy5pZCcsICc9JywgJ3N1cHBsaWVyX2xlZGdlcnMuZXhjaGFuZ2VfcmF0ZV9pZCcpCiAgICAgICAgCiAgICAgICAgLT5qb2luKCdzdXBwbGllcl9wYXltZW50cycsICdzdXBwbGllcl9wYXltZW50cy5pZCcsICc9JywgJ3N1cHBsaWVyX2xlZGdlcnMuc3VwcGxpZXJfcGF5bWVudF9pZCcpCiAgICAgICAgLT5qb2luKCdwdXJjaGFzZV9vcmRlcnMnLCAncHVyY2hhc2Vfb3JkZXJzLmlkJywgJz0nLCAnc3VwcGxpZXJfcGF5bWVudHMucHVyY2hhc2Vfb3JkZXJfaWQnKQogICAgICAgIC0+am9pbignY29zdF9jZW50cmVzJywgJ2Nvc3RfY2VudHJlcy5pZCcsICc9JywgJ3B1cmNoYXNlX29yZGVycy5jb3N0X2NlbnRyZV9pZCcpCiAgICAgICAgLT5qb2luKCdwcm9maXRfY2VudHJlcycsICdwcm9maXRfY2VudHJlcy5pZCcsICc9JywgJ2Nvc3RfY2VudHJlcy5wcm9maXRfY2VudHJlX2lkJykKICAgICAgICAKICAgICAgICAtPmpvaW4oJ3B1cmNoYXNlX29yZGVyX2VudHJpZXMnLCAncHVyY2hhc2Vfb3JkZXJfZW50cmllcy5wdXJjaGFzZV9vcmRlcl9pZCcsICc9JywgJ3B1cmNoYXNlX29yZGVycy5pZCcpCiAgICAgICAgLT5qb2luKCdlbnRyaWVzJywgJ2VudHJpZXMuaWQnLCAnPScsICdwdXJjaGFzZV9vcmRlcl9lbnRyaWVzLmVudHJ5X2lkJykKICAgICAgICAtPmpvaW4oJ2VudHJ5X2l0ZW1zJywgJ2VudHJ5X2l0ZW1zLmVudHJ5X2lkJywgJz0nLCAnZW50cmllcy5pZCcpCgogICAgICAgIC0+d2hlcmVJbignZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcsICRjaGFydF9vZl9hY2NvdW50X2lkKQogICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKQogICAgICAgIC0+d2hlcmUoJ3Byb2ZpdF9jZW50cmVzLmNvbXBhbnlfaWQnLCAkY29tcGFueV9pZCkKICAgICAgICAtPndoZXJlKCdzdXBwbGllcl9sZWRnZXJzLmRhdGUnLCAnPD0nLCAkZGF0ZSkKICAgICAgICAtPndoZXJlTnVsbCgnc3VwcGxpZXJfbGVkZ2Vycy5lbnRyeV9pZCcpCgogICAgICAgIC0+d2hlbighZW1wdHkoJG5hcnJhdGlvbiksIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRuYXJyYXRpb24pewogICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZShmdW5jdGlvbigkcXVlcnkpIHVzZSgkbmFycmF0aW9uKXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdlbnRyaWVzLm5vdGVzJywgJ0xJS0UnLCAnJScuJG5hcnJhdGlvbi4nJScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdlbnRyeV9pdGVtcy5uYXJyYXRpb24nLCAnTElLRScsICclJy4kbmFycmF0aW9uLiclJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pCgogICAgICAgIC0+d2hlbigkcHJvZml0X2NlbnRyZV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRwcm9maXRfY2VudHJlX2lkKXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Nvc3RfY2VudHJlcy5wcm9maXRfY2VudHJlX2lkJywgJHByb2ZpdF9jZW50cmVfaWQpOwogICAgICAgIH0pCiAgICAgICAgLT53aGVuKCRjdXJyZW5jeV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRjdXJyZW5jeV9pZCl7CiAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdleGNoYW5nZV9yYXRlcy5jdXJyZW5jeV9pZCcsICRjdXJyZW5jeV9pZCk7CiAgICAgICAgfSkKICAgICAgICAtPndoZW4oJHN1cHBsaWVyX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHN1cHBsaWVyX2lkKXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3N1cHBsaWVyX2xlZGdlcnMuc3VwcGxpZXJfaWQnLCAkc3VwcGxpZXJfaWQpOwogICAgICAgIH0pCiAgICAgICAgLT5zZWxlY3QoWwogICAgICAgICAgICAnc3VwcGxpZXJfbGVkZ2Vycy5pZCcsCiAgICAgICAgICAgICdzdXBwbGllcl9sZWRnZXJzLnN1cHBsaWVyX2lkJywKICAgICAgICAgICAgJ3N1cHBsaWVyX2xlZGdlcnMuZGF0ZScsCiAgICAgICAgICAgICdzdXBwbGllcl9sZWRnZXJzLmRlYml0JywKICAgICAgICAgICAgJ3N1cHBsaWVyX2xlZGdlcnMuY3JlZGl0JywKICAgICAgICAgICAgJ2Nvc3RfY2VudHJlcy5wcm9maXRfY2VudHJlX2lkJwogICAgICAgIF0pCiAgICAgICAgLT5nZXQoKTsKCiAgICAgICAgJGNvbXBhbmllcyA9IENvbXBhbnk6OndpdGgoWwogICAgICAgICAgICAncHJvZml0Q2VudHJlcycgPT4gZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGVudHJ5TGVkZ2VycywgJG5vbkVudHJ5TGVkZ2Vycyl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUluKCdpZCcsIGFycmF5X21lcmdlKCRlbnRyeUxlZGdlcnMtPnBsdWNrKCdwcm9maXRfY2VudHJlX2lkJyktPnRvQXJyYXkoKSwgJG5vbkVudHJ5TGVkZ2Vycy0+cGx1Y2soJ3Byb2ZpdF9jZW50cmVfaWQnKS0+dG9BcnJheSgpKSk7CiAgICAgICAgICAgIH0KICAgICAgICBdKQogICAgICAgIC0+d2hlcmVIYXMoJ3VzZXJzJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3VzZXJfaWQnLCBhdXRoKCktPnVzZXIoKS0+aWQpOwogICAgICAgIH0pCiAgICAgICAgLT5nZXQoKTsKCiAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykpewogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJHRpdGxlLAogICAgICAgICAgICAgICAgJ2RhdGUnID0+ICRkYXRlLAogICAgICAgICAgICAgICAgJ3N1cHBsaWVycycgPT4gJHN1cHBsaWVycywKICAgICAgICAgICAgICAgICdlbnRyeUxlZGdlcnMnID0+ICRlbnRyeUxlZGdlcnMsCiAgICAgICAgICAgICAgICAnbm9uRW50cnlMZWRnZXJzJyA9PiAkbm9uRW50cnlMZWRnZXJzLAogICAgICAgICAgICAgICAgJ3RoaXNfY29tcGFueScgPT4gJGNvbXBhbmllcy0+d2hlcmUoJ2lkJywgJGNvbXBhbnlfaWQpLT5maXJzdCgpLAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5nZXQoJ3JlcG9ydF90eXBlJykgPT0gJ3BkZicpewogICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdNUERGKCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy5zdXBwbGllckFnZWluZy5wZGYnLCAkZGF0YSwgJHRpdGxlLCAkdGl0bGUsICdhNCcsICdMJyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdleGNlbCcpewogICAgICAgICAgICAgICAgcmV0dXJuIGRvd25sb2FkRXhjZWwoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5yZXBvcnRzLnN1cHBsaWVyQWdlaW5nLmV4Y2VsJywgJGRhdGEsICR0aXRsZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdyZXBvcnQnKXsKICAgICAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy5zdXBwbGllckFnZWluZy5yZXBvcnQnLCAkZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIHRyeSB7CiAgICAgICAgICAgICRhbGwgPSBnZXRBbGxHcm91cEFuZExlZGdlcnMoZmFsc2UsIHRydWUpOwogICAgICAgICAgICAkZ2V0QWN0aXZlRmlzY2FsWWVhciA9IGdldEFjdGl2ZUZpc2NhbFllYXIoJGNvbXBhbnlfaWQpOwogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJHRpdGxlLAogICAgICAgICAgICAgICAgJ2RhdGUnID0+ICRkYXRlLAogICAgICAgICAgICAgICAgJ2FjY291bnREZWZhdWx0U2V0dGluZ3MnID0+IGFjY291bnREZWZhdWx0U2V0dGluZ3MoKSwKICAgICAgICAgICAgICAgICdjdXJyZW5jeScgPT4gQ3VycmVuY3k6OmZpbmQoJGN1cnJlbmN5X2lkKSwKICAgICAgICAgICAgICAgICdjdXJyZW5jeVR5cGVzJyA9PiBDdXJyZW5jeVR5cGU6OndpdGgoWydjdXJyZW5jaWVzJ10pLT5nZXQoKSwKICAgICAgICAgICAgICAgICdjb21wYW5pZXMnID0+ICRjb21wYW5pZXMsCiAgICAgICAgICAgICAgICAncHJvZml0Q2VudHJlcycgPT4gUHJvZml0Q2VudHJlOjp3aGVyZSgnY29tcGFueV9pZCcsICRjb21wYW5pZXMtPmZpcnN0KCktPmlkKS0+b3JkZXJCeSgnY29kZScsICdhc2MnKS0+Z2V0KCksCiAgICAgICAgICAgICAgICAnc3VwcGxpZXJzJyA9PiAkc3VwcGxpZXJzLAogICAgICAgICAgICAgICAgJ2NoYXJ0T2ZBY2NvdW50c09wdGlvbnMnID0+IGNoYXJ0T2ZBY2NvdW50c09wdGlvbnMoW10sIDAsIDAsICRhbGwsIGZhbHNlLCAneWVzJywgZmFsc2UsIFskY29tcGFueV9pZF0sIHRydWUsIGdldExlZGdlckJhbGFuY2VzKCRhbGwsICRjb21wYW55X2lkLCAkZ2V0QWN0aXZlRmlzY2FsWWVhci0+aWQpKSwKICAgICAgICAgICAgXTsKCiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy5zdXBwbGllckFnZWluZy5pbmRleCcsICRkYXRhKTsKICAgICAgICAvLyB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAvLyAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykgJiYgcmVxdWVzdCgpLT5nZXQoJ3JlcG9ydF90eXBlJykgPT0gJ3JlcG9ydCcpewogICAgICAgIC8vICAgICAgICAgcmV0dXJuICR0aC0+Z2V0TWVzc2FnZSgpOwogICAgICAgIC8vICAgICB9CiAgICAgICAgICAgIAogICAgICAgIC8vICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIC8vIH0KICAgIH0KfQo=