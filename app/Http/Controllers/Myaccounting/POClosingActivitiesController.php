<?php
bolt_decrypt( __FILE__ , 'kZYf3I'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHVyY2hhc2VcUHVyY2hhc2VPcmRlcjsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xRdW90YXRpb25zOwoKdXNlIEFwcCwgREIsIERhdGFUYWJsZXM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwoKY2xhc3MgUE9DbG9zaW5nQWN0aXZpdGllc0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgIHsKICAgICAgICByZXR1cm4gYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwKICAgICAgICAgICAgWydhcHByb3ZlZF9kYXRlJywgJ2FwcHJvdmVkX2RhdGUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydyZWZlcmVuY2Vfbm8nLCAncmVmZXJlbmNlX25vJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnc3VwcGxpZXInLCAnc3VwcGxpZXInXSwKICAgICAgICAgICAgWydxdW90YXRpb25fcmVmX25vJywgJ3F1b3RhdGlvbl9yZWZfbm8nLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydjdXJyZW5jeScsICdjdXJyZW5jeScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3RvdGFsX3ByaWNlJywgJ3RvdGFsX3ByaWNlJywgJ3RleHQtcmlnaHQnXSwKICAgICAgICAgICAgWyd2YXQnLCAndmF0JywgJ3RleHQtcmlnaHQnXSwKICAgICAgICAgICAgWydncm9zc19wcmljZScsICdncm9zc19wcmljZScsICd0ZXh0LXJpZ2h0J10sCiAgICAgICAgICAgIFsnYWR2YW5jZV9hbW91bnQnLCAnYWR2YW5jZV9hbW91bnQnLCAndGV4dC1yaWdodCddLAogICAgICAgICAgICBbJ2JpbGxfYW1vdW50JywgJ2JpbGxfYW1vdW50JywgJ3RleHQtcmlnaHQnXSwKICAgICAgICAgICAgWydwYWlkX2Ftb3VudCcsICdwYWlkX2Ftb3VudCcsICd0ZXh0LXJpZ2h0J10sCiAgICAgICAgICAgIFsnb3B0aW9ucycsICdvcHRpb25zJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgJHB1cmNoYXNlT3JkZXJzID0gIFB1cmNoYXNlT3JkZXI6OndpdGgoWwogICAgICAgICAgICAgICAgICAgICdyZWxRdW90YXRpb24ucmVsU3VwcGxpZXJzJywKICAgICAgICAgICAgICAgICAgICAncmVsUXVvdGF0aW9uLmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgLT53aGVyZSgnaXNfY2xvc2VkJywgcmVxdWVzdCgpLT5oYXMoJ2Nsb3NlZCcpKQogICAgICAgICAgICAgICAgLT53aGVuKCFkYXRhdGFibGVPcmRlcmluZygpLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ3JlZmVyZW5jZV9ubycsICdkZXNjJyk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVRhYmxlczo6b2YoJHB1cmNoYXNlT3JkZXJzKQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FwcHJvdmVkX2RhdGUnLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRlKCdZLW0tZCcsc3RydG90aW1lKCRwby0+cG9fZGF0ZSkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdhcHByb3ZlZF9kYXRlJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdwb19kYXRlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdhcHByb3ZlZF9kYXRlJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJCeSgncG9fZGF0ZScsICRvcmRlcik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCdyZWZlcmVuY2Vfbm8nLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAgJzxhIHRhcmdldD0iX19ibGFuayIgaHJlZj0iJy5yb3V0ZSgncG1zLmJpbGxpbmctYXVkaXQucG8uaW52b2ljZS5wcmludCcsICRwby0+aWQpLiciICB0aXRsZT0iUHVyY2hhc2UgT3JkZXIgUHJpbnQgVmlldyI+Jy4kcG8tPnJlZmVyZW5jZV9uby4nPC9hPic7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3N1cHBsaWVyJywgZnVuY3Rpb24oJHBvKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIGlzc2V0KCRwby0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMpID8gKGlzc2V0KCRwby0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPm5hbWUpID8gJHBvLT5yZWxRdW90YXRpb24tPnJlbFN1cHBsaWVycy0+bmFtZS4nICgnLiRwby0+cmVsUXVvdGF0aW9uLT5yZWxTdXBwbGllcnMtPmNvZGUuJyknIDogJycpIDogJyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3N1cHBsaWVyJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uLnJlbFN1cHBsaWVycycsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ2NvZGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ3N1cHBsaWVyJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgUXVvdGF0aW9uczo6c2VsZWN0KCdzdXBwbGllcnMubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+am9pbignc3VwcGxpZXJzJywgJ3N1cHBsaWVycy5pZCcsICc9JywgJ3F1b3RhdGlvbnMuc3VwcGxpZXJfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdxdW90YXRpb25zLmlkJywgJ3B1cmNoYXNlX29yZGVycy5xdW90YXRpb25faWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdxdW90YXRpb25fcmVmX25vJywgZnVuY3Rpb24oJHBvKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJHBvLT5yZWxRdW90YXRpb24tPnJlZmVyZW5jZV9ubyk/JHBvLT5yZWxRdW90YXRpb24tPnJlZmVyZW5jZV9ubzonJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncXVvdGF0aW9uX3JlZl9ubycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3JlbFF1b3RhdGlvbicsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdyZWZlcmVuY2Vfbm8nLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ3F1b3RhdGlvbl9yZWZfbm8nLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBRdW90YXRpb25zOjpzZWxlY3QoJ3F1b3RhdGlvbnMucmVmZXJlbmNlX25vJykKICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbigncXVvdGF0aW9ucy5pZCcsICdwdXJjaGFzZV9vcmRlcnMucXVvdGF0aW9uX2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkcG8tPnJlbFF1b3RhdGlvbi0+ZXhjaGFuZ2VSYXRlLT5jdXJyZW5jeS0+Y29kZSk/JHBvLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPmNvZGU6Jyc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2N1cnJlbmN5JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygncmVsUXVvdGF0aW9uLmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdjdXJyZW5jeScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIFF1b3RhdGlvbnM6OnNlbGVjdCgnY3VycmVuY2llcy5jb2RlJykKICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdleGNoYW5nZV9yYXRlcycsICdleGNoYW5nZV9yYXRlcy5pZCcsICc9JywgJ3F1b3RhdGlvbnMuZXhjaGFuZ2VfcmF0ZV9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+am9pbignY3VycmVuY2llcycsICdjdXJyZW5jaWVzLmlkJywgJz0nLCAnZXhjaGFuZ2VfcmF0ZXMuY3VycmVuY3lfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdxdW90YXRpb25zLmlkJywgJ3B1cmNoYXNlX29yZGVycy5xdW90YXRpb25faWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCd0b3RhbF9wcmljZScsIGZ1bmN0aW9uKCRwbyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoaXNzZXQoJHBvLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPnN5bWJvbCk/JHBvLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPnN5bWJvbDonJykuJyAnLnN5c3RlbU1vbmV5Rm9ybWF0KCRwby0+dG90YWxfcHJpY2UpKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigndG90YWxfcHJpY2UnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd0b3RhbF9wcmljZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbigndG90YWxfcHJpY2UnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlckJ5KCd0b3RhbF9wcmljZScsICRvcmRlcik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3ZhdCcsIGZ1bmN0aW9uKCRwbyl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgoaXNzZXQoJHBvLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPnN5bWJvbCk/JHBvLT5yZWxRdW90YXRpb24tPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPnN5bWJvbDonJykuJyAnLnN5c3RlbU1vbmV5Rm9ybWF0KCRwby0+dmF0KSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3ZhdCcsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3ZhdCcsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbigndmF0JywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJCeSgndmF0JywgJG9yZGVyKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignZ3Jvc3NfcHJpY2UnLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoKGlzc2V0KCRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2wpPyRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2w6JycpIC4nICcuc3lzdGVtTW9uZXlGb3JtYXQoJHBvLT5ncm9zc19wcmljZSkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdncm9zc19wcmljZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2dyb3NzX3ByaWNlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdncm9zc19wcmljZScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyQnkoJ2dyb3NzX3ByaWNlJywgJG9yZGVyKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYWR2YW5jZV9hbW91bnQnLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoKGlzc2V0KCRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2wpPyRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2w6JycpIC4nICcuIHN5c3RlbU1vbmV5Rm9ybWF0KHBvQWR2YW5jZSgkcG8tPmlkKVsnYWR2YW5jZSddKSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYmlsbF9hbW91bnQnLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoKGlzc2V0KCRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2wpPyRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2w6JycpIC4nICcuc3lzdGVtTW9uZXlGb3JtYXQoXEFwcFxNb2RlbHNcUG1zTW9kZWxzXFN1cHBsaWVyTGVkZ2Vyczo6d2hlcmVIYXMoJ3JlbFN1cHBsaWVyUGF5bWVudCcsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRwbyl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdwdXJjaGFzZV9vcmRlcl9pZCcsICRwby0+aWQpOwogICAgICAgICAgICAgICAgICAgIH0pLT5zdW0oJ2RlYml0JykpKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbigncGFpZF9hbW91bnQnLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoKGlzc2V0KCRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2wpPyRwby0+cmVsUXVvdGF0aW9uLT5leGNoYW5nZVJhdGUtPmN1cnJlbmN5LT5zeW1ib2w6JycpIC4nICcuIHN5c3RlbU1vbmV5Rm9ybWF0KFxBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllclBheW1lbnQ6OndoZXJlKCdwdXJjaGFzZV9vcmRlcl9pZCcsICRwby0+aWQpLT53aGVyZUluKCdiaWxsX3R5cGUnLCBbJ3BvJywgJ2dybiddKS0+c3VtKCdiaWxsX2Ftb3VudCcpKSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ29wdGlvbnMnLCBmdW5jdGlvbigkcG8pewogICAgICAgICAgICAgICAgICAgIGlmKCRwby0+aXNfY2xvc2VkID09IDEpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIHRpdGxlPSJSZS1vcGVuIFB1cmNoYXNlIE9yZGVyIiBjbGFzcz0iYnRuIGJ0bi14cyBidG4tc3VjY2VzcyIgb25jbGljaz0iT3Blbk1vZGFsKCQodGhpcykpIiBkYXRhLXB1cmNoYXNlLW9yZGVyLWlkPSInLiRwby0+aWQuJyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz0ibGFzIGxhLWZvbGRlci1vcGVuIj48L2k+Jm5ic3A7UmUtb3BlbgogICAgICAgICAgICAgICAgICAgICAgICA8L2E+JzsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YSB0aXRsZT0iQ2xvc2UgUHVyY2hhc2UgT3JkZXIiIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1kYW5nZXIiIG9uY2xpY2s9Ik9wZW5Nb2RhbCgkKHRoaXMpKSIgZGF0YS1wdXJjaGFzZS1vcmRlci1pZD0iJy4kcG8tPmlkLiciPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9ImxhcyBsYS1mb2xkZXItbWludXMiPjwvaT4mbmJzcDtDbG9zZQogICAgICAgICAgICAgICAgICAgICAgICA8L2E+JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRJbmRleENvbHVtbigpCiAgICAgICAgICAgICAgICAtPnJhd0NvbHVtbnMoWydyZWZlcmVuY2Vfbm8nLCAnb3B0aW9ucyddKQogICAgICAgICAgICAgICAgLT5tYWtlKHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnBvQ2xvc2luZ0FjdGl2aXRpZXMuaW5kZXgnLCBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICgocmVxdWVzdCgpLT5oYXMoJ2Nsb3NlZCcpID8gIkNsb3NlZCIgOiAiT3BlbiIpLiIgUHVyY2hhc2UgT3JkZXJzIiksIAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgICRwdXJjaGFzZU9yZGVyID0gUHVyY2hhc2VPcmRlcjo6ZmluZE9yRmFpbChyZXF1ZXN0KCktPmdldCgncHVyY2hhc2Vfb3JkZXJfaWQnKSk7CiAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAndGl0bGUnID0+ICgkcHVyY2hhc2VPcmRlci0+aXNfY2xvc2VkID09IDEgPyAnUmUtb3BlbicgOiAnQ2xvc2UnKS4nIFB1cmNoYXNlIG9yZGVyICMnLiRwdXJjaGFzZU9yZGVyLT5yZWZlcmVuY2Vfbm8sCiAgICAgICAgICAgICdib2R5JyA9PiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucG9DbG9zaW5nQWN0aXZpdGllcy5jbG9zZScsIGNvbXBhY3QoJ3B1cmNoYXNlT3JkZXInKSktPnJlbmRlcigpCiAgICAgICAgXSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgJ3B1cmNoYXNlX29yZGVyX2lkJyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICB0cnl7CiAgICAgICAgICAgICRvcmRlciA9IFB1cmNoYXNlT3JkZXI6OmZpbmRPckZhaWwoJHJlcXVlc3QtPnB1cmNoYXNlX29yZGVyX2lkKTsKICAgICAgICAgICAgJG9yZGVyLT5pc19jbG9zZWQgPSAoJG9yZGVyLT5pc19jbG9zZWQgPT0gMSA/IDAgOiAxKTsKICAgICAgICAgICAgJG9yZGVyLT5jbG9zaW5nX3JlbWFya3MgPSAkcmVxdWVzdC0+Y2xvc2luZ19yZW1hcmtzOwogICAgICAgICAgICAkb3JkZXItPnNhdmUoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoIlB1cmNoYXNlIG9yZGVyIGhhcyBiZWVuICIuKCRvcmRlci0+aXNfY2xvc2VkID09IDEgPyAnY2xvc2VkJyA6ICdyZS1vcGVuZWQnKS4iIHN1Y2Nlc3NmdWxseS4iKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9Cn0K