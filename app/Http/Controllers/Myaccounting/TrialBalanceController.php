<?php
bolt_decrypt( __FILE__ , 'Hzo8PG'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29tcGFueTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xQcm9maXRDZW50cmU7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29zdENlbnRyZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xGaXNjYWxZZWFyOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5VHlwZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xUYWc7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQWNjb3VudEdyb3VwOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXENoYXJ0T2ZBY2NvdW50Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5SXRlbTsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRmlzY2FsWWVhckNsb3Npbmc7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRmlzY2FsWWVhckNsb3NpbmdMZWRnZXI7Cgp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEN1cnJlbmN5VHlwZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDdXJyZW5jeTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xFeGNoYW5nZVJhdGU7Cgp1c2UgQXBwLCBEQjsKdXNlIElsbHVtaW5hdGVcU3VwcG9ydFxGYWNhZGVzXEF1dGg7CgpjbGFzcyBUcmlhbEJhbGFuY2VDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7CiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkdGl0bGUgPSAnUmVwb3J0IC0gVHJpYWwgQmFsYW5jZSc7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRmaXNjYWxZZWFyID0gZ2V0QWN0aXZlRmlzY2FsWWVhcigpOwogICAgICAgICAgICAkYWNjb3VudERlZmF1bHRTZXR0aW5ncyA9IGFjY291bnREZWZhdWx0U2V0dGluZ3MoKTsKICAgICAgICAgICAgJHN5c3RlbUN1cnJlbmN5ID0gc3lzdGVtQ3VycmVuY3koKTsKICAgICAgICAgICAgCiAgICAgICAgICAgICR0cmlhbEJhbGFuY2UgPSAnJzsKICAgICAgICAgICAgJGdyb3VwV2lzZSA9IGZhbHNlOwogICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSl7CiAgICAgICAgICAgICAgICAkY3VycmVuY3lfaWQgPSByZXF1ZXN0KCktPmhhcygnY3VycmVuY3lfaWQnKSA/IHJlcXVlc3QoKS0+Z2V0KCdjdXJyZW5jeV9pZCcpIDogMDsKICAgICAgICAgICAgICAgICRwcm9maXRfY2VudHJlX2lkID0gcmVxdWVzdCgpLT5oYXMoJ3Byb2ZpdF9jZW50cmVfaWQnKSA/IHJlcXVlc3QoKS0+Z2V0KCdwcm9maXRfY2VudHJlX2lkJykgOiAwOwogICAgICAgICAgICAgICAgJGNvc3RfY2VudHJlX2lkID0gcmVxdWVzdCgpLT5oYXMoJ2Nvc3RfY2VudHJlX2lkJykgPyByZXF1ZXN0KCktPmdldCgnY29zdF9jZW50cmVfaWQnKSA6IDA7CiAgICAgICAgICAgICAgICAkZmlzY2FsWWVhciA9IEZpc2NhbFllYXI6OmZpbmRPckZhaWwocmVxdWVzdCgpLT5nZXQoJ2Zpc2NhbF95ZWFyX2lkJykpOwogICAgICAgICAgICAgICAgJGFsbCA9IGdldEFsbEdyb3VwQW5kTGVkZ2VycygpOwogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAkcmF0ZSA9IDE7CiAgICAgICAgICAgICAgICBpZigkc3lzdGVtQ3VycmVuY3ktPmlkICE9ICRjdXJyZW5jeV9pZCl7CiAgICAgICAgICAgICAgICAgICAgJHJhdGVzID0gZ2V0RXhjaGFuZ2VSYXRlcygkc3lzdGVtQ3VycmVuY3ktPmlkKTsKICAgICAgICAgICAgICAgICAgICAkcmF0ZSA9IGlzc2V0KCRyYXRlc1sncmF0ZXMnXVskY3VycmVuY3lfaWRdWydyYXRlJ10pID8gJHJhdGVzWydyYXRlcyddWyRjdXJyZW5jeV9pZF1bJ3JhdGUnXSA6IDE7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJG9wZW5pbmdEZWJpdEVudHJ5SXRlbXMgPSBFbnRyeUl0ZW06OmpvaW4oJ2VudHJpZXMnLCAnZW50cmllcy5pZCcsICc9JywgJ2VudHJ5X2l0ZW1zLmVudHJ5X2lkJykKICAgICAgICAgICAgICAgIC0+am9pbignY29zdF9jZW50cmVzJywgJ2Nvc3RfY2VudHJlcy5pZCcsICc9JywgJ2VudHJ5X2l0ZW1zLmNvc3RfY2VudHJlX2lkJykKICAgICAgICAgICAgICAgIC0+am9pbigncHJvZml0X2NlbnRyZXMnLCAncHJvZml0X2NlbnRyZXMuaWQnLCAnPScsICdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcpCgogICAgICAgICAgICAgICAgLT5qb2luKCdjaGFydF9vZl9hY2NvdW50cycsICdjaGFydF9vZl9hY2NvdW50cy5pZCcsICc9JywgJ2VudHJ5X2l0ZW1zLmNoYXJ0X29mX2FjY291bnRfaWQnKQogICAgICAgICAgICAgICAgLT5qb2luKCdhY2NvdW50X2dyb3VwcycsICdhY2NvdW50X2dyb3Vwcy5pZCcsICc9JywgJ2NoYXJ0X29mX2FjY291bnRzLmFjY291bnRfZ3JvdXBfaWQnKQoKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKQogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cmllcy5kYXRlJywgJzwnLCAkcmVxdWVzdC0+ZnJvbSkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZmlzY2FsX3llYXJfaWQnLCAkZmlzY2FsWWVhci0+aWQpCiAgICAgICAgICAgICAgICAtPndoZXJlKCdwcm9maXRfY2VudHJlcy5jb21wYW55X2lkJywgcmVxdWVzdCgpLT5nZXQoJ2NvbXBhbnlfaWQnKSkKCiAgICAgICAgICAgICAgICAtPndoZW4oJHByb2ZpdF9jZW50cmVfaWQgPiAwLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcHJvZml0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Nvc3RfY2VudHJlcy5wcm9maXRfY2VudHJlX2lkJywgJHByb2ZpdF9jZW50cmVfaWQpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+d2hlbigkY29zdF9jZW50cmVfaWQgPiAwLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkY29zdF9jZW50cmVfaWQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdlbnRyeV9pdGVtcy5jb3N0X2NlbnRyZV9pZCcsICRjb3N0X2NlbnRyZV9pZCk7CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJ5X2l0ZW1zLmRlYml0X2NyZWRpdCcsICdEJykKCiAgICAgICAgICAgICAgICAtPmdyb3VwQnkoJ2VudHJ5X2l0ZW1zLmNoYXJ0X29mX2FjY291bnRfaWQnKQoKICAgICAgICAgICAgICAgIC0+Z2V0KFsKICAgICAgICAgICAgICAgICAgICAnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcsCiAgICAgICAgICAgICAgICAgICAgREI6OnJhdygnc3VtKGVudHJ5X2l0ZW1zLnJlcG9ydGluZ19hbW91bnQpIGFzIHJlcG9ydGluZ19hbW91bnQnKQogICAgICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgJG9wZW5pbmdDcmVkaXRFbnRyeUl0ZW1zID0gRW50cnlJdGVtOjpqb2luKCdlbnRyaWVzJywgJ2VudHJpZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5lbnRyeV9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2Nvc3RfY2VudHJlcycsICdjb3N0X2NlbnRyZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jb3N0X2NlbnRyZV9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ3Byb2ZpdF9jZW50cmVzJywgJ3Byb2ZpdF9jZW50cmVzLmlkJywgJz0nLCAnY29zdF9jZW50cmVzLnByb2ZpdF9jZW50cmVfaWQnKQoKICAgICAgICAgICAgICAgIC0+am9pbignY2hhcnRfb2ZfYWNjb3VudHMnLCAnY2hhcnRfb2ZfYWNjb3VudHMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJykKICAgICAgICAgICAgICAgIC0+am9pbignYWNjb3VudF9ncm91cHMnLCAnYWNjb3VudF9ncm91cHMuaWQnLCAnPScsICdjaGFydF9vZl9hY2NvdW50cy5hY2NvdW50X2dyb3VwX2lkJykKCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmlzX2FwcHJvdmVkJywgJ2FwcHJvdmVkJykKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZGF0ZScsICc8JywgJHJlcXVlc3QtPmZyb20pCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmZpc2NhbF95ZWFyX2lkJywgJGZpc2NhbFllYXItPmlkKQogICAgICAgICAgICAgICAgLT53aGVyZSgncHJvZml0X2NlbnRyZXMuY29tcGFueV9pZCcsIHJlcXVlc3QoKS0+Z2V0KCdjb21wYW55X2lkJykpCgogICAgICAgICAgICAgICAgLT53aGVuKCRwcm9maXRfY2VudHJlX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHByb2ZpdF9jZW50cmVfaWQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcsICRwcm9maXRfY2VudHJlX2lkKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPndoZW4oJGNvc3RfY2VudHJlX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGNvc3RfY2VudHJlX2lkKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZW50cnlfaXRlbXMuY29zdF9jZW50cmVfaWQnLCAkY29zdF9jZW50cmVfaWQpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cnlfaXRlbXMuZGViaXRfY3JlZGl0JywgJ0MnKQoKICAgICAgICAgICAgICAgIC0+Z3JvdXBCeSgnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCgogICAgICAgICAgICAgICAgLT5nZXQoWwogICAgICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJywKICAgICAgICAgICAgICAgICAgICBEQjo6cmF3KCdzdW0oZW50cnlfaXRlbXMucmVwb3J0aW5nX2Ftb3VudCkgYXMgcmVwb3J0aW5nX2Ftb3VudCcpCiAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICAkZGViaXRFbnRyeUl0ZW1zID0gRW50cnlJdGVtOjpqb2luKCdlbnRyaWVzJywgJ2VudHJpZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5lbnRyeV9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2Nvc3RfY2VudHJlcycsICdjb3N0X2NlbnRyZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jb3N0X2NlbnRyZV9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ3Byb2ZpdF9jZW50cmVzJywgJ3Byb2ZpdF9jZW50cmVzLmlkJywgJz0nLCAnY29zdF9jZW50cmVzLnByb2ZpdF9jZW50cmVfaWQnKQoKICAgICAgICAgICAgICAgIC0+am9pbignY2hhcnRfb2ZfYWNjb3VudHMnLCAnY2hhcnRfb2ZfYWNjb3VudHMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJykKICAgICAgICAgICAgICAgIC0+am9pbignYWNjb3VudF9ncm91cHMnLCAnYWNjb3VudF9ncm91cHMuaWQnLCAnPScsICdjaGFydF9vZl9hY2NvdW50cy5hY2NvdW50X2dyb3VwX2lkJykKCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmlzX2FwcHJvdmVkJywgJ2FwcHJvdmVkJykKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZGF0ZScsICc+PScsICRyZXF1ZXN0LT5mcm9tKQogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cmllcy5kYXRlJywgJzw9JywgJHJlcXVlc3QtPnRvKQogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cmllcy5maXNjYWxfeWVhcl9pZCcsICRmaXNjYWxZZWFyLT5pZCkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ3Byb2ZpdF9jZW50cmVzLmNvbXBhbnlfaWQnLCByZXF1ZXN0KCktPmdldCgnY29tcGFueV9pZCcpKQogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cnlfaXRlbXMuZGViaXRfY3JlZGl0JywgJ0QnKQoKICAgICAgICAgICAgICAgIC0+Z3JvdXBCeSgnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCgogICAgICAgICAgICAgICAgLT5nZXQoWwogICAgICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJywKICAgICAgICAgICAgICAgICAgICBEQjo6cmF3KCdzdW0oZW50cnlfaXRlbXMucmVwb3J0aW5nX2Ftb3VudCkgYXMgcmVwb3J0aW5nX2Ftb3VudCcpCiAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICAkY3JlZGl0RW50cnlJdGVtcyA9IEVudHJ5SXRlbTo6am9pbignZW50cmllcycsICdlbnRyaWVzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuZW50cnlfaWQnKQogICAgICAgICAgICAgICAgLT5qb2luKCdjb3N0X2NlbnRyZXMnLCAnY29zdF9jZW50cmVzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuY29zdF9jZW50cmVfaWQnKQogICAgICAgICAgICAgICAgLT5qb2luKCdwcm9maXRfY2VudHJlcycsICdwcm9maXRfY2VudHJlcy5pZCcsICc9JywgJ2Nvc3RfY2VudHJlcy5wcm9maXRfY2VudHJlX2lkJykKCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2NoYXJ0X29mX2FjY291bnRzJywgJ2NoYXJ0X29mX2FjY291bnRzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2FjY291bnRfZ3JvdXBzJywgJ2FjY291bnRfZ3JvdXBzLmlkJywgJz0nLCAnY2hhcnRfb2ZfYWNjb3VudHMuYWNjb3VudF9ncm91cF9pZCcpCgogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cmllcy5pc19hcHByb3ZlZCcsICdhcHByb3ZlZCcpCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmRhdGUnLCAnPj0nLCAkcmVxdWVzdC0+ZnJvbSkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZGF0ZScsICc8PScsICRyZXF1ZXN0LT50bykKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZmlzY2FsX3llYXJfaWQnLCAkZmlzY2FsWWVhci0+aWQpCiAgICAgICAgICAgICAgICAtPndoZXJlKCdwcm9maXRfY2VudHJlcy5jb21wYW55X2lkJywgcmVxdWVzdCgpLT5nZXQoJ2NvbXBhbnlfaWQnKSkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJ5X2l0ZW1zLmRlYml0X2NyZWRpdCcsICdDJykKCiAgICAgICAgICAgICAgICAtPmdyb3VwQnkoJ2VudHJ5X2l0ZW1zLmNoYXJ0X29mX2FjY291bnRfaWQnKQoKICAgICAgICAgICAgICAgIC0+Z2V0KFsKICAgICAgICAgICAgICAgICAgICAnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcsCiAgICAgICAgICAgICAgICAgICAgREI6OnJhdygnc3VtKGVudHJ5X2l0ZW1zLnJlcG9ydGluZ19hbW91bnQpIGFzIHJlcG9ydGluZ19hbW91bnQnKQogICAgICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgJGNhcnJ5Rm9yd2FyZGVkID0gRmlzY2FsWWVhckNsb3NpbmdMZWRnZXI6OmpvaW4oJ2Zpc2NhbF95ZWFyX2Nsb3NpbmdzJywgJ2Zpc2NhbF95ZWFyX2Nsb3NpbmdzLmlkJywgJz0nLCAnZmlzY2FsX3llYXJfY2xvc2luZ19sZWRnZXJzLmZpc2NhbF95ZWFyX2Nsb3NpbmdfaWQnKQoKICAgICAgICAgICAgICAgIC0+am9pbignY2hhcnRfb2ZfYWNjb3VudHMnLCAnY2hhcnRfb2ZfYWNjb3VudHMuaWQnLCAnPScsICdmaXNjYWxfeWVhcl9jbG9zaW5nX2xlZGdlcnMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2FjY291bnRfZ3JvdXBzJywgJ2FjY291bnRfZ3JvdXBzLmlkJywgJz0nLCAnY2hhcnRfb2ZfYWNjb3VudHMuYWNjb3VudF9ncm91cF9pZCcpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2Zpc2NhbF95ZWFyX2Nsb3NpbmdzLmNvbXBhbnlfaWQnLCByZXF1ZXN0KCktPmdldCgnY29tcGFueV9pZCcpKQogICAgICAgICAgICAgICAgLT53aGVyZSgnZmlzY2FsX3llYXJfY2xvc2luZ3MudG9fZmlzY2FsX3llYXJfaWQnLCAkZmlzY2FsWWVhci0+aWQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0+Z3JvdXBCeSgnZmlzY2FsX3llYXJfY2xvc2luZ19sZWRnZXJzLmNoYXJ0X29mX2FjY291bnRfaWQnKQoKICAgICAgICAgICAgICAgIC0+Z2V0KFsKICAgICAgICAgICAgICAgICAgICAnZmlzY2FsX3llYXJfY2xvc2luZ19sZWRnZXJzLmNoYXJ0X29mX2FjY291bnRfaWQnLAogICAgICAgICAgICAgICAgICAgIERCOjpyYXcoJ3N1bShmaXNjYWxfeWVhcl9jbG9zaW5nX2xlZGdlcnMuY2FycnlfZm9yd2FyZGluZ19hbW91bnQpIGFzIGNhcnJ5X2ZvcndhcmRpbmdfYW1vdW50JykKICAgICAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgICAgICRncm91cFdpc2UgPSAoJHJlcXVlc3QtPmdyb3VwX3dpc2UgPT0gMSk7CiAgICAgICAgICAgICAgICBpZigkZ3JvdXBXaXNlKXsKICAgICAgICAgICAgICAgICAgICAkZ3JvdXBzID0gQWNjb3VudEdyb3VwOjpkb2VzbnRIYXZlKCdwYXJlbnQnKS0+Z2V0KCk7CiAgICAgICAgICAgICAgICAgICAgaWYoJGdyb3Vwcy0+Y291bnQoKSA+IDApewogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKCRncm91cHMgYXMgJGtleSA9PiAkZ3JvdXApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRyaWFsQmFsYW5jZSAuPSB0cmlhbGJhbGFuY2UocmVxdWVzdCgpLT5nZXQoJ2NvbXBhbnlfaWQnKSwgJGdyb3VwLCByZXF1ZXN0KCktPmdldCgnZnJvbScpLCByZXF1ZXN0KCktPmdldCgndG8nKSwgMCwgIShyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiByZXF1ZXN0KCktPmdldCgncmVwb3J0X3R5cGUnKSA9PSAncGRmJyksIFsnRCcgPT4gJG9wZW5pbmdEZWJpdEVudHJ5SXRlbXMsICdDJyA9PiAkb3BlbmluZ0NyZWRpdEVudHJ5SXRlbXNdLCBbJ0QnID0+ICRkZWJpdEVudHJ5SXRlbXMsICdDJyA9PiAkY3JlZGl0RW50cnlJdGVtc10sICRhbGwsICRjYXJyeUZvcndhcmRlZCwgJHJhdGUpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgJGFjY291bnRzID0gQ2hhcnRPZkFjY291bnQ6OndpdGgoWwogICAgICAgICAgICAgICAgICAgICAgICAnYWNjb3VudEdyb3VwLmFjY291bnRDbGFzcycsCiAgICAgICAgICAgICAgICAgICAgICAgICdleGNoYW5nZVJhdGUnCiAgICAgICAgICAgICAgICAgICAgXSktPm9yZGVyQnkoJ2NvZGUnLCAnYXNjJyktPmdldCgpOwogICAgICAgICAgICAgICAgICAgICRiYWxhbmNlcyA9IFtdOwogICAgICAgICAgICAgICAgICAgIGlmKCRhY2NvdW50cy0+Y291bnQoKSA+IDApewogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKCRhY2NvdW50cyBhcyAka2V5ID0+ICRhY2NvdW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0cmlhbGJhbGFuY2VMZWRnZXIgPSB0cmlhbGJhbGFuY2VMZWRnZXIocmVxdWVzdCgpLT5nZXQoJ2NvbXBhbnlfaWQnKSwgJGFjY291bnQsIHJlcXVlc3QoKS0+Z2V0KCdmcm9tJyksIHJlcXVlc3QoKS0+Z2V0KCd0bycpLCAhKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmIHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdwZGYnKSwgWydEJyA9PiAkb3BlbmluZ0RlYml0RW50cnlJdGVtcywgJ0MnID0+ICRvcGVuaW5nQ3JlZGl0RW50cnlJdGVtc10sIFsnRCcgPT4gJGRlYml0RW50cnlJdGVtcywgJ0MnID0+ICRjcmVkaXRFbnRyeUl0ZW1zXSwgJGFsbCwgJGNhcnJ5Rm9yd2FyZGVkLCAkcmF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHJpYWxCYWxhbmNlIC49ICR0cmlhbGJhbGFuY2VMZWRnZXJbJ2RhdGEnXTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmFsYW5jZXNbJ29wZW5pbmdfYmFsYW5jZSddW10gPSAkdHJpYWxiYWxhbmNlTGVkZ2VyWydiYWxhbmNlJ11bJ29wZW5pbmdfYmFsYW5jZSddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJhbGFuY2VzWydkZWJpdCddW10gPSAkdHJpYWxiYWxhbmNlTGVkZ2VyWydiYWxhbmNlJ11bJ2RlYml0J107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmFsYW5jZXNbJ2NyZWRpdCddW10gPSAkdHJpYWxiYWxhbmNlTGVkZ2VyWydiYWxhbmNlJ11bJ2NyZWRpdCddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJhbGFuY2VzWydiYWxhbmNlJ11bXSA9ICR0cmlhbGJhbGFuY2VMZWRnZXJbJ2JhbGFuY2UnXVsnYmFsYW5jZSddOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAkdHJpYWxCYWxhbmNlIC49ICc8dHI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iMiI+PHN0cm9uZz5Ub3RhbDo8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJvcGVuaW5nX2JhbGFuY2VfY29sdW1uIiBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQiPjxzdHJvbmc+Jy5zeXN0ZW1Nb25leUZvcm1hdChhcnJheV9zdW0oJGJhbGFuY2VzWydvcGVuaW5nX2JhbGFuY2UnXSkpLic8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNsYXNzPSJkZWJpdF9jb2x1bW4iIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodCI+PHN0cm9uZz4nLnN5c3RlbU1vbmV5Rm9ybWF0KGFycmF5X3N1bSgkYmFsYW5jZXNbJ2RlYml0J10pKS4nPC9zdHJvbmc+PC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iY3JlZGl0X2NvbHVtbiIgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0Ij48c3Ryb25nPicuc3lzdGVtTW9uZXlGb3JtYXQoYXJyYXlfc3VtKCRiYWxhbmNlc1snY3JlZGl0J10pKS4nPC9zdHJvbmc+PC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjbGFzcz0iY2xvc2luZ19iYWxhbmNlX2NvbHVtbiIgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0Ij48c3Ryb25nPicuc3lzdGVtTW9uZXlGb3JtYXQoYXJyYXlfc3VtKCRiYWxhbmNlc1snYmFsYW5jZSddKSkuJzwvc3Ryb25nPjwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRjb21wYW5pZXMgPSBDb21wYW55OjpoYXMoJ3Byb2ZpdENlbnRyZXMuY29zdENlbnRyZXMnKQogICAgICAgICAgICAtPndoZXJlSGFzKCd1c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgndXNlcl9pZCcsIGF1dGgoKS0+dXNlcigpLT5pZCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+Z2V0KCk7CgogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJHRpdGxlLAogICAgICAgICAgICAgICAgJ2Zpc2NhbFllYXInID0+ICRmaXNjYWxZZWFyLAogICAgICAgICAgICAgICAgJ2dyb3VwV2lzZScgPT4gJGdyb3VwV2lzZSwKICAgICAgICAgICAgICAgICdhY2NvdW50RGVmYXVsdFNldHRpbmdzJyA9PiAkYWNjb3VudERlZmF1bHRTZXR0aW5ncywKICAgICAgICAgICAgICAgICdjb21wYW5pZXMnID0+ICRjb21wYW5pZXMsCiAgICAgICAgICAgICAgICAncHJvZml0Q2VudHJlcycgPT4gUHJvZml0Q2VudHJlOjp3aGVyZSgnY29tcGFueV9pZCcsICRjb21wYW5pZXMtPmZpcnN0KCktPmlkKS0+b3JkZXJCeSgnY29kZScsICdhc2MnKS0+Z2V0KCksCiAgICAgICAgICAgICAgICAnZmlzY2FsWWVhcnMnID0+IEZpc2NhbFllYXI6OmFsbCgpLAogICAgICAgICAgICAgICAgJ2N1cnJlbmN5VHlwZXMnID0+IEN1cnJlbmN5VHlwZTo6d2l0aChbJ2N1cnJlbmNpZXMnXSktPmdldCgpLAogICAgICAgICAgICAgICAgJ2N1cnJlbmN5JyA9PiBDdXJyZW5jeTo6ZmluZChyZXF1ZXN0KCktPmdldCgnY3VycmVuY3lfaWQnKSksCiAgICAgICAgICAgICAgICAndHJpYWxCYWxhbmNlJyA9PiAkdHJpYWxCYWxhbmNlLAogICAgICAgICAgICBdOwoKICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykgJiYgcmVxdWVzdCgpLT5nZXQoJ3JlcG9ydF90eXBlJykgPT0gJ3BkZicpewogICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdNUERGKCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy50cmlhbEJhbGFuY2UucGRmJywgJGRhdGEsICR0aXRsZSwgJHRpdGxlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykgJiYgcmVxdWVzdCgpLT5nZXQoJ3JlcG9ydF90eXBlJykgPT0gJ3JlcG9ydCcpewogICAgICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5yZXBvcnRzLnRyaWFsQmFsYW5jZS5yZXBvcnQnLCAkZGF0YSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy50cmlhbEJhbGFuY2UuaW5kZXgnLCAkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmIHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdyZXBvcnQnKXsKICAgICAgICAgICAgICAgIHJldHVybiAkdGgtPmdldE1lc3NhZ2UoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIG9ubHlXaXRoQ2xvc2luZ0JhbGFuY2UoKQogICAgewogICAgICAgICR0aXRsZSA9ICdSZXBvcnQgLSBUcmlhbCBCYWxhbmNlIChCYWxhbmNlKSc7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRmaXNjYWxZZWFyID0gZ2V0QWN0aXZlRmlzY2FsWWVhcigpOwogICAgICAgICAgICAkYWNjb3VudERlZmF1bHRTZXR0aW5ncyA9IGFjY291bnREZWZhdWx0U2V0dGluZ3MoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgICR0cmlhbEJhbGFuY2UgPSAnJzsKICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykpewogICAgICAgICAgICAgICAgJGN1cnJlbmN5X2lkID0gcmVxdWVzdCgpLT5oYXMoJ2N1cnJlbmN5X2lkJykgPyByZXF1ZXN0KCktPmdldCgnY3VycmVuY3lfaWQnKSA6IDA7CiAgICAgICAgICAgICAgICAkZmlzY2FsWWVhciA9IEZpc2NhbFllYXI6OmZpbmRPckZhaWwocmVxdWVzdCgpLT5nZXQoJ2Zpc2NhbF95ZWFyX2lkJykpOwogICAgICAgICAgICAgICAgJGFsbCA9IGdldEFsbEdyb3VwQW5kTGVkZ2VycygpOwoKICAgICAgICAgICAgICAgICRlbnRyeUl0ZW1zID0gRW50cnlJdGVtOjp3aXRoKFsKICAgICAgICAgICAgICAgICAgICAnZW50cnkuZXhjaGFuZ2VSYXRlJwogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2VudHJ5JywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdlbnRyeScsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRmaXNjYWxZZWFyKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZGF0ZScsICc+PScsICRmaXNjYWxZZWFyLT5zdGFydCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT53aGVyZUhhcygnZW50cnknLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkZmlzY2FsWWVhcil7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2RhdGUnLCAnPD0nLCAkZmlzY2FsWWVhci0+ZW5kKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdlbnRyeScsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Zpc2NhbF95ZWFyX2lkJywgcmVxdWVzdCgpLT5nZXQoJ2Zpc2NhbF95ZWFyX2lkJykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2Nvc3RDZW50cmUucHJvZml0Q2VudHJlJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnY29tcGFueV9pZCcsIHJlcXVlc3QoKS0+Z2V0KCdjb21wYW55X2lkJykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+Z2V0KCk7CgogICAgICAgICAgICAgICAgJGNhcnJ5Rm9yd2FyZGVkID0gRmlzY2FsWWVhckNsb3Npbmc6OndpdGgoWwogICAgICAgICAgICAgICAgICAgICdleGNoYW5nZVJhdGUnLAogICAgICAgICAgICAgICAgICAgICdsZWRnZXJzJwogICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2NvbXBhbnlfaWQnLCByZXF1ZXN0KCktPmdldCgnY29tcGFueV9pZCcpKQogICAgICAgICAgICAgICAgLT53aGVyZSgndG9fZmlzY2FsX3llYXJfaWQnLCAkZmlzY2FsWWVhci0+aWQpCiAgICAgICAgICAgICAgICAtPmdldCgpOwoKICAgICAgICAgICAgICAgICRleGNoYW5nZVJhdGVzID0gRXhjaGFuZ2VSYXRlOjp3aGVyZSgnY3VycmVuY3lfaWQnLCAnIT0nLCAkY3VycmVuY3lfaWQpCiAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdlbnRyaWVzLml0ZW1zJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGVudHJ5SXRlbXMpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSW4oJ2lkJywgJGVudHJ5SXRlbXMtPnBsdWNrKCdpZCcpLT50b0FycmF5KCkpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+d2hlcmVIYXMoJ2VudHJpZXMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdpc19hcHByb3ZlZCcsICdhcHByb3ZlZCcpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+Z2V0KCk7CgogICAgICAgICAgICAgICAgJGdyb3VwV2lzZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgaWYoJGdyb3VwV2lzZSl7CiAgICAgICAgICAgICAgICAgICAgJGdyb3VwcyA9IEFjY291bnRHcm91cDo6ZG9lc250SGF2ZSgncGFyZW50JyktPmdldCgpOwogICAgICAgICAgICAgICAgICAgIGlmKCRncm91cHMtPmNvdW50KCkgPiAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkZ3JvdXBzIGFzICRrZXkgPT4gJGdyb3VwKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0cmlhbEJhbGFuY2UgLj0gdHJpYWxiYWxhbmNlT25seUNsb3NpbmdCYWxhbmNlKCRncm91cCwgcmVxdWVzdCgpLT5nZXQoJ2Zyb20nKSwgcmVxdWVzdCgpLT5nZXQoJ3RvJyksICRjdXJyZW5jeV9pZCwgMCwgIShyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiByZXF1ZXN0KCktPmdldCgncmVwb3J0X3R5cGUnKSA9PSAncGRmJyksICRleGNoYW5nZVJhdGVzLCAkZW50cnlJdGVtcywgJGFsbCwgcmVxdWVzdCgpLT5nZXQoJ2NvbXBhbnlfaWQnKSwgcmVxdWVzdCgpLT5nZXQoJ2Zpc2NhbF95ZWFyX2lkJyksICRjYXJyeUZvcndhcmRlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAkYWNjb3VudHMgPSBDaGFydE9mQWNjb3VudDo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgICAgICdhY2NvdW50R3JvdXAuYWNjb3VudENsYXNzJwogICAgICAgICAgICAgICAgICAgIF0pLT5vcmRlckJ5KCdjb2RlJywgJ2FzYycpLT5nZXQoKTsKICAgICAgICAgICAgICAgICAgICAkYmFsYW5jZXMgPSBbXTsKICAgICAgICAgICAgICAgICAgICBpZigkYWNjb3VudHMtPmNvdW50KCkgPiAwKXsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkYWNjb3VudHMgYXMgJGtleSA9PiAkYWNjb3VudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHJpYWxiYWxhbmNlTGVkZ2VyID0gdHJpYWxiYWxhbmNlT25seUNsb3NpbmdCYWxhbmNlTGVkZ2VyKCRhY2NvdW50LCByZXF1ZXN0KCktPmdldCgnZnJvbScpLCByZXF1ZXN0KCktPmdldCgndG8nKSwgJGN1cnJlbmN5X2lkLCAhKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmIHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdwZGYnKSwgJGV4Y2hhbmdlUmF0ZXMsICRlbnRyeUl0ZW1zLCAkYWxsLCByZXF1ZXN0KCktPmdldCgnY29tcGFueV9pZCcpLCByZXF1ZXN0KCktPmdldCgnZmlzY2FsX3llYXJfaWQnKSwgJGNhcnJ5Rm9yd2FyZGVkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0cmlhbEJhbGFuY2UgLj0gJHRyaWFsYmFsYW5jZUxlZGdlclsnZGF0YSddOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRiYWxhbmNlc1snb3BlbmluZ19iYWxhbmNlJ11bXSA9ICR0cmlhbGJhbGFuY2VMZWRnZXJbJ2JhbGFuY2UnXVsnb3BlbmluZ19iYWxhbmNlJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmFsYW5jZXNbJ2JhbGFuY2UnXVtdID0gJHRyaWFsYmFsYW5jZUxlZGdlclsnYmFsYW5jZSddWydiYWxhbmNlJ107CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICR0cmlhbEJhbGFuY2UgLj0gJzx0cj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSIyIj48c3Ryb25nPlRvdGFsOjwvc3Ryb25nPjwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9Im9wZW5pbmdfYmFsYW5jZV9jb2x1bW4iIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodCI+PHN0cm9uZz4nLnN5c3RlbU1vbmV5Rm9ybWF0KGFycmF5X3N1bSgkYmFsYW5jZXNbJ29wZW5pbmdfYmFsYW5jZSddKSkuJzwvc3Ryb25nPjwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY2xhc3M9ImNsb3NpbmdfYmFsYW5jZV9jb2x1bW4iIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodCI+PHN0cm9uZz4nLnN5c3RlbU1vbmV5Rm9ybWF0KGFycmF5X3N1bSgkYmFsYW5jZXNbJ2JhbGFuY2UnXSkpLic8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgICAgICA8L3RyPic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJHRpdGxlLAogICAgICAgICAgICAgICAgJ2Zpc2NhbFllYXInID0+ICRmaXNjYWxZZWFyLAogICAgICAgICAgICAgICAgJ2FjY291bnREZWZhdWx0U2V0dGluZ3MnID0+ICRhY2NvdW50RGVmYXVsdFNldHRpbmdzLAogICAgICAgICAgICAgICAgJ2NvbXBhbmllcycgPT4gQ29tcGFueTo6aGFzKCdwcm9maXRDZW50cmVzLmNvc3RDZW50cmVzJyktPmdldCgpLAogICAgICAgICAgICAgICAgJ2Zpc2NhbFllYXJzJyA9PiBGaXNjYWxZZWFyOjphbGwoKSwKICAgICAgICAgICAgICAgICdjdXJyZW5jeVR5cGVzJyA9PiBDdXJyZW5jeVR5cGU6OndpdGgoWydjdXJyZW5jaWVzJ10pLT5nZXQoKSwKICAgICAgICAgICAgICAgICdjdXJyZW5jeScgPT4gQ3VycmVuY3k6OmZpbmQocmVxdWVzdCgpLT5nZXQoJ2N1cnJlbmN5X2lkJykpLAogICAgICAgICAgICAgICAgJ3RyaWFsQmFsYW5jZScgPT4gJHRyaWFsQmFsYW5jZSwKICAgICAgICAgICAgXTsKCiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmIHJlcXVlc3QoKS0+Z2V0KCdyZXBvcnRfdHlwZScpID09ICdwZGYnKXsKICAgICAgICAgICAgICAgIHJldHVybiB2aWV3TVBERignYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnJlcG9ydHMudHJpYWxCYWxhbmNlLm9ubHlXaXRoQ2xvc2luZ0JhbGFuY2VQREYnLCAkZGF0YSwgJHRpdGxlLCAkdGl0bGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiByZXF1ZXN0KCktPmdldCgncmVwb3J0X3R5cGUnKSA9PSAncmVwb3J0Jyl7CiAgICAgICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnJlcG9ydHMudHJpYWxCYWxhbmNlLm9ubHlXaXRoQ2xvc2luZ0JhbGFuY2VSZXBvcnQnLCAkZGF0YSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy50cmlhbEJhbGFuY2Uub25seVdpdGhDbG9zaW5nQmFsYW5jZScsICRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykgJiYgcmVxdWVzdCgpLT5nZXQoJ3JlcG9ydF90eXBlJykgPT0gJ3JlcG9ydCcpewogICAgICAgICAgICAgICAgcmV0dXJuICR0aC0+Z2V0TWVzc2FnZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KfQo=