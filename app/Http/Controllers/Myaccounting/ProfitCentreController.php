<?php
bolt_decrypt( __FILE__ , 'wGJ0tT'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDb21wYW55Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcUHJvZml0Q2VudHJlOwoKdXNlIEFwcCwgREIsIERhdGFUYWJsZXM7CgpjbGFzcyBQcm9maXRDZW50cmVDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7ICAgCgogICAgcHVibGljIGZ1bmN0aW9uIGhlYWRlckNvbHVtbnMoJHZhbHVlPScnKQogICAgewogICAgICAgIHJldHVybiBhcnJheSgKICAgICAgICAgICAgWydTTCcsICdTTCddLAogICAgICAgICAgICBbJ2NvbXBhbnknLCAnY29tcGFueScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2NvZGUnLCAnY29kZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ25hbWUnLCAnbmFtZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3Bob25lJywgJ3Bob25lJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnZW1haWwnLCAnZW1haWwnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydhZGRyZXNzJywgJ2FkZHJlc3MnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydsb2dvJywgJ2xvZ28nLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydiYW5uZXInLCAnYmFubmVyJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYWN0aW9ucycsICdhY3Rpb25zJywgJ3RleHQtY2VudGVyJ10KICAgICAgICApOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHJlcXVlc3QoKS0+YWpheCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YXRhYmxlczo6b2YoCiAgICAgICAgICAgICAgICAgICAgUHJvZml0Q2VudHJlOjp3aXRoKFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbXBhbnknLAogICAgICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgICAgICAgLT53aGVuKCFkYXRhdGFibGVPcmRlcmluZygpLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCdpZCcsICdkZXNjJyk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY29tcGFueScsIGZ1bmN0aW9uKCRwcm9maXRDZW50cmUpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHByb2ZpdENlbnRyZS0+Y29tcGFueS0+bmFtZTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY29tcGFueScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2NvbXBhbnknLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcndoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdjb21wYW55JywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgQ29tcGFueTo6c2VsZWN0KCdjb21wYW5pZXMubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2NvbXBhbmllcy5pZCcsICdwcm9maXRfY2VudHJlcy5jb21wYW55X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCdsb2dvJywgZnVuY3Rpb24oJHByb2ZpdENlbnRyZSl7CiAgICAgICAgICAgICAgICAgICAgaWYoIWVtcHR5KCRwcm9maXRDZW50cmUtPmxvZ28pKXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8aW1nIHNyYz0iJy5hc3NldCgkcHJvZml0Q2VudHJlLT5sb2dvKS4nIiBzdHlsZT0ibWF4LWhlaWdodDogMTVweCI+JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCdiYW5uZXInLCBmdW5jdGlvbigkcHJvZml0Q2VudHJlKXsKICAgICAgICAgICAgICAgICAgICBpZighZW1wdHkoJHByb2ZpdENlbnRyZS0+YmFubmVyKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGltZyBzcmM9IicuYXNzZXQoJHByb2ZpdENlbnRyZS0+YmFubmVyKS4nIiBzdHlsZT0ibWF4LWhlaWdodDogMTVweCI+JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24oJHByb2ZpdENlbnRyZSl7CiAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnMgPSAnJzsKCiAgICAgICAgICAgICAgICAgICAgaWYoYXV0aCgpLT51c2VyKCktPmhhc1Blcm1pc3Npb25UbygncHJvZml0LWNlbnRyZS1lZGl0JykpewogICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXByaW1hcnkgcm91bmRlZC1jaXJjbGUgbS0xIiBocmVmPSInLiB1cmwoJ2FjY291bnRpbmcvcHJvZml0LWNlbnRyZXMvJy4kcHJvZml0Q2VudHJlLT5pZC4nL2VkaXQnKS4nIj48aSBjbGFzcz0ibGFzIGxhLWVkaXQiPjwvaT48L2E+JzsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKGF1dGgoKS0+dXNlcigpLT5oYXNQZXJtaXNzaW9uVG8oJ3Byb2ZpdC1jZW50cmUtZGVsZXRlJykpewogICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKDApIiBjbGFzcz0iYnRuIGJ0bi14cyBidG4tZGFuZ2VyIG0tMSIgZGF0YS1zcmM9Iicucm91dGUoJ2FjY291bnRpbmcucHJvZml0LWNlbnRyZXMuZGVzdHJveScsICRwcm9maXRDZW50cmUtPmlkKS4nIiBvbmNsaWNrPSJkZWxldGVGcm9tQ1JVRCgkKHRoaXMpKSI+PGkgY2xhc3M9ImxhIGxhLXRyYXNoIj48L2k+PC9hPic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiAkYWN0aW9uczsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPnJhd0NvbHVtbnMoWydjb21wYW55JywnbG9nbycsJ2Jhbm5lcicsJ2FjdGlvbnMnXSkKICAgICAgICAgICAgICAgIC0+bWFrZSh0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICJQcm9maXQgQ2VudHJlIiwKICAgICAgICAgICAgICAgICdjb21wYW5pZXMnID0+IENvbXBhbnk6OmFsbCgpLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCksCiAgICAgICAgICAgIF07CgogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnByb2ZpdENlbnRyZXMuaW5kZXgnLCAkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAndGl0bGUnID0+ICdOZXcgUHJvZml0IENlbnRyZScsCiAgICAgICAgICAgICdjb21wYW5pZXMnID0+IENvbXBhbnk6OndpdGgoWwogICAgICAgICAgICAgICAgJ3Byb2ZpdENlbnRyZXMnCiAgICAgICAgICAgIF0pLT5nZXQoKSwKICAgICAgICBdOwoKICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnByb2ZpdENlbnRyZXMuY3JlYXRlJywgJGRhdGEpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzdG9yZShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICRyZXF1ZXN0LT52YWxpZGF0ZShbCiAgICAgICAgICAgICdjb21wYW55X2lkJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnY29kZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTpwcm9maXRfY2VudHJlcycsCiAgICAgICAgICAgICduYW1lJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAvLyAncGhvbmUnID0+IFsncmVxdWlyZWQnLCAnc3RyaW5nJywgJ21heDoxNCcsICdyZWdleDovXihbMC05XHNcLVwrXChcKV0qKSQvJ10sCiAgICAgICAgICAgIC8vICdlbWFpbCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgLy8gJ2FkZHJlc3MnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgXSk7CgogICAgICAgIGlmKCRyZXF1ZXN0LT5oYXNGaWxlKCdsb2dvX2ZpbGUnKSl7CiAgICAgICAgICAgICRyZXF1ZXN0LT52YWxpZGF0ZShbCiAgICAgICAgICAgICAgICAnbG9nb19maWxlJyA9PiBbJ3JlcXVpcmVkJywnbWltZXM6anBlZyxqcGcscG5nLGdpZicsICdtYXg6MzA3MiddLAogICAgICAgICAgICBdKTsKICAgICAgICB9CgogICAgICAgIGlmKCRyZXF1ZXN0LT5oYXNGaWxlKCdiYW5uZXJfZmlsZScpKXsKICAgICAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgICAgICdiYW5uZXJfZmlsZScgPT4gWydyZXF1aXJlZCcsJ21pbWVzOmpwZWcsanBnLHBuZyxnaWYnLCAnbWF4OjMwNzInXSwKICAgICAgICAgICAgXSk7CiAgICAgICAgfQoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJHByb2ZpdENlbnRyZSA9IG5ldyBQcm9maXRDZW50cmUoKTsKICAgICAgICAgICAgJHByb2ZpdENlbnRyZS0+ZmlsbCgkcmVxdWVzdC0+YWxsKCkpOwogICAgICAgICAgICAkcHJvZml0Q2VudHJlLT5waG9uZSA9ICFlbXB0eSgkcmVxdWVzdC0+cGhvbmUpID8gJHJlcXVlc3QtPnBob25lIDogJzAxMjM0NTY3ODkwJzsKICAgICAgICAgICAgJHByb2ZpdENlbnRyZS0+ZW1haWwgPSAhZW1wdHkoJHJlcXVlc3QtPmVtYWlsKSA/ICRyZXF1ZXN0LT5lbWFpbCA6ICdleGFtcGxlQGVtYWlsLmNvbSc7CiAgICAgICAgICAgICRwcm9maXRDZW50cmUtPnNhdmUoKTsKCiAgICAgICAgICAgIGlmKCRyZXF1ZXN0LT5oYXNGaWxlKCdsb2dvX2ZpbGUnKSl7CiAgICAgICAgICAgICAgICAkcHJvZml0Q2VudHJlLT5sb2dvID0gJHRoaXMtPmZpbGVVcGxvYWQoJHJlcXVlc3QtPmZpbGUoJ2xvZ29fZmlsZScpLCAndXBsb2FkL3Byb2ZpdC1jZW50cmUvbG9nbycpOwogICAgICAgICAgICAgICAgJHByb2ZpdENlbnRyZS0+c2F2ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZigkcmVxdWVzdC0+aGFzRmlsZSgnYmFubmVyX2ZpbGUnKSl7CiAgICAgICAgICAgICAgICAkcHJvZml0Q2VudHJlLT5iYW5uZXIgPSAkdGhpcy0+ZmlsZVVwbG9hZCgkcmVxdWVzdC0+ZmlsZSgnYmFubmVyX2ZpbGUnKSwgJ3VwbG9hZC9wcm9maXQtY2VudHJlL2Jhbm5lcicpOwogICAgICAgICAgICAgICAgJHByb2ZpdENlbnRyZS0+c2F2ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cmVkaXJlY3RCYWNrV2l0aFN1Y2Nlc3MoIlByb2ZpdCBDZW50cmUgaGFzIGJlZW4gY3JlYXRlZCBzdWNjZXNzZnVsbHkiLCAnYWNjb3VudGluZy5wcm9maXQtY2VudHJlcy5jcmVhdGUnKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBlZGl0KCRpZCkKICAgIHsKICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgJ3RpdGxlJyA9PiAnRWRpdCBQcm9maXQgQ2VudHJlJywKICAgICAgICAgICAgJ2NvbXBhbmllcycgPT4gQ29tcGFueTo6d2l0aChbCiAgICAgICAgICAgICAgICAncHJvZml0Q2VudHJlcycKICAgICAgICAgICAgXSktPmdldCgpLAogICAgICAgICAgICAncHJvZml0Q2VudHJlJyA9PiBQcm9maXRDZW50cmU6OmZpbmRPckZhaWwoJGlkKQogICAgICAgIF07CgogICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucHJvZml0Q2VudHJlcy5lZGl0JywgJGRhdGEpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGUoUmVxdWVzdCAkcmVxdWVzdCwgJGlkKQogICAgewogICAgICAgICRyZXF1ZXN0LT52YWxpZGF0ZShbCiAgICAgICAgICAgICdjb21wYW55X2lkJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnY29kZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTpwcm9maXRfY2VudHJlcyxjb2RlLCcuJGlkLAogICAgICAgICAgICAnbmFtZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgLy8gJ3Bob25lJyA9PiBbJ3JlcXVpcmVkJywgJ3N0cmluZycsICdtYXg6MTQnLCAncmVnZXg6L14oWzAtOVxzXC1cK1woXCldKikkLyddLAogICAgICAgICAgICAvLyAnZW1haWwnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgIC8vICdhZGRyZXNzJyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBpZigkcmVxdWVzdC0+aGFzRmlsZSgnbG9nb19maWxlJykpewogICAgICAgICAgICAkcmVxdWVzdC0+dmFsaWRhdGUoWwogICAgICAgICAgICAgICAgJ2xvZ29fZmlsZScgPT4gWydyZXF1aXJlZCcsJ21pbWVzOmpwZWcsanBnLHBuZyxnaWYnLCAnbWF4OjMwNzInXSwKICAgICAgICAgICAgXSk7CiAgICAgICAgfQoKICAgICAgICBpZigkcmVxdWVzdC0+aGFzRmlsZSgnYmFubmVyX2ZpbGUnKSl7CiAgICAgICAgICAgICRyZXF1ZXN0LT52YWxpZGF0ZShbCiAgICAgICAgICAgICAgICAnYmFubmVyX2ZpbGUnID0+IFsncmVxdWlyZWQnLCdtaW1lczpqcGVnLGpwZyxwbmcsZ2lmJywgJ21heDozMDcyJ10sCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KCiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRwcm9maXRDZW50cmUgPSBQcm9maXRDZW50cmU6OmZpbmQoJGlkKTsKICAgICAgICAgICAgJHByb2ZpdENlbnRyZS0+ZmlsbCgkcmVxdWVzdC0+YWxsKCkpOwogICAgICAgICAgICAkcHJvZml0Q2VudHJlLT5waG9uZSA9ICFlbXB0eSgkcmVxdWVzdC0+cGhvbmUpID8gJHJlcXVlc3QtPnBob25lIDogJzAxMjM0NTY3ODkwJzsKICAgICAgICAgICAgJHByb2ZpdENlbnRyZS0+ZW1haWwgPSAhZW1wdHkoJHJlcXVlc3QtPmVtYWlsKSA/ICRyZXF1ZXN0LT5lbWFpbCA6ICdleGFtcGxlQGVtYWlsLmNvbSc7CiAgICAgICAgICAgICRwcm9maXRDZW50cmUtPnNhdmUoKTsKCiAgICAgICAgICAgIGlmKCRyZXF1ZXN0LT5oYXNGaWxlKCdsb2dvX2ZpbGUnKSl7CiAgICAgICAgICAgICAgICBpZighZW1wdHkoJHByb2ZpdENlbnRyZS0+bG9nbykpewogICAgICAgICAgICAgICAgICAgIHVubGluayhwdWJsaWNfcGF0aCgkcHJvZml0Q2VudHJlLT5sb2dvKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkcHJvZml0Q2VudHJlLT5sb2dvID0gJHRoaXMtPmZpbGVVcGxvYWQoJHJlcXVlc3QtPmZpbGUoJ2xvZ29fZmlsZScpLCAndXBsb2FkL3Byb2ZpdC1jZW50cmUvbG9nbycpOwogICAgICAgICAgICAgICAgJHByb2ZpdENlbnRyZS0+c2F2ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZigkcmVxdWVzdC0+aGFzRmlsZSgnYmFubmVyX2ZpbGUnKSl7CiAgICAgICAgICAgICAgICBpZighZW1wdHkoJHByb2ZpdENlbnRyZS0+YmFubmVyKSl7CiAgICAgICAgICAgICAgICAgICAgdW5saW5rKHB1YmxpY19wYXRoKCRwcm9maXRDZW50cmUtPmJhbm5lcikpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRwcm9maXRDZW50cmUtPmJhbm5lciA9ICR0aGlzLT5maWxlVXBsb2FkKCRyZXF1ZXN0LT5maWxlKCdiYW5uZXJfZmlsZScpLCAndXBsb2FkL3Byb2ZpdC1jZW50cmUvYmFubmVyJyk7CiAgICAgICAgICAgICAgICAkcHJvZml0Q2VudHJlLT5zYXZlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5yZWRpcmVjdEJhY2tXaXRoU3VjY2VzcygiUHJvZml0IENlbnRyZSBoYXMgYmVlbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSIsICdhY2NvdW50aW5nLnByb2ZpdC1jZW50cmVzLmluZGV4Jyk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIERCOjpyb2xsYmFjaygpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveSgkaWQpCiAgICB7CiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRwcm9maXRDZW50cmUgPSBQcm9maXRDZW50cmU6OmZpbmQoJGlkKTsKICAgICAgICAgICAgaWYoIWVtcHR5KCRwcm9maXRDZW50cmUtPmxvZ28pKXsKICAgICAgICAgICAgICAgIHVubGluayhwdWJsaWNfcGF0aCgkcHJvZml0Q2VudHJlLT5sb2dvKSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKCFlbXB0eSgkcHJvZml0Q2VudHJlLT5iYW5uZXIpKXsKICAgICAgICAgICAgICAgIHVubGluayhwdWJsaWNfcGF0aCgkcHJvZml0Q2VudHJlLT5iYW5uZXIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkZGVsZXRlID0gUHJvZml0Q2VudHJlOjpmaW5kKCRpZCktPmRlbGV0ZSgpOwoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAiUHJvZml0IENlbnRyZSBoYXMgYmVlbiBEZWxldGVkISIKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIERCOjpyb2xsYmFjaygpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJHRoLT5nZXRNZXNzYWdlKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfQogICAgfQp9Cg==