<?php
bolt_decrypt( __FILE__ , 'oEg5aO'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcDsKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDb21wYW55Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQWNjb3VudEdyb3VwOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQmFuazsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEJhbmtBY2NvdW50Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQmFua0FjY291bnRUeXBlOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQmFua0JyYW5jaDsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXENoYXJ0T2ZBY2NvdW50Owp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ3VycmVuY3lUeXBlOwp1c2UgWWFqcmFcRGF0YVRhYmxlc1xGYWNhZGVzXERhdGFUYWJsZXM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xEQjsKdXNlIElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0OwoKY2xhc3MgQmFua0FjY291bnRzQ29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewogICAgcHVibGljIGZ1bmN0aW9uIGhlYWRlckNvbHVtbnMoJHZhbHVlID0gJycpCiAgICB7CiAgICAgICAgcmV0dXJuIGFycmF5KAogICAgICAgICAgICBbJ1NMJywgJ1NMJ10sCiAgICAgICAgICAgIFsnY29kZScsICdjb2RlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsndHlwZScsICd0eXBlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnbmFtZScsICduYW1lJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnbnVtYmVyJywgJ251bWJlcicsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2JhbmtfbmFtZScsICdiYW5rX25hbWUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydiYW5rX2JyYW5jaF9uYW1lJywgJ2JhbmtfYnJhbmNoX25hbWUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydiYW5rX2FkZHJlc3MnLCAnYmFua19hZGRyZXNzJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnY3VycmVuY3knLCAnY3VycmVuY3knLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydsZWRnZXInLCAnbGVkZ2VyJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnY29tcGFuaWVzJywgJ2NvbXBhbmllcycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICAvLyBbJ2NoYXJnZXNfYWNjb3VudCcsICdjaGFyZ2VzX2FjY291bnQnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydzdGF0dXMnLCAnc3RhdHVzJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYWN0aW9ucycsICdhY3Rpb25zJywgJ3RleHQtY2VudGVyJ10KICAgICAgICApOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ2xlZGdlci13aXRoLW5vLWJhbmstYWNjb3VudHMnKSl7CiAgICAgICAgICAgIHJldHVybiBkb3dubG9hZEV4Y2VsKCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuYmFua0FjY291bnRzLmV4Y2VsJywgWwogICAgICAgICAgICAgICAgJ2xlZGdlcnMnID0+IENoYXJ0T2ZBY2NvdW50Ojp3aXRoKFsKICAgICAgICAgICAgICAgICAgICAnYmFua0FjY291bnRzJywKICAgICAgICAgICAgICAgICAgICAnY29tcGFuaWVzLmNvbXBhbnknCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgLT53aGVyZUhhcygnY29tcGFuaWVzLmNvbXBhbnknLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjb2RlJywgcmVxdWVzdCgpLT5nZXQoJ2NvbXBhbnknKSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5nZXQoKQogICAgICAgICAgICBdLCByZXF1ZXN0KCktPmdldCgnY29tcGFueScpLictbGVkZ2VyLXdpdGgtbm8tYmFuay1hY2NvdW50cycpOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHJlcXVlc3QoKS0+YWpheCgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gRGF0YVRhYmxlczo6b2YoCiAgICAgICAgICAgICAgICAgICAgICAgIEJhbmtBY2NvdW50Ojp3aXRoKFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjdXJyZW5jeScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY2hhcnRPZkFjY291bnQuY29tcGFuaWVzLmNvbXBhbnknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2JhbmtDaGFyZ2VzQWNjb3VudCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYmFua0FjY291bnRUeXBlJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdiYW5rQnJhbmNoLmJhbmsnCiAgICAgICAgICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbigndHlwZScsIGZ1bmN0aW9uICgkYmFua0FjY291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRiYW5rQWNjb3VudC0+YmFua0FjY291bnRUeXBlLT5uYW1lKSA/ICRiYW5rQWNjb3VudC0+YmFua0FjY291bnRUeXBlLT5uYW1lIC4gJygnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuICRiYW5rQWNjb3VudC0+YmFua0FjY291bnRUeXBlLT5jb2RlIC4gJyknIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigndHlwZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYW5rQWNjb3VudFR5cGUnLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ2NvZGUnLCAnTElLRScsICclJyAuICRrZXl3b3JkIC4gJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCd0eXBlJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIEJhbmtBY2NvdW50VHlwZTo6c2VsZWN0KCdiYW5rX2FjY291bnRfdHlwZXMubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdiYW5rX2FjY291bnRfdHlwZXMuaWQnLCAnYmFua19hY2NvdW50cy5iYW5rX2FjY291bnRfdHlwZV9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYmFua19uYW1lJywgZnVuY3Rpb24gKCRiYW5rQWNjb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJGJhbmtBY2NvdW50LT5iYW5rQnJhbmNoLT5iYW5rLT5uYW1lKSA/ICRiYW5rQWNjb3VudC0+YmFua0JyYW5jaC0+YmFuay0+bmFtZSAuICcoJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLiAkYmFua0FjY291bnQtPmJhbmtCcmFuY2gtPmJhbmstPmNvZGUgLiAnKScgOiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdiYW5rX25hbWUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmFua0JyYW5jaC5iYW5rJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlICgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignYmFua19uYW1lJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIEJhbmtCcmFuY2g6OnNlbGVjdCgnYmFua3MubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2JhbmtzJywgJ2JhbmtzLmlkJywgJz0nLCAnYmFua19icmFuY2hlcy5iYW5rX2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2JhbmtfYnJhbmNoZXMuaWQnLCAnYmFua19hY2NvdW50cy5iYW5rX2JyYW5jaF9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignYmFua19icmFuY2hfbmFtZScsIGZ1bmN0aW9uICgkYmFua0FjY291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRiYW5rQWNjb3VudC0+YmFua0JyYW5jaC0+bmFtZSkgPyAkYmFua0FjY291bnQtPmJhbmtCcmFuY2gtPm5hbWUgLiAnKCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4gJGJhbmtBY2NvdW50LT5iYW5rQnJhbmNoLT5jb2RlIC4gJyknIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignYmFua19icmFuY2hfbmFtZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdiYW5rQnJhbmNoJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlICgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdjb2RlJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignYmFua19icmFuY2hfbmFtZScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBCYW5rQnJhbmNoOjpzZWxlY3QoJ2JhbmtfYnJhbmNoZXMubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdiYW5rX2JyYW5jaGVzLmlkJywgJ2JhbmtfYWNjb3VudHMuYmFua19icmFuY2hfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2JhbmtfYWRkcmVzcycsIGZ1bmN0aW9uICgkYmFua0FjY291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRiYW5rQWNjb3VudC0+YmFua0JyYW5jaC0+YWRkcmVzcykgPyAkYmFua0FjY291bnQtPmJhbmtCcmFuY2gtPmFkZHJlc3MgOiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdiYW5rX2FkZHJlc3MnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnYmFua0JyYW5jaCcsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSAoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2FkZHJlc3MnLCAnTElLRScsICclJyAuICRrZXl3b3JkIC4gJyUnKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignYmFua19hZGRyZXNzJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIEJhbmtCcmFuY2g6OnNlbGVjdCgnYmFua19icmFuY2hlcy5hZGRyZXNzJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2JhbmtfYnJhbmNoZXMuaWQnLCAnYmFua19hY2NvdW50cy5iYW5rX2JyYW5jaF9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJGJhbmtBY2NvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkYmFua0FjY291bnQtPmN1cnJlbmN5LT5jb2RlOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2N1cnJlbmN5JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2N1cnJlbmN5JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlICgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnY29kZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ2N1cnJlbmN5JywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIEN1cnJlbmN5OjpzZWxlY3QoJ2N1cnJlbmNpZXMubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdjdXJyZW5jaWVzLmlkJywgJ2JhbmtfYWNjb3VudHMuY3VycmVuY3lfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2xlZGdlcicsIGZ1bmN0aW9uICgkYmFua0FjY291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGlzc2V0KCRiYW5rQWNjb3VudC0+Y2hhcnRPZkFjY291bnQtPmNvZGUpID8gJ1snIC4gJGJhbmtBY2NvdW50LT5jaGFydE9mQWNjb3VudC0+Y29kZSAuICddICcgLiAkYmFua0FjY291bnQtPmNoYXJ0T2ZBY2NvdW50LT5uYW1lIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignbGVkZ2VyJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2NoYXJ0T2ZBY2NvdW50JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlICgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnY29kZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignbGVkZ2VyJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIENoYXJ0T2ZBY2NvdW50OjpzZWxlY3QoJ2NoYXJ0X29mX2FjY291bnRzLm5hbWUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignY2hhcnRfb2ZfYWNjb3VudHMuaWQnLCAnYmFua19hY2NvdW50cy5jaGFydF9vZl9hY2NvdW50X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjb21wYW5pZXMnLCBmdW5jdGlvbiAoJGJhbmtBY2NvdW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkYmFua0FjY291bnQtPmNoYXJ0T2ZBY2NvdW50LT5jb2RlKSA/ICRiYW5rQWNjb3VudC0+Y2hhcnRPZkFjY291bnQtPmNvbXBhbmllcy0+cGx1Y2soJ2NvbXBhbnkuY29kZScpLT5pbXBsb2RlKCcsICcpICA6ICcnOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2NvbXBhbmllcycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdjaGFydE9mQWNjb3VudC5jb21wYW5pZXMuY29tcGFueScsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSAoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2NvZGUnLCAnTElLRScsICclJyAuICRrZXl3b3JkIC4gJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdjb21wYW5pZXMnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgQ2hhcnRPZkFjY291bnQ6OnNlbGVjdCgnY29tcGFuaWVzLmNvZGUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdjb21wYW5pZXMnLCAnY29tcGFuaWVzLmlkJywgJz0nLCAnY2hhcnRfb2ZfYWNjb3VudF9jb21wYW5pZXMuY29tcGFueV9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2NoYXJ0X29mX2FjY291bnRfY29tcGFuaWVzJywgJ2NoYXJ0X29mX2FjY291bnRfY29tcGFuaWVzLmNoYXJ0X29mX2FjY291bnRfaWQnLCAnPScsICdjaGFydF9vZl9hY2NvdW50cy5pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdjaGFydF9vZl9hY2NvdW50cy5pZCcsICdiYW5rX2FjY291bnRzLmNoYXJ0X29mX2FjY291bnRfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignc3RhdHVzJywgZnVuY3Rpb24gKCRiYW5rQWNjb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmFwcHJvdmFsLXN0YWdlJywgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29iamVjdCcgPT4gJGJhbmtBY2NvdW50CiAgICAgICAgICAgICAgICAgICAgICAgIF0pLT5yZW5kZXIoKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24gKCRiYW5rQWNjb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyA9ICcnOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aCgpLT51c2VyKCktPmhhc1Blcm1pc3Npb25UbygnYmFuay1hY2NvdW50LWVkaXQnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoJGJhbmtBY2NvdW50LT5zdGF0dXMgPT0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnMgLj0gJzxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1zdWNjZXNzIiBkYXRhLWlkPSInLiRiYW5rQWNjb3VudC0+aWQuJyIgZGF0YS10YWJsZT0iJy4kYmFua0FjY291bnQtPmdldFRhYmxlKCkuJyIgb25jbGljaz0idG9nZ2xlU3RhdHVzKCQodGhpcykpIj48aSBjbGFzcz0ibGEgbGEtY2hlY2siPjwvaT48L2E+Jm5ic3A7JzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLWRhbmdlciIgZGF0YS1pZD0iJy4kYmFua0FjY291bnQtPmlkLiciIGRhdGEtdGFibGU9IicuJGJhbmtBY2NvdW50LT5nZXRUYWJsZSgpLiciIG9uY2xpY2s9InRvZ2dsZVN0YXR1cygkKHRoaXMpKSI+PGkgY2xhc3M9ImxhIGxhLWNoZWNrIj48L2k+PC9hPiZuYnNwOyc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb25zIC49ICc8YSBjbGFzcz0iYnRuIGJ0bi14cyBidG4tcHJpbWFyeSIgaHJlZj0iJyAuIHVybCgnYWNjb3VudGluZy9iYW5rLWFjY291bnRzLycgLiAkYmFua0FjY291bnQtPmlkIC4gJy9lZGl0JykgLiAnIj48aSBjbGFzcz0ibGEgbGEtZWRpdCI+PC9pPjwvYT4mbmJzcDsnOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXV0aCgpLT51c2VyKCktPmhhc1Blcm1pc3Npb25UbygnYmFuay1hY2NvdW50LWRlbGV0ZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWN0aW9ucyAuPSAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLWRhbmdlciIgb25jbGljaz0iZGVsZXRlRnJvbUNSVUQoJCh0aGlzKSkiIGRhdGEtc3JjPSInIC4gcm91dGUoJ2FjY291bnRpbmcuYmFuay1hY2NvdW50cy5kZXN0cm95JywgJGJhbmtBY2NvdW50LT5pZCkgLiAnIj48aSBjbGFzcz0ibGEgbGEtdHJhc2giPjwvaT48L2E+Jm5ic3A7JzsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgJGFjdGlvbnMgLj0gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmFwcHJvdmFsJywgWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29iamVjdCcgPT4gJGJhbmtBY2NvdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RhYmxlJyA9PiAnYmFua19hY2NvdW50cycKICAgICAgICAgICAgICAgICAgICAgICAgXSktPnJlbmRlcigpOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRhY3Rpb25zOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFsnc3RhdHVzJywgJ2FjdGlvbnMnLCAndHlwZSddKQogICAgICAgICAgICAgICAgICAgIC0+dG9Kc29uKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuYmFua0FjY291bnRzLmluZGV4JywgWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnQmFuayBBY2NvdW50cycsCiAgICAgICAgICAgICAgICAnaGVhZGVyQ29sdW1ucycgPT4gJHRoaXMtPmhlYWRlckNvbHVtbnMoKQogICAgICAgICAgICBdKTsKICAgICAgICB9IGNhdGNoIChcVGhyb3dhYmxlICR0aCkgewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gY3JlYXRlKCkKICAgIHsKICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygnZ2V0LWNvYScpKXsKICAgICAgICAgICAgcmV0dXJuIGNoYXJ0T2ZBY2NvdW50c09wdGlvbnMoW10sIHJlcXVlc3QoKS0+Z2V0KCdjaG9zZW4nKSwgMCwgZ2V0QWxsR3JvdXBBbmRMZWRnZXJzKGZhbHNlLCBmYWxzZSwgWzEsIDIsIDNdKSwgZmFsc2UsICcnLCBmYWxzZSwgW3JlcXVlc3QoKS0+Z2V0KCdjb21wYW55X2lkJyldKTsKICAgICAgICB9CgogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAndGl0bGUnID0+ICdOZXcgQmFuayBBY2NvdW50JywKICAgICAgICAgICAgJ2NvZGUnID0+IHVuaXF1ZUNvZGVXaXRob3V0UHJlZml4KDIsICdiYW5rX2FjY291bnRzJywgJ2NvZGUnKSwKICAgICAgICAgICAgJ2N1cnJlbmN5VHlwZXMnID0+IEN1cnJlbmN5VHlwZTo6d2l0aChbJ2N1cnJlbmNpZXMnXSktPmdldCgpLAogICAgICAgICAgICAnYmFua0FjY291bnRUeXBlcycgPT4gQmFua0FjY291bnRUeXBlOjphbGwoKSwKICAgICAgICAgICAgJ2JhbmtzJyA9PiBCYW5rOjp3aXRoKFsnYnJhbmNoZXMnXSktPmdldCgpLAogICAgICAgICAgICAnYWNjb3VudERlZmF1bHRTZXR0aW5ncycgPT4gYWNjb3VudERlZmF1bHRTZXR0aW5ncygpLAogICAgICAgICAgICAnY29tcGFuaWVzJyA9PiBDb21wYW55OjpoYXMoJ3Byb2ZpdENlbnRyZXMuY29zdENlbnRyZXMnKQogICAgICAgICAgICAtPndoZXJlSGFzKCd1c2VycycsIGZ1bmN0aW9uKCRxdWVyeSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgndXNlcl9pZCcsIGF1dGgoKS0+dXNlcigpLT5pZCk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC0+Z2V0KCksCiAgICAgICAgXTsKCiAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5iYW5rQWNjb3VudHMuY3JlYXRlJywgJGRhdGEpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzdG9yZShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICRyZXF1ZXN0LT52YWxpZGF0ZShbCiAgICAgICAgICAgICdjb2RlJyA9PiAncmVxdWlyZWR8dW5pcXVlOmJhbmtfYWNjb3VudHMnLAogICAgICAgICAgICAnYmFua19hY2NvdW50X3R5cGVfaWQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICduYW1lJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnbnVtYmVyJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnYmFua19icmFuY2hfaWQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdjaGFydF9vZl9hY2NvdW50X2lkJyA9PiBbJ3JlcXVpcmVkJ10sCiAgICAgICAgICAgICdjdXJyZW5jeV9pZCcgPT4gWydyZXF1aXJlZCddLAogICAgICAgIF0pOwoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRiYW5rX2FjY291bnQgPSBCYW5rQWNjb3VudDo6Y3JlYXRlKCRyZXF1ZXN0LT5hbGwoKSk7CiAgICAgICAgICAgIHJldmlld1N0YXR1cygkYmFua19hY2NvdW50KTsKCiAgICAgICAgICAgIC8qJGxlZGdlckdyb3VwID0gJHRoaXMtPmdldExlZGdlckdyb3VwKCRiYW5rX2FjY291bnQpOwogICAgICAgICAgICBzYXZlR0xGb3JPYmplY3RzKCRiYW5rX2FjY291bnQsICRiYW5rX2FjY291bnQtPmNoYXJ0T2ZBY2NvdW50LCAkcmVxdWVzdCwgJ2NoYXJ0X29mX2FjY291bnRfaWQnLCAkbGVkZ2VyR3JvdXApOyovCiAgICAgICAgICAgIC8vIHNhdmVHTEZvck9iamVjdHMoJGJhbmtfYWNjb3VudCwgJGJhbmtfYWNjb3VudC0+YmFua0NoYXJnZXNBY2NvdW50LCAkcmVxdWVzdCwgJ2JhbmtfY2hhcmdlc19hY2NvdW50JywgJGxlZGdlckdyb3VwKTsKCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5yZWRpcmVjdEJhY2tXaXRoU3VjY2VzcygiQmFuayBBY2NvdW50IGhhcyBiZWVuIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5IiwgJ2FjY291bnRpbmcuYmFuay1hY2NvdW50cy5pbmRleCcpOwogICAgICAgIH0gY2F0Y2ggKFxUaHJvd2FibGUgJHRoKSB7CiAgICAgICAgICAgIERCOjpyb2xsQmFjaygpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0TGVkZ2VyR3JvdXAoJGJhbmtfYWNjb3VudCkKICAgIHsKICAgICAgICAkcGFyZW50ID0gQWNjb3VudEdyb3VwOjpmaW5kKGFjY291bnREZWZhdWx0U2V0dGluZ3MoKVsnYmFua19hY2NvdW50X2dyb3VwJ10pOwogICAgICAgIGlmIChpc3NldCgkcGFyZW50LT5pZCkpIHsKICAgICAgICAgICAgJHBhcmVudEdyb3VwID0gQWNjb3VudEdyb3VwOjp3aGVyZShbCiAgICAgICAgICAgICAgICAncGFyZW50X2lkJyA9PiAkcGFyZW50LT5pZCwKICAgICAgICAgICAgICAgICduYW1lJyA9PiB0cmltKGJhbmtBY2NvdW50VHlwZXMoKVskYmFua19hY2NvdW50LT50eXBlXVsnbmFtZSddKSwKICAgICAgICAgICAgXSktPmZpcnN0KCk7CiAgICAgICAgICAgIGlmICghaXNzZXQoJHBhcmVudEdyb3VwLT5pZCkpIHsKICAgICAgICAgICAgICAgICRwYXJlbnRHcm91cCA9IEFjY291bnRHcm91cDo6Y3JlYXRlKFsKICAgICAgICAgICAgICAgICAgICAncGFyZW50X2lkJyA9PiAkcGFyZW50LT5pZCwKICAgICAgICAgICAgICAgICAgICAnY29kZScgPT4gdW5pcXVlQ29kZVdpdGhvdXRQcmVmaXgoNCwgJ2FjY291bnRfZ3JvdXBzJywgJ2lkJyksCiAgICAgICAgICAgICAgICAgICAgJ25hbWUnID0+IHRyaW0oYmFua0FjY291bnRUeXBlcygpWyRiYW5rX2FjY291bnQtPnR5cGVdWyduYW1lJ10pLAogICAgICAgICAgICAgICAgICAgICdhY2NvdW50X2NsYXNzX2lkJyA9PiAkcGFyZW50LT5hY2NvdW50X2NsYXNzX2lkLAogICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRncm91cCA9IEFjY291bnRHcm91cDo6d2hlcmUoWwogICAgICAgICAgICAgICAgJ3BhcmVudF9pZCcgPT4gJHBhcmVudEdyb3VwLT5pZCwKICAgICAgICAgICAgICAgICduYW1lJyA9PiAkYmFua19hY2NvdW50LT5iYW5rX25hbWUsCiAgICAgICAgICAgIF0pLT5maXJzdCgpOwogICAgICAgICAgICBpZiAoIWlzc2V0KCRncm91cC0+aWQpKSB7CiAgICAgICAgICAgICAgICAkZ3JvdXAgPSBBY2NvdW50R3JvdXA6OmNyZWF0ZShbCiAgICAgICAgICAgICAgICAgICAgJ3BhcmVudF9pZCcgPT4gJHBhcmVudEdyb3VwLT5pZCwKICAgICAgICAgICAgICAgICAgICAnY29kZScgPT4gdW5pcXVlQ29kZVdpdGhvdXRQcmVmaXgoNCwgJ2FjY291bnRfZ3JvdXBzJywgJ2lkJyksCiAgICAgICAgICAgICAgICAgICAgJ25hbWUnID0+ICRiYW5rX2FjY291bnQtPmJhbmtfbmFtZSwKICAgICAgICAgICAgICAgICAgICAnYWNjb3VudF9jbGFzc19pZCcgPT4gJHBhcmVudEdyb3VwLT5hY2NvdW50X2NsYXNzX2lkLAogICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiAkZ3JvdXAtPmlkOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzaG93KCRpZCkKICAgIHsKCiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGVkaXQoJGlkKQogICAgewogICAgICAgICRiYW5rQWNjb3VudCA9IEJhbmtBY2NvdW50Ojp3aXRoKFsKICAgICAgICAgICAgJ2NoYXJ0T2ZBY2NvdW50LmNvbXBhbmllcycsCiAgICAgICAgICAgICdiYW5rQ2hhcmdlc0FjY291bnQnCiAgICAgICAgXSktPmZpbmRPckZhaWwoJGlkKTsKCiAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICd0aXRsZScgPT4gJ0VkaXQgQmFuayBBY2NvdW50JywKICAgICAgICAgICAgJ2JhbmtBY2NvdW50JyA9PiAkYmFua0FjY291bnQsCiAgICAgICAgICAgICdjdXJyZW5jeVR5cGVzJyA9PiBDdXJyZW5jeVR5cGU6OndpdGgoWydjdXJyZW5jaWVzJ10pLT5nZXQoKSwKICAgICAgICAgICAgJ2JhbmtBY2NvdW50VHlwZXMnID0+IEJhbmtBY2NvdW50VHlwZTo6YWxsKCksCiAgICAgICAgICAgICdiYW5rcycgPT4gQmFuazo6d2l0aChbJ2JyYW5jaGVzJ10pLT5nZXQoKSwKICAgICAgICAgICAgJ2NvbXBhbmllcycgPT4gQ29tcGFueTo6aGFzKCdwcm9maXRDZW50cmVzLmNvc3RDZW50cmVzJykKICAgICAgICAgICAgLT53aGVyZUhhcygndXNlcnMnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ3VzZXJfaWQnLCBhdXRoKCktPnVzZXIoKS0+aWQpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAtPmdldCgpLAogICAgICAgICAgICAnY2hhcnRPZkFjY291bnRzT3B0aW9ucycgPT4gY2hhcnRPZkFjY291bnRzT3B0aW9ucyhbXSwgJGJhbmtBY2NvdW50LT5jaGFydF9vZl9hY2NvdW50X2lkLCAwLCBnZXRBbGxHcm91cEFuZExlZGdlcnMoZmFsc2UsIGZhbHNlLCBbMSwgMiwgM10pLCBmYWxzZSwgJycsIGZhbHNlLCBbJGJhbmtBY2NvdW50LT5jaGFydE9mQWNjb3VudC0+Y29tcGFuaWVzLT5maXJzdCgpLT5jb21wYW55X2lkXSksCiAgICAgICAgXTsKCiAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5iYW5rQWNjb3VudHMuZWRpdCcsICRkYXRhKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gdXBkYXRlKFJlcXVlc3QgJHJlcXVlc3QsICRpZCkKICAgIHsKICAgICAgICAkcmVxdWVzdC0+dmFsaWRhdGUoWwogICAgICAgICAgICAnY29kZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTpiYW5rX2FjY291bnRzLGNvZGUsJyAuICRpZCwKICAgICAgICAgICAgJ2JhbmtfYWNjb3VudF90eXBlX2lkJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnbmFtZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ251bWJlcicgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2JhbmtfYnJhbmNoX2lkJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnY2hhcnRfb2ZfYWNjb3VudF9pZCcgPT4gWydyZXF1aXJlZCddLAogICAgICAgICAgICAnY3VycmVuY3lfaWQnID0+IFsncmVxdWlyZWQnXSwKICAgICAgICBdKTsKCiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnkgewogICAgICAgICAgICAkYmFua19hY2NvdW50ID0gQmFua0FjY291bnQ6OmZpbmQoJGlkKTsKICAgICAgICAgICAgJGJhbmtfYWNjb3VudC0+ZmlsbCgkcmVxdWVzdC0+YWxsKCkpOwogICAgICAgICAgICAkYmFua19hY2NvdW50LT5zYXZlKCk7CiAgICAgICAgICAgIHJldmlld1N0YXR1cygkYmFua19hY2NvdW50KTsKCiAgICAgICAgICAgIC8qJGxlZGdlckdyb3VwID0gJHRoaXMtPmdldExlZGdlckdyb3VwKCRiYW5rX2FjY291bnQpOwogICAgICAgICAgICBzYXZlR0xGb3JPYmplY3RzKCRiYW5rX2FjY291bnQsICRiYW5rX2FjY291bnQtPmNoYXJ0T2ZBY2NvdW50LCAkcmVxdWVzdCwgJ2NoYXJ0X29mX2FjY291bnRfaWQnLCAkbGVkZ2VyR3JvdXApOyovCiAgICAgICAgICAgIC8vIHNhdmVHTEZvck9iamVjdHMoJGJhbmtfYWNjb3VudCwgJGJhbmtfYWNjb3VudC0+YmFua0NoYXJnZXNBY2NvdW50LCAkcmVxdWVzdCwgJ2JhbmtfY2hhcmdlc19hY2NvdW50JywgJGxlZGdlckdyb3VwKTsKCiAgICAgICAgICAgIFxEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+cmVkaXJlY3RCYWNrV2l0aFN1Y2Nlc3MoIkJhbmsgQWNjb3VudCBoYXMgYmVlbiB1cGRhdGVkIHN1Y2Nlc3NmdWxseSIsICdhY2NvdW50aW5nLmJhbmstYWNjb3VudHMuaW5kZXgnKTsKICAgICAgICB9IGNhdGNoIChcVGhyb3dhYmxlICR0aCkgewogICAgICAgICAgICBcREI6OnJvbGxCYWNrKCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBkZXN0cm95KCRpZCkKICAgIHsKICAgICAgICBcREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnkgewogICAgICAgICAgICBCYW5rQWNjb3VudDo6ZmluZCgkaWQpLT5kZWxldGUoKTsKICAgICAgICAgICAgXERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIkJhbmsgQWNjb3VudCBoYXMgYmVlbiBEZWxldGVkISIKICAgICAgICAgICAgXSk7CiAgICAgICAgfSBjYXRjaCAoXFRocm93YWJsZSAkdGgpIHsKICAgICAgICAgICAgXERCOjpyb2xsQmFjaygpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJHRoLT5nZXRNZXNzYWdlKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfQogICAgfQp9Cg==