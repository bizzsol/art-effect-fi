<?php
bolt_decrypt( __FILE__ , 'Hz4fOU'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29tcGFueTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xQcm9maXRDZW50cmU7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29zdENlbnRyZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xBY2NvdW50R3JvdXA7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRmlzY2FsWWVhcjsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xFbnRyeVR5cGU7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcVGFnOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXENoYXJ0T2ZBY2NvdW50Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEVudHJ5SXRlbTsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ3VycmVuY3lUeXBlOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEN1cnJlbmN5Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEV4Y2hhbmdlUmF0ZTsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRmlzY2FsWWVhckNsb3Npbmc7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRmlzY2FsWWVhckNsb3NpbmdMZWRnZXI7Cgp1c2UgQXBwLCBEQiwgRGF0YVRhYmxlczsKdXNlIElsbHVtaW5hdGVcU3VwcG9ydFxGYWNhZGVzXEF1dGg7CgpjbGFzcyBCYWxhbmNlU2hlZXRDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7CiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkdGl0bGUgPSAnUmVwb3J0IC0gQmFsYW5jZSBTaGVldCc7CiAgICAgICAgICAgIAogICAgICAgICAgICAkZmlzY2FsWWVhciA9IGdldEFjdGl2ZUZpc2NhbFllYXIoKTsKICAgICAgICAgICAgJGFjY291bnREZWZhdWx0U2V0dGluZ3MgPSBhY2NvdW50RGVmYXVsdFNldHRpbmdzKCk7CiAgICAgICAgICAgICRzeXN0ZW1DdXJyZW5jeSA9IHN5c3RlbUN1cnJlbmN5KCk7CgogICAgICAgICAgICAkYXNzZXRzID0gJyc7CiAgICAgICAgICAgICRsaWFiaWxpdGllcyA9ICcnOwogICAgICAgICAgICAkZ3JvdXBXaXNlID0gZmFsc2U7CiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpKXsKCiAgICAgICAgICAgICAgICAkY3VycmVuY3lfaWQgPSByZXF1ZXN0KCktPmhhcygnY3VycmVuY3lfaWQnKSA/ICRyZXF1ZXN0LT5jdXJyZW5jeV9pZCA6IDA7CiAgICAgICAgICAgICAgICAkY29tcGFueV9pZCA9IHJlcXVlc3QoKS0+aGFzKCdjb21wYW55X2lkJykgPyAkcmVxdWVzdC0+Y29tcGFueV9pZCA6IDA7CiAgICAgICAgICAgICAgICAkcHJvZml0X2NlbnRyZV9pZCA9IHJlcXVlc3QoKS0+aGFzKCdwcm9maXRfY2VudHJlX2lkJykgPyAkcmVxdWVzdC0+cHJvZml0X2NlbnRyZV9pZCA6IDA7CiAgICAgICAgICAgICAgICAkY29zdF9jZW50cmVfaWQgPSByZXF1ZXN0KCktPmhhcygnY29zdF9jZW50cmVfaWQnKSA/ICRyZXF1ZXN0LT5jb3N0X2NlbnRyZV9pZCA6IDA7CiAgICAgICAgICAgICAgICAkZmlzY2FsX3llYXJfaWQgPSByZXF1ZXN0KCktPmhhcygnZmlzY2FsX3llYXJfaWQnKSA/ICRyZXF1ZXN0LT5maXNjYWxfeWVhcl9pZCA6IDA7CiAgICAgICAgICAgICAgICAkZmlzY2FsWWVhciA9IEZpc2NhbFllYXI6OmZpbmRPckZhaWwoJGZpc2NhbF95ZWFyX2lkKTsKICAgICAgICAgICAgICAgICRhbGwgPSBnZXRBbGxHcm91cEFuZExlZGdlcnMoZmFsc2UsIGZhbHNlLCBbMSwgMiwgM10sIFskY29tcGFueV9pZF0pOwoKICAgICAgICAgICAgICAgICRyYXRlID0gMTsKICAgICAgICAgICAgICAgIGlmKCRzeXN0ZW1DdXJyZW5jeS0+aWQgIT0gJGN1cnJlbmN5X2lkKXsKICAgICAgICAgICAgICAgICAgICAkcmF0ZXMgPSBnZXRFeGNoYW5nZVJhdGVzKCRzeXN0ZW1DdXJyZW5jeS0+aWQpOwogICAgICAgICAgICAgICAgICAgICRyYXRlID0gaXNzZXQoJHJhdGVzWydyYXRlcyddWyRjdXJyZW5jeV9pZF1bJ3JhdGUnXSkgPyAkcmF0ZXNbJ3JhdGVzJ11bJGN1cnJlbmN5X2lkXVsncmF0ZSddIDogMTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkZGViaXRFbnRyeUl0ZW1zID0gRW50cnlJdGVtOjpqb2luKCdlbnRyaWVzJywgJ2VudHJpZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5lbnRyeV9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2Nvc3RfY2VudHJlcycsICdjb3N0X2NlbnRyZXMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jb3N0X2NlbnRyZV9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ3Byb2ZpdF9jZW50cmVzJywgJ3Byb2ZpdF9jZW50cmVzLmlkJywgJz0nLCAnY29zdF9jZW50cmVzLnByb2ZpdF9jZW50cmVfaWQnKQoKICAgICAgICAgICAgICAgIC0+am9pbignY2hhcnRfb2ZfYWNjb3VudHMnLCAnY2hhcnRfb2ZfYWNjb3VudHMuaWQnLCAnPScsICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJykKICAgICAgICAgICAgICAgIC0+am9pbignYWNjb3VudF9ncm91cHMnLCAnYWNjb3VudF9ncm91cHMuaWQnLCAnPScsICdjaGFydF9vZl9hY2NvdW50cy5hY2NvdW50X2dyb3VwX2lkJykKCiAgICAgICAgICAgICAgICAtPndoZXJlSW4oJ2FjY291bnRfZ3JvdXBzLmFjY291bnRfY2xhc3NfaWQnLCBbMSwgMiwgM10pCgogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cmllcy5pc19hcHByb3ZlZCcsICdhcHByb3ZlZCcpCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmRhdGUnLCAnPj0nLCAkcmVxdWVzdC0+ZnJvbSkKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZGF0ZScsICc8PScsICRyZXF1ZXN0LT50bykKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuZmlzY2FsX3llYXJfaWQnLCAkZmlzY2FsX3llYXJfaWQpCiAgICAgICAgICAgICAgICAtPndoZXJlKCdwcm9maXRfY2VudHJlcy5jb21wYW55X2lkJywgJGNvbXBhbnlfaWQpCgogICAgICAgICAgICAgICAgLT53aGVuKCRwcm9maXRfY2VudHJlX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHByb2ZpdF9jZW50cmVfaWQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjb3N0X2NlbnRyZXMucHJvZml0X2NlbnRyZV9pZCcsICRwcm9maXRfY2VudHJlX2lkKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPndoZW4oJGNvc3RfY2VudHJlX2lkID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGNvc3RfY2VudHJlX2lkKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZW50cnlfaXRlbXMuY29zdF9jZW50cmVfaWQnLCAkY29zdF9jZW50cmVfaWQpOwogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyeV9pdGVtcy5kZWJpdF9jcmVkaXQnLCAnRCcpCgogICAgICAgICAgICAgICAgLT5ncm91cEJ5KCdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJykKCiAgICAgICAgICAgICAgICAtPndoZXJlTnVsbCgnZW50cmllcy5kZWxldGVkX2F0JykKICAgICAgICAgICAgICAgIC0+d2hlcmVOdWxsKCdlbnRyeV9pdGVtcy5kZWxldGVkX2F0JykKICAgICAgICAgICAgICAgIC0+d2hlcmVOdWxsKCdjaGFydF9vZl9hY2NvdW50cy5kZWxldGVkX2F0JykKCiAgICAgICAgICAgICAgICAtPmdldChbCiAgICAgICAgICAgICAgICAgICAgJ2FjY291bnRfZ3JvdXBzLmFjY291bnRfY2xhc3NfaWQnLAogICAgICAgICAgICAgICAgICAgICdlbnRyeV9pdGVtcy5jaGFydF9vZl9hY2NvdW50X2lkJywKICAgICAgICAgICAgICAgICAgICBEQjo6cmF3KCdzdW0oZW50cnlfaXRlbXMucmVwb3J0aW5nX2Ftb3VudCkgYXMgcmVwb3J0aW5nX2Ftb3VudCcpCiAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICAkY3JlZGl0RW50cnlJdGVtcyA9IEVudHJ5SXRlbTo6am9pbignZW50cmllcycsICdlbnRyaWVzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuZW50cnlfaWQnKQogICAgICAgICAgICAgICAgLT5qb2luKCdjb3N0X2NlbnRyZXMnLCAnY29zdF9jZW50cmVzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuY29zdF9jZW50cmVfaWQnKQogICAgICAgICAgICAgICAgLT5qb2luKCdwcm9maXRfY2VudHJlcycsICdwcm9maXRfY2VudHJlcy5pZCcsICc9JywgJ2Nvc3RfY2VudHJlcy5wcm9maXRfY2VudHJlX2lkJykKCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2NoYXJ0X29mX2FjY291bnRzJywgJ2NoYXJ0X29mX2FjY291bnRzLmlkJywgJz0nLCAnZW50cnlfaXRlbXMuY2hhcnRfb2ZfYWNjb3VudF9pZCcpCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2FjY291bnRfZ3JvdXBzJywgJ2FjY291bnRfZ3JvdXBzLmlkJywgJz0nLCAnY2hhcnRfb2ZfYWNjb3VudHMuYWNjb3VudF9ncm91cF9pZCcpCgogICAgICAgICAgICAgICAgLT53aGVyZUluKCdhY2NvdW50X2dyb3Vwcy5hY2NvdW50X2NsYXNzX2lkJywgWzEsIDIsIDNdKQoKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJpZXMuaXNfYXBwcm92ZWQnLCAnYXBwcm92ZWQnKQogICAgICAgICAgICAgICAgLT53aGVyZSgnZW50cmllcy5kYXRlJywgJz49JywgJHJlcXVlc3QtPmZyb20pCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmRhdGUnLCAnPD0nLCAkcmVxdWVzdC0+dG8pCiAgICAgICAgICAgICAgICAtPndoZXJlKCdlbnRyaWVzLmZpc2NhbF95ZWFyX2lkJywgJGZpc2NhbF95ZWFyX2lkKQogICAgICAgICAgICAgICAgLT53aGVyZSgncHJvZml0X2NlbnRyZXMuY29tcGFueV9pZCcsICRjb21wYW55X2lkKQoKICAgICAgICAgICAgICAgIC0+d2hlbigkcHJvZml0X2NlbnRyZV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRwcm9maXRfY2VudHJlX2lkKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnY29zdF9jZW50cmVzLnByb2ZpdF9jZW50cmVfaWQnLCAkcHJvZml0X2NlbnRyZV9pZCk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT53aGVuKCRjb3N0X2NlbnRyZV9pZCA+IDAsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRjb3N0X2NlbnRyZV9pZCl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2VudHJ5X2l0ZW1zLmNvc3RfY2VudHJlX2lkJywgJGNvc3RfY2VudHJlX2lkKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0+d2hlcmUoJ2VudHJ5X2l0ZW1zLmRlYml0X2NyZWRpdCcsICdDJykKCiAgICAgICAgICAgICAgICAtPmdyb3VwQnkoJ2VudHJ5X2l0ZW1zLmNoYXJ0X29mX2FjY291bnRfaWQnKQoKICAgICAgICAgICAgICAgIC0+d2hlcmVOdWxsKCdlbnRyaWVzLmRlbGV0ZWRfYXQnKQogICAgICAgICAgICAgICAgLT53aGVyZU51bGwoJ2VudHJ5X2l0ZW1zLmRlbGV0ZWRfYXQnKQogICAgICAgICAgICAgICAgLT53aGVyZU51bGwoJ2NoYXJ0X29mX2FjY291bnRzLmRlbGV0ZWRfYXQnKQoKICAgICAgICAgICAgICAgIC0+Z2V0KFsKICAgICAgICAgICAgICAgICAgICAnYWNjb3VudF9ncm91cHMuYWNjb3VudF9jbGFzc19pZCcsCiAgICAgICAgICAgICAgICAgICAgJ2VudHJ5X2l0ZW1zLmNoYXJ0X29mX2FjY291bnRfaWQnLAogICAgICAgICAgICAgICAgICAgIERCOjpyYXcoJ3N1bShlbnRyeV9pdGVtcy5yZXBvcnRpbmdfYW1vdW50KSBhcyByZXBvcnRpbmdfYW1vdW50JykKICAgICAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgICAgICRjYXJyeUZvcndhcmRlZCA9IEZpc2NhbFllYXJDbG9zaW5nTGVkZ2VyOjpqb2luKCdmaXNjYWxfeWVhcl9jbG9zaW5ncycsICdmaXNjYWxfeWVhcl9jbG9zaW5ncy5pZCcsICc9JywgJ2Zpc2NhbF95ZWFyX2Nsb3NpbmdfbGVkZ2Vycy5maXNjYWxfeWVhcl9jbG9zaW5nX2lkJykKCiAgICAgICAgICAgICAgICAtPmpvaW4oJ2NoYXJ0X29mX2FjY291bnRzJywgJ2NoYXJ0X29mX2FjY291bnRzLmlkJywgJz0nLCAnZmlzY2FsX3llYXJfY2xvc2luZ19sZWRnZXJzLmNoYXJ0X29mX2FjY291bnRfaWQnKQogICAgICAgICAgICAgICAgLT5qb2luKCdhY2NvdW50X2dyb3VwcycsICdhY2NvdW50X2dyb3Vwcy5pZCcsICc9JywgJ2NoYXJ0X29mX2FjY291bnRzLmFjY291bnRfZ3JvdXBfaWQnKQoKICAgICAgICAgICAgICAgIC0+d2hlcmVJbignYWNjb3VudF9ncm91cHMuYWNjb3VudF9jbGFzc19pZCcsIFsxLCAyLCAzXSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgLT53aGVyZSgnZmlzY2FsX3llYXJfY2xvc2luZ3MuY29tcGFueV9pZCcsICRjb21wYW55X2lkKQogICAgICAgICAgICAgICAgLT53aGVyZSgnZmlzY2FsX3llYXJfY2xvc2luZ3MudG9fZmlzY2FsX3llYXJfaWQnLCAkZmlzY2FsWWVhci0+aWQpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIC0+Z3JvdXBCeSgnZmlzY2FsX3llYXJfY2xvc2luZ19sZWRnZXJzLmNoYXJ0X29mX2FjY291bnRfaWQnKQoKICAgICAgICAgICAgICAgIC0+d2hlcmVOdWxsKCdjaGFydF9vZl9hY2NvdW50cy5kZWxldGVkX2F0JykKCiAgICAgICAgICAgICAgICAtPmdldChbCiAgICAgICAgICAgICAgICAgICAgJ2FjY291bnRfZ3JvdXBzLmFjY291bnRfY2xhc3NfaWQnLAogICAgICAgICAgICAgICAgICAgICdmaXNjYWxfeWVhcl9jbG9zaW5nX2xlZGdlcnMuY2hhcnRfb2ZfYWNjb3VudF9pZCcsCiAgICAgICAgICAgICAgICAgICAgREI6OnJhdygnc3VtKGZpc2NhbF95ZWFyX2Nsb3NpbmdfbGVkZ2Vycy5jYXJyeV9mb3J3YXJkaW5nX2Ftb3VudCkgYXMgY2FycnlfZm9yd2FyZGluZ19hbW91bnQnKQogICAgICAgICAgICAgICAgXSk7CgogICAgICAgICAgICAgICAgJGFzc2V0R3JvdXBzID0gQWNjb3VudEdyb3VwOjpkb2VzbnRIYXZlKCdwYXJlbnQnKS0+d2hlcmVJbignYWNjb3VudF9jbGFzc19pZCcsIFsxXSktPmdldCgpOwogICAgICAgICAgICAgICAgJGxpYWJpbGl0eUdyb3VwcyA9IEFjY291bnRHcm91cDo6ZG9lc250SGF2ZSgncGFyZW50JyktPndoZXJlSW4oJ2FjY291bnRfY2xhc3NfaWQnLCBbMiwgM10pLT5nZXQoKTsKCiAgICAgICAgICAgICAgICAkYXNzZXRCYWxhbmNlcyA9IFtdOwogICAgICAgICAgICAgICAgJGxpYWJpbGl0eUJhbGFuY2VzID0gW107CgogICAgICAgICAgICAgICAgJGdyb3VwV2lzZSA9ICgkcmVxdWVzdC0+Z3JvdXBfd2lzZSA9PSAxKTsKICAgICAgICAgICAgICAgIGlmKCRncm91cFdpc2UpewogICAgICAgICAgICAgICAgICAgIGlmKCRhc3NldEdyb3Vwcy0+Y291bnQoKSA+IDApewogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKCRhc3NldEdyb3VwcyBhcyAka2V5ID0+ICRncm91cCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzIC49ICc8dHIgY2xhc3M9Imdyb3VwLScuJGdyb3VwLT5pZC4nIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PHN0cm9uZz4nLiRncm91cC0+Y29kZS4nPC9zdHJvbmc+PC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PHN0cm9uZz4nLiRncm91cC0+bmFtZS4nPC9zdHJvbmc+PC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0IiBjbGFzcz0iY2xvc2luZ19iYWxhbmNlX2NvbHVtbiI+PHN0cm9uZz4nLnN5c3RlbU1vbmV5Rm9ybWF0KGdyb3VwQ2xvc2luZ0JhbGFuY2UoJGdyb3VwLCBbJ0QnID0+ICRkZWJpdEVudHJ5SXRlbXMsICdDJyA9PiAkY3JlZGl0RW50cnlJdGVtc10sICRhbGwsICRjYXJyeUZvcndhcmRlZCwgJHJhdGUpWydiYWxhbmNlJ10pLic8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4nOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhc3NldHMgLj0gYmFsYW5jZVNoZWV0KCRjb21wYW55X2lkLCRncm91cCwgJHJlcXVlc3QtPmZyb20sICRyZXF1ZXN0LT50bywgMCwgIShyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiAkcmVxdWVzdC0+cmVwb3J0X3R5cGUgPT0gJ3BkZicpLCBbJ0QnID0+ICRkZWJpdEVudHJ5SXRlbXMsICdDJyA9PiAkY3JlZGl0RW50cnlJdGVtc10sICRhbGwsICRjYXJyeUZvcndhcmRlZCwgJHJhdGUpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRhc3NldHMgLj0gJzx0cj4KICAgICAgICAgICAgICAgICAgICAgICAgPHRkIGNvbHNwYW49IjIiPjxzdHJvbmc+VG90YWwgJy4kYXNzZXRHcm91cHMtPnBsdWNrKCduYW1lJyktPmltcGxvZGUoJywgJykuJzo8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0Ij48c3Ryb25nPicuc3lzdGVtTW9uZXlGb3JtYXQoKCRkZWJpdEVudHJ5SXRlbXMtPndoZXJlSW4oJ2FjY291bnRfY2xhc3NfaWQnLCBbMV0pLT5zdW0oJ3JlcG9ydGluZ19hbW91bnQnKS0kY3JlZGl0RW50cnlJdGVtcy0+d2hlcmVJbignYWNjb3VudF9jbGFzc19pZCcsIFsxXSktPnN1bSgncmVwb3J0aW5nX2Ftb3VudCcpKyRjYXJyeUZvcndhcmRlZC0+d2hlcmVJbignYWNjb3VudF9jbGFzc19pZCcsIFsxXSktPnN1bSgnY2FycnlfZm9yd2FyZGluZ19hbW91bnQnKSkpLic8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgIDwvdHI+JzsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICRjaGFydE9mQWNjb3VudHMgPSBDaGFydE9mQWNjb3VudDo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgICAgICdhY2NvdW50R3JvdXAuYWNjb3VudENsYXNzJwogICAgICAgICAgICAgICAgICAgIF0pCiAgICAgICAgICAgICAgICAgICAgLT53aGVyZUhhcygnYWNjb3VudEdyb3VwJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVJbignYWNjb3VudF9jbGFzc19pZCcsIFsxXSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdjb21wYW5pZXMnLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkY29tcGFueV9pZCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjb21wYW55X2lkJywgJGNvbXBhbnlfaWQpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckJ5KCdjb2RlJywgJ2FzYycpCiAgICAgICAgICAgICAgICAgICAgLT5nZXQoKTsKICAgICAgICAgICAgICAgICAgICBpZigkY2hhcnRPZkFjY291bnRzLT5jb3VudCgpID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2goJGNoYXJ0T2ZBY2NvdW50cyBhcyAka2V5ID0+ICRhY2NvdW50KXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRiYWxhbmNlU2hlZXRMZWRnZXIgPSBiYWxhbmNlU2hlZXRMZWRnZXIoJGNvbXBhbnlfaWQsJGFjY291bnQsICRyZXF1ZXN0LT5mcm9tLCAkcmVxdWVzdC0+dG8sIDAsICEocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykgJiYgJHJlcXVlc3QtPnJlcG9ydF90eXBlID09ICdwZGYnKSwgWydEJyA9PiAkZGViaXRFbnRyeUl0ZW1zLCAnQycgPT4gJGNyZWRpdEVudHJ5SXRlbXNdLCAkYWxsLCAkY2FycnlGb3J3YXJkZWQsICRyYXRlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFzc2V0cyAuPSAkYmFsYW5jZVNoZWV0TGVkZ2VyWydkYXRhJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRhc3NldEJhbGFuY2VzLCAkYmFsYW5jZVNoZWV0TGVkZ2VyWydiYWxhbmNlJ10pOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAkYXNzZXRzIC49ICc8dHI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iMiI+PHN0cm9uZz5Ub3RhbCAnLiRhc3NldEdyb3Vwcy0+cGx1Y2soJ25hbWUnKS0+aW1wbG9kZSgnLCAnKS4nOjwvc3Ryb25nPjwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0Ij48c3Ryb25nPicuc3lzdGVtTW9uZXlGb3JtYXQoYXJyYXlfc3VtKCRhc3NldEJhbGFuY2VzKSkuJzwvc3Ryb25nPjwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDwvdHI+JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYoJGdyb3VwV2lzZSl7CiAgICAgICAgICAgICAgICAgICAgaWYoJGxpYWJpbGl0eUdyb3Vwcy0+Y291bnQoKSA+IDApewogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKCRsaWFiaWxpdHlHcm91cHMgYXMgJGtleSA9PiAkZ3JvdXApewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxpYWJpbGl0aWVzIC49ICc8dHIgY2xhc3M9Imdyb3VwLScuJGdyb3VwLT5pZC4nIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PHN0cm9uZz4nLiRncm91cC0+Y29kZS4nPC9zdHJvbmc+PC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQ+PHN0cm9uZz4nLiRncm91cC0+bmFtZS4nPC9zdHJvbmc+PC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgc3R5bGU9InRleHQtYWxpZ246IHJpZ2h0IiBjbGFzcz0iY2xvc2luZ19iYWxhbmNlX2NvbHVtbiI+PHN0cm9uZz4nLnN5c3RlbU1vbmV5Rm9ybWF0KGdyb3VwQ2xvc2luZ0JhbGFuY2UoJGdyb3VwLCBbJ0QnID0+ICRkZWJpdEVudHJ5SXRlbXMsICdDJyA9PiAkY3JlZGl0RW50cnlJdGVtc10sICRhbGwsICRjYXJyeUZvcndhcmRlZCwgJHJhdGUpWydiYWxhbmNlJ10pLic8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4nOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsaWFiaWxpdGllcyAuPSBiYWxhbmNlU2hlZXQoJGNvbXBhbnlfaWQsJGdyb3VwLCAkcmVxdWVzdC0+ZnJvbSwgJHJlcXVlc3QtPnRvLCAwLCAhKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmICRyZXF1ZXN0LT5yZXBvcnRfdHlwZSA9PSAncGRmJyksIFsnRCcgPT4gJGRlYml0RW50cnlJdGVtcywgJ0MnID0+ICRjcmVkaXRFbnRyeUl0ZW1zXSwgJGFsbCwgJGNhcnJ5Rm9yd2FyZGVkLCAkcmF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJGxpYWJpbGl0aWVzIC49ICc8dHI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBjb2xzcGFuPSIyIj48c3Ryb25nPlRvdGFsICcuJGxpYWJpbGl0eUdyb3Vwcy0+cGx1Y2soJ25hbWUnKS0+aW1wbG9kZSgnLCAnKS4nOjwvc3Ryb25nPjwvdGQ+CiAgICAgICAgICAgICAgICAgICAgICAgIDx0ZCBzdHlsZT0idGV4dC1hbGlnbjogcmlnaHQiPjxzdHJvbmc+Jy5zeXN0ZW1Nb25leUZvcm1hdCgoJGRlYml0RW50cnlJdGVtcy0+d2hlcmVJbignYWNjb3VudF9jbGFzc19pZCcsIFsyLCAzXSktPnN1bSgncmVwb3J0aW5nX2Ftb3VudCcpLSRjcmVkaXRFbnRyeUl0ZW1zLT53aGVyZUluKCdhY2NvdW50X2NsYXNzX2lkJywgWzIsIDNdKS0+c3VtKCdyZXBvcnRpbmdfYW1vdW50JykrJGNhcnJ5Rm9yd2FyZGVkLT53aGVyZUluKCdhY2NvdW50X2NsYXNzX2lkJywgWzIsIDNdKS0+c3VtKCdjYXJyeV9mb3J3YXJkaW5nX2Ftb3VudCcpKSkuJzwvc3Ryb25nPjwvdGQ+CiAgICAgICAgICAgICAgICAgICAgPC90cj4nOwogICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgJGNoYXJ0T2ZBY2NvdW50cyA9IENoYXJ0T2ZBY2NvdW50Ojp3aXRoKFsKICAgICAgICAgICAgICAgICAgICAgICAgJ2FjY291bnRHcm91cC5hY2NvdW50Q2xhc3MnCiAgICAgICAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdhY2NvdW50R3JvdXAnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUluKCdhY2NvdW50X2NsYXNzX2lkJywgWzIsIDNdKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJCeSgnY29kZScsICdhc2MnKS0+Z2V0KCk7CiAgICAgICAgICAgICAgICAgICAgaWYoJGNoYXJ0T2ZBY2NvdW50cy0+Y291bnQoKSA+IDApewogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKCRjaGFydE9mQWNjb3VudHMgYXMgJGtleSA9PiAkYWNjb3VudCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmFsYW5jZVNoZWV0TGVkZ2VyID0gYmFsYW5jZVNoZWV0TGVkZ2VyKCRjb21wYW55X2lkLCRhY2NvdW50LCAkcmVxdWVzdC0+ZnJvbSwgJHJlcXVlc3QtPnRvLCAwLCAhKHJlcXVlc3QoKS0+aGFzKCdyZXBvcnRfdHlwZScpICYmICRyZXF1ZXN0LT5yZXBvcnRfdHlwZSA9PSAncGRmJyksIFsnRCcgPT4gJGRlYml0RW50cnlJdGVtcywgJ0MnID0+ICRjcmVkaXRFbnRyeUl0ZW1zXSwgJGFsbCwgJGNhcnJ5Rm9yd2FyZGVkLCAkcmF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsaWFiaWxpdGllcyAuPSAkYmFsYW5jZVNoZWV0TGVkZ2VyWydkYXRhJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRsaWFiaWxpdHlCYWxhbmNlcywgJGJhbGFuY2VTaGVldExlZGdlclsnYmFsYW5jZSddKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgJGxpYWJpbGl0aWVzIC49ICc8dHI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dGQgY29sc3Bhbj0iMiI+PHN0cm9uZz5Ub3RhbCAnLiRsaWFiaWxpdHlHcm91cHMtPnBsdWNrKCduYW1lJyktPmltcGxvZGUoJywgJykuJzo8L3N0cm9uZz48L3RkPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRkIHN0eWxlPSJ0ZXh0LWFsaWduOiByaWdodCI+PHN0cm9uZz4nLnN5c3RlbU1vbmV5Rm9ybWF0KGFycmF5X3N1bSgkbGlhYmlsaXR5QmFsYW5jZXMpKS4nPC9zdHJvbmc+PC90ZD4KICAgICAgICAgICAgICAgICAgICAgICAgPC90cj4nOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGNvbXBhbmllcyA9IENvbXBhbnk6OmhhcygncHJvZml0Q2VudHJlcy5jb3N0Q2VudHJlcycpCiAgICAgICAgICAgIC0+d2hlcmVIYXMoJ3VzZXJzJywgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd1c2VyX2lkJywgYXV0aCgpLT51c2VyKCktPmlkKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT5nZXQoKTsKCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiByZXBvcnRUaXRsZShyZXF1ZXN0KCktPmFsbCgpLCAkdGl0bGUpLAogICAgICAgICAgICAgICAgJ2N1cnJlbmN5VHlwZXMnID0+IEN1cnJlbmN5VHlwZTo6d2l0aCgnY3VycmVuY2llcycpLT5nZXQoKSwKICAgICAgICAgICAgICAgICdjdXJyZW5jeScgPT4gQ3VycmVuY3k6OmZpbmQoJHJlcXVlc3QtPmN1cnJlbmN5X2lkKSwKICAgICAgICAgICAgICAgICdhc3NldEdyb3VwcycgPT4gaXNzZXQoJGFzc2V0R3JvdXBzKSA/ICRhc3NldEdyb3VwcyA6IFtdLAogICAgICAgICAgICAgICAgJ2xpYWJpbGl0eUdyb3VwcycgPT4gaXNzZXQoJGxpYWJpbGl0eUdyb3VwcykgPyAkbGlhYmlsaXR5R3JvdXBzIDogW10sCiAgICAgICAgICAgICAgICAnZ3JvdXBXaXNlJyA9PiAkZ3JvdXBXaXNlLAogICAgICAgICAgICAgICAgJ2Fzc2V0cycgPT4gJGFzc2V0cywKICAgICAgICAgICAgICAgICdsaWFiaWxpdGllcycgPT4gJGxpYWJpbGl0aWVzLAogICAgICAgICAgICAgICAgJ2Zpc2NhbFllYXInID0+ICRmaXNjYWxZZWFyLAogICAgICAgICAgICAgICAgJ2FjY291bnREZWZhdWx0U2V0dGluZ3MnID0+ICRhY2NvdW50RGVmYXVsdFNldHRpbmdzLAogICAgICAgICAgICAgICAgJ2NvbXBhbmllcycgPT4gJGNvbXBhbmllcywKICAgICAgICAgICAgICAgICdwcm9maXRDZW50cmVzJyA9PiBQcm9maXRDZW50cmU6OndoZXJlKCdjb21wYW55X2lkJywgJGNvbXBhbmllcy0+Zmlyc3QoKS0+aWQpLT5vcmRlckJ5KCdjb2RlJywgJ2FzYycpLT5nZXQoKSwKICAgICAgICAgICAgICAgICdmaXNjYWxZZWFycycgPT4gRmlzY2FsWWVhcjo6YWxsKCksCiAgICAgICAgICAgIF07CgogICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiAkcmVxdWVzdC0+cmVwb3J0X3R5cGUgPT0gJ3BkZicpewogICAgICAgICAgICAgICAgcmV0dXJuIHZpZXdNUERGKCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy5iYWxhbmNlU2hlZXQucGRmJywgJGRhdGEsICR0aXRsZSwgJHRpdGxlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYocmVxdWVzdCgpLT5oYXMoJ3JlcG9ydF90eXBlJykgJiYgJHJlcXVlc3QtPnJlcG9ydF90eXBlID09ICdyZXBvcnQnKXsKICAgICAgICAgICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMucmVwb3J0cy5iYWxhbmNlU2hlZXQucmVwb3J0JywgJGRhdGEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnJlcG9ydHMuYmFsYW5jZVNoZWV0LmluZGV4JywgJGRhdGEpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygncmVwb3J0X3R5cGUnKSAmJiAkcmVxdWVzdC0+cmVwb3J0X3R5cGUgPT0gJ3JlcG9ydCcpewogICAgICAgICAgICAgICAgcmV0dXJuICR0aC0+Z2V0TWVzc2FnZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJHRoLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KfQo=