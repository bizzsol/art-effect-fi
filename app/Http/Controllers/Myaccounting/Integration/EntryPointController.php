<?php
bolt_decrypt( __FILE__ , 'N9nbt5'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nXEludGVncmF0aW9uOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIEFwcCwgREIsIERhdGFUYWJsZXM7Cgp1c2UgXEFwcFxNb2RlbHNcSW50ZWdyYXRpb25cRW50cnlQb2ludDsKdXNlIFxBcHBcTW9kZWxzXEludGVncmF0aW9uXEVudHJ5UG9pbnRMZWRnZXI7CgpjbGFzcyBFbnRyeVBvaW50Q29udHJvbGxlciBleHRlbmRzIENvbnRyb2xsZXIKewoKICAgIC8qKgogICAgICogU2V0IGdsb2JhbCBkYXRhIHRhYmxlIGhlYWRlcnMuCiAgICAgKgogICAgICogQHJldHVybiBoZWFkZXJDb2x1bW5zCiAgICAgKi8KICAgICBwdWJsaWMgZnVuY3Rpb24gaGVhZGVyQ29sdW1ucygkdmFsdWU9JycpCiAgICAgewogICAgICAgIHJldHVybiBhcnJheSgKICAgICAgICAgICAgWydTTCcsICdTTCddLAogICAgICAgICAgICBbJ2NvZGUnLCAnY29kZScsXSwKICAgICAgICAgICAgWydzaG9ydF9uYW1lJywgJ3Nob3J0X25hbWUnXSwKICAgICAgICAgICAgWyduYW1lJywgJ25hbWUnXSwKICAgICAgICAgICAgWydkZXNjcmlwdGlvbicsICdkZXNjcmlwdGlvbiddLAogICAgICAgICAgICBbJ2RlYml0X2xlZGdlcnMnLCAnZGViaXRfbGVkZ2VycyddLAogICAgICAgICAgICBbJ2NyZWRpdF9sZWRnZXJzJywgJ2NyZWRpdF9sZWRnZXJzJ10sCiAgICAgICAgICAgIFsnYWN0aW9ucycsICdhY3Rpb25zJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGF0YWJsZXM6Om9mKAogICAgICAgICAgICAgICAgICAgIEVudHJ5UG9pbnQ6OndpdGgoWwogICAgICAgICAgICAgICAgICAgICAgICAnbGVkZ2Vycy5jaGFydE9mQWNjb3VudCcKICAgICAgICAgICAgICAgICAgICBdKS0+d2hlbighZGF0YXRhYmxlT3JkZXJpbmcoKSwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaWQnLCAnZGVzYycpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAtPmFkZEluZGV4Q29sdW1uKCkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdkZWJpdF9sZWRnZXJzJywgZnVuY3Rpb24oJHBvaW50KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHBvaW50LT5sZWRnZXJzLT53aGVyZSgndHlwZScsICdEJyktPnBsdWNrKCdjaGFydE9mQWNjb3VudC5uYW1lJyktPmltcGxvZGUoJywgJyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2NyZWRpdF9sZWRnZXJzJywgZnVuY3Rpb24oJHBvaW50KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHBvaW50LT5sZWRnZXJzLT53aGVyZSgndHlwZScsICdDJyktPnBsdWNrKCdjaGFydE9mQWNjb3VudC5uYW1lJyktPmltcGxvZGUoJywgJyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FjdGlvbnMnLCBmdW5jdGlvbigkcG9pbnQpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3MgbWwtMSIgb25jbGljaz0iZWRpdCgkKHRoaXMpKSIgZGF0YS1zcmM9IicudXJsKCdhY2NvdW50aW5nL2VudHJ5LXBvaW50cy8nLiRwb2ludC0+aWQuJy9lZGl0P2RlYml0cycpLiciPkRlYml0czwvYT48YSBjbGFzcz0iYnRuIGJ0bi14cyBidG4tZGFuZ2VyIG1sLTEiIG9uY2xpY2s9ImVkaXQoJCh0aGlzKSkiIGRhdGEtc3JjPSInLnVybCgnYWNjb3VudGluZy9lbnRyeS1wb2ludHMvJy4kcG9pbnQtPmlkLicvZWRpdD9jcmVkaXRzJykuJyI+Q3JlZGl0czwvYT48YnI+PGJyPjxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1wcmltYXJ5IG1sLTEiIG9uY2xpY2s9ImVkaXQoJCh0aGlzKSkiIGRhdGEtc3JjPSInLnVybCgnYWNjb3VudGluZy9lbnRyeS1wb2ludHMvJy4kcG9pbnQtPmlkLicvZWRpdCcpLiciPjxpIGNsYXNzPSJsYSBsYS1lZGl0Ij48L2k+PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1kYW5nZXIgbWwtMSIgb25jbGljaz0iZGVsZXRlRnJvbUNSVUQoJCh0aGlzKSkiIGRhdGEtc3JjPSInLiByb3V0ZSgnYWNjb3VudGluZy5lbnRyeS1wb2ludHMuZGVzdHJveScsICRwb2ludC0+aWQpLiciPjxpIGNsYXNzPSJsYSBsYS10cmFzaCI+PC9pPjwvYT4nOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbJ2FjdGlvbnMnXSkKICAgICAgICAgICAgICAgIC0+bWFrZSh0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICdMaXN0IG9mIEVudHJ5IFBvaW50cycsCiAgICAgICAgICAgICAgICAnaGVhZGVyQ29sdW1ucycgPT4gJHRoaXMtPmhlYWRlckNvbHVtbnMoKSwKICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ2FjY291bnRpbmcuYmFja2VuZC5wYWdlcy5pbnRlZ3JhdGlvbnMuZW50cnlQb2ludHMuaW5kZXgnLCAkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAndGl0bGUnID0+ICdOZXcgRW50cnkgUG9pbnQnLAogICAgICAgICAgICAnY29kZScgPT4gdW5pcXVlQ29kZVdpdGhvdXRQcmVmaXgoMiwnZW50cnlfcG9pbnRzJywnY29kZScpLAogICAgICAgIF07CgogICAgICAgIHJldHVybiB2aWV3KCdhY2NvdW50aW5nLmJhY2tlbmQucGFnZXMuaW50ZWdyYXRpb25zLmVudHJ5UG9pbnRzLmNyZWF0ZScsICRkYXRhKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkcmVxdWVzdC0+dmFsaWRhdGUoWwogICAgICAgICAgICAnY29kZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTplbnRyeV9wb2ludHMnLAogICAgICAgICAgICAnc2hvcnRfbmFtZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTplbnRyeV9wb2ludHMnLAogICAgICAgICAgICAnbmFtZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTplbnRyeV9wb2ludHMnLAogICAgICAgIF0pOwoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJGVudHJ5UG9pbnQgPSBFbnRyeVBvaW50OjpjcmVhdGUoJHJlcXVlc3QtPmFsbCgpKTsKCiAgICAgICAgICAgICRsZWRnZXJzID0gW107CiAgICAgICAgICAgIGlmKGlzc2V0KCRyZXF1ZXN0LT5kZWJpdF9sZWRnZXJzWzBdKSl7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkcmVxdWVzdC0+ZGViaXRfbGVkZ2VycyBhcyAka2V5ID0+ICRjaGFydF9vZl9hY2NvdW50X2lkKSB7CiAgICAgICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkbGVkZ2VycywgWwogICAgICAgICAgICAgICAgICAgICAgICAnZW50cnlfcG9pbnRfaWQnID0+ICRlbnRyeVBvaW50LT5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+ICRjaGFydF9vZl9hY2NvdW50X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgPT4gJ0QnLAogICAgICAgICAgICAgICAgICAgICAgICAnY3JlYXRlZF9ieScgPT4gYXV0aCgpLT51c2VyKCktPmlkLAogICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihpc3NldCgkcmVxdWVzdC0+Y3JlZGl0X2xlZGdlcnNbMF0pKXsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRyZXF1ZXN0LT5jcmVkaXRfbGVkZ2VycyBhcyAka2V5ID0+ICRjaGFydF9vZl9hY2NvdW50X2lkKSB7CiAgICAgICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkbGVkZ2VycywgWwogICAgICAgICAgICAgICAgICAgICAgICAnZW50cnlfcG9pbnRfaWQnID0+ICRlbnRyeVBvaW50LT5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+ICRjaGFydF9vZl9hY2NvdW50X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgPT4gJ0MnLAogICAgICAgICAgICAgICAgICAgICAgICAnY3JlYXRlZF9ieScgPT4gYXV0aCgpLT51c2VyKCktPmlkLAogICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihpc3NldCgkbGVkZ2Vyc1swXSkpewogICAgICAgICAgICAgICAgRW50cnlQb2ludExlZGdlcjo6aW5zZXJ0KCRsZWRnZXJzKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnJlZGlyZWN0QmFja1dpdGhTdWNjZXNzKCJFbnRyeSBQb2ludCBoYXMgYmVlbiBjcmVhdGVkIHN1Y2Nlc3NmdWxseSIsICdhY2NvdW50aW5nLmVudHJ5LXBvaW50cy5jcmVhdGUnKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBlZGl0KCRpZCkKICAgIHsKICAgICAgICAkZW50cnlQb2ludCA9IEVudHJ5UG9pbnQ6OndpdGgoWwogICAgICAgICAgICAnbGVkZ2VycycKICAgICAgICBdKS0+ZmluZE9yRmFpbCgkaWQpOwogICAgICAgICRhbGwgPSBnZXRBbGxHcm91cEFuZExlZGdlcnMoKTsKICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgJ3RpdGxlJyA9PiAnRWRpdCAnLiRlbnRyeVBvaW50LT5zaG9ydF9uYW1lLAogICAgICAgICAgICAnZGViaXRfbGVkZ2VycycgPT4gY2hhcnRPZkFjY291bnRzT3B0aW9ucyhbXSwgMCwgMCwgJGFsbCwgJGVudHJ5UG9pbnQtPmxlZGdlcnMtPndoZXJlKCd0eXBlJywgJ0QnKS0+cGx1Y2soJ2NoYXJ0X29mX2FjY291bnRfaWQnKS0+dG9BcnJheSgpKSwKICAgICAgICAgICAgJ2NyZWRpdF9sZWRnZXJzJyA9PiBjaGFydE9mQWNjb3VudHNPcHRpb25zKFtdLCAwLCAwLCAkYWxsLCAkZW50cnlQb2ludC0+bGVkZ2Vycy0+d2hlcmUoJ3R5cGUnLCAnQycpLT5wbHVjaygnY2hhcnRfb2ZfYWNjb3VudF9pZCcpLT50b0FycmF5KCkpLAogICAgICAgICAgICAnZW50cnlQb2ludCcgPT4gJGVudHJ5UG9pbnQKICAgICAgICBdOwoKICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmludGVncmF0aW9ucy5lbnRyeVBvaW50cy5lZGl0JywgJGRhdGEpOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGUoUmVxdWVzdCAkcmVxdWVzdCwgJGlkKQogICAgewogICAgICAgIGlmKCFyZXF1ZXN0KCktPmhhcygnZGViaXRzJykgJiYgcmVxdWVzdCgpLT5oYXMoJ2NyZWRpdCcpKXsKICAgICAgICAgICAgJHJlcXVlc3QtPnZhbGlkYXRlKFsKICAgICAgICAgICAgICAgICdzaG9ydF9uYW1lJyA9PiAncmVxdWlyZWR8dW5pcXVlOmVudHJ5X3BvaW50cyxzaG9ydF9uYW1lLCcuJGlkLAogICAgICAgICAgICAgICAgJ25hbWUnID0+ICdyZXF1aXJlZHx1bmlxdWU6ZW50cnlfcG9pbnRzLG5hbWUsJy4kaWQsCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KCiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRlbnRyeVBvaW50ID0gRW50cnlQb2ludDo6ZmluZCgkaWQpOwogICAgICAgICAgICAkZW50cnlQb2ludC0+ZmlsbCgkcmVxdWVzdC0+YWxsKCkpOwogICAgICAgICAgICAkZW50cnlQb2ludC0+c2F2ZSgpOwoKICAgICAgICAgICAgJGxlZGdlcnMgPSBbXTsKICAgICAgICAgICAgaWYoaXNzZXQoJHJlcXVlc3QtPmRlYml0X2xlZGdlcnNbMF0pKXsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRyZXF1ZXN0LT5kZWJpdF9sZWRnZXJzIGFzICRrZXkgPT4gJGNoYXJ0X29mX2FjY291bnRfaWQpIHsKICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRsZWRnZXJzLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICdlbnRyeV9wb2ludF9pZCcgPT4gJGVudHJ5UG9pbnQtPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAnY2hhcnRfb2ZfYWNjb3VudF9pZCcgPT4gJGNoYXJ0X29mX2FjY291bnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJyA9PiAnRCcsCiAgICAgICAgICAgICAgICAgICAgICAgICdjcmVhdGVkX2J5JyA9PiBhdXRoKCktPnVzZXIoKS0+aWQsCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKHJlcXVlc3QoKS0+aGFzKCdkZWJpdHMnKSl7CiAgICAgICAgICAgICAgICBFbnRyeVBvaW50TGVkZ2VyOjp3aGVyZSgnZW50cnlfcG9pbnRfaWQnLCAkZW50cnlQb2ludC0+aWQpLT53aGVyZSgndHlwZScsICdEJyktPmRlbGV0ZSgpOwogICAgICAgICAgICAgICAgaWYoaXNzZXQoJGxlZGdlcnNbMF0pKXsKICAgICAgICAgICAgICAgICAgICBFbnRyeVBvaW50TGVkZ2VyOjppbnNlcnQoJGxlZGdlcnMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkbGVkZ2VycyA9IFtdOwogICAgICAgICAgICBpZihpc3NldCgkcmVxdWVzdC0+Y3JlZGl0X2xlZGdlcnNbMF0pKXsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRyZXF1ZXN0LT5jcmVkaXRfbGVkZ2VycyBhcyAka2V5ID0+ICRjaGFydF9vZl9hY2NvdW50X2lkKSB7CiAgICAgICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkbGVkZ2VycywgWwogICAgICAgICAgICAgICAgICAgICAgICAnZW50cnlfcG9pbnRfaWQnID0+ICRlbnRyeVBvaW50LT5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ2NoYXJ0X29mX2FjY291bnRfaWQnID0+ICRjaGFydF9vZl9hY2NvdW50X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgPT4gJ0MnLAogICAgICAgICAgICAgICAgICAgICAgICAnY3JlYXRlZF9ieScgPT4gYXV0aCgpLT51c2VyKCktPmlkLAogICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygnY3JlZGl0cycpKXsKICAgICAgICAgICAgICAgIEVudHJ5UG9pbnRMZWRnZXI6OndoZXJlKCdlbnRyeV9wb2ludF9pZCcsICRlbnRyeVBvaW50LT5pZCktPndoZXJlKCd0eXBlJywgJ0MnKS0+ZGVsZXRlKCk7CiAgICAgICAgICAgICAgICBpZihpc3NldCgkbGVkZ2Vyc1swXSkpewogICAgICAgICAgICAgICAgICAgIEVudHJ5UG9pbnRMZWRnZXI6Omluc2VydCgkbGVkZ2Vycyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIkVudHJ5IFBvaW50IGhhcyBiZWVuIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGRlc3Ryb3koJGlkKQogICAgewogICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5ewogICAgICAgICAgICBFbnRyeVBvaW50OjpmaW5kKCRpZCktPmRlbGV0ZSgpOwogICAgICAgICAgICBFbnRyeVBvaW50TGVkZ2VyOjp3aGVyZSgnZW50cnlfcG9pbnRfaWQnLCAkaWQpLT5kZWxldGUoKTsKCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIkVudHJ5IFBvaW50IGhhcyBiZWVuIERlbGV0ZWQhIgogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9Cn0K