<?php
bolt_decrypt( __FILE__ , 'o1kHiD'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQmFua0FjY291bnQ7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRW50cnk7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRW50cnlJdGVtOwp1c2UgXEFwcFxVc2VyOwoKdXNlIEFwcCwgREIsIERhdGFUYWJsZXM7CnVzZSBJbGx1bWluYXRlXFN1cHBvcnRcRmFjYWRlc1xBdXRoOwoKY2xhc3MgQmFua1JlY29uY2lsaWF0aW9uSGlzdG9yeUNvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgIHsKICAgICAgICByZXR1cm4gYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwKICAgICAgICAgICAgWyd0cmFuc2FjdGlvbl9kYXRlJywgJ3RyYW5zYWN0aW9uX2RhdGUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydyZWNlaXB0X251bWJlcicsICdyZWNlaXB0X251bWJlcicsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3R5cGUnLCAndHlwZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3NvdXJjZScsICdzb3VyY2UnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWyduYXJyYXRpb24nLCAnbmFycmF0aW9uJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnY3VycmVuY3knLCAnY3VycmVuY3knLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydkZWJpdCcsICdkZWJpdCcsICd0ZXh0LXJpZ2h0J10sCiAgICAgICAgICAgIFsnY3JlZGl0JywgJ2NyZWRpdCcsICd0ZXh0LXJpZ2h0J10sCiAgICAgICAgICAgIFsncmVjb25jaWxpYXRpb25fZGF0ZScsICdyZWNvbmNpbGlhdGlvbl9kYXRlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnYnknLCAnYnknLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydhdCcsICdhdCcsICd0ZXh0LWNlbnRlciddLAogICAgICAgICk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkYmFua0FjY291bnQgPSBCYW5rQWNjb3VudDo6ZmluZChyZXF1ZXN0KCktPmdldCgnYmFua19hY2NvdW50X2lkJykpOwoKICAgICAgICAgICAgaWYgKHJlcXVlc3QoKS0+YWpheCgpKSB7CiAgICAgICAgICAgICAgICAkZW50cnlJdGVtcyA9IEVudHJ5SXRlbTo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgJ2VkaXRvcicsCiAgICAgICAgICAgICAgICAgICAgJ2VudHJ5LmVudHJ5VHlwZScsCiAgICAgICAgICAgICAgICAgICAgJ2VudHJ5LnB1cmNoYXNlT3JkZXInLAogICAgICAgICAgICAgICAgICAgICdlbnRyeS5leGNoYW5nZVJhdGUuY3VycmVuY3knCiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgLT53aGVyZU5vdE51bGwoJ3JlY29uY2lsaWF0aW9uX2RhdGUnKQogICAgICAgICAgICAgICAgLT53aGVyZUluKCdjaGFydF9vZl9hY2NvdW50X2lkJywgW2lzc2V0KCRiYW5rQWNjb3VudC0+Y2hhcnRfb2ZfYWNjb3VudF9pZCkgPyAkYmFua0FjY291bnQtPmNoYXJ0X29mX2FjY291bnRfaWQgOiAwLCBpc3NldCgkYmFua0FjY291bnQtPmJhbmtfY2hhcmdlc19hY2NvdW50KSA/ICRiYW5rQWNjb3VudC0+YmFua19jaGFyZ2VzX2FjY291bnQgOiAwXSkKICAgICAgICAgICAgICAgIC0+d2hlbighZW1wdHkocmVxdWVzdCgpLT5nZXQoJ2Zyb20nKSkgJiYgc3RydG90aW1lKHJlcXVlc3QoKS0+Z2V0KCdmcm9tJykpID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgncmVjb25jaWxpYXRpb25fZGF0ZScsICc+PScsIHJlcXVlc3QoKS0+Z2V0KCdmcm9tJykpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+d2hlbighZW1wdHkocmVxdWVzdCgpLT5nZXQoJ3RvJykpICYmIHN0cnRvdGltZShyZXF1ZXN0KCktPmdldCgndG8nKSkgPiAwLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdyZWNvbmNpbGlhdGlvbl9kYXRlJywgJzw9JywgcmVxdWVzdCgpLT5nZXQoJ3RvJykpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcmV0dXJuIERhdGFUYWJsZXM6Om9mKCRlbnRyeUl0ZW1zKQogICAgICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCd0cmFuc2FjdGlvbl9kYXRlJywgZnVuY3Rpb24gKCRpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkaXRlbS0+ZW50cnkgPyAkaXRlbS0+ZW50cnktPmRhdGUgOiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCd0cmFuc2FjdGlvbl9kYXRlJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2VudHJ5JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlICgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnZGF0ZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ3RyYW5zYWN0aW9uX2RhdGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgRW50cnk6OnNlbGVjdCgnZW50cmllcy5kYXRlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2VudHJpZXMuaWQnLCAnZW50cnlfaXRlbXMuZW50cnlfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbigncmVjZWlwdF9udW1iZXInLCBmdW5jdGlvbiAoJGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRpdGVtLT5lbnRyeSA/ICRpdGVtLT5lbnRyeS0+bnVtYmVyIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbigncmVjZWlwdF9udW1iZXInLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZW50cnknLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCdudW1iZXInLCAnTElLRScsICclJyAuICRrZXl3b3JkIC4gJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdyZWNlaXB0X251bWJlcicsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBFbnRyeTo6c2VsZWN0KCdlbnRyaWVzLm51bWJlcicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdlbnRyaWVzLmlkJywgJ2VudHJ5X2l0ZW1zLmVudHJ5X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ3R5cGUnLCBmdW5jdGlvbiAoJGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRpdGVtLT5lbnRyeSA/ICRpdGVtLT5lbnRyeS0+ZW50cnlUeXBlID8gJGl0ZW0tPmVudHJ5LT5lbnRyeVR5cGUtPm5hbWUgOiAnJyA6ICcnOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3R5cGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZW50cnkuZW50cnlUeXBlJywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlICgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnbmFtZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ3R5cGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgRW50cnk6OnNlbGVjdCgnZW50cnlfdHlwZXMubmFtZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2VudHJ5X3R5cGVzJywgJ2VudHJ5X3R5cGVzLmlkJywgJz0nLCAnZW50cmllcy5lbnRyeV90eXBlX2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2VudHJpZXMuaWQnLCAnZW50cnlfaXRlbXMuZW50cnlfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignc291cmNlJywgZnVuY3Rpb24gKCRpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkaXRlbS0+ZW50cnkgPyAkaXRlbS0+ZW50cnktPnB1cmNoYXNlT3JkZXIgPyB1Y3dvcmRzKHN0cl9yZXBsYWNlKCctJywgJyAnLCAkaXRlbS0+ZW50cnktPnB1cmNoYXNlT3JkZXItPnR5cGUpKSA6ICcnIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignc291cmNlJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2VudHJ5LnB1cmNoYXNlT3JkZXInLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCd0eXBlJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignc291cmNlJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIEVudHJ5OjpzZWxlY3QoJ3B1cmNoYXNlX29yZGVyX2VudHJpZXMudHlwZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ3B1cmNoYXNlX29yZGVyX2VudHJpZXMnLCAncHVyY2hhc2Vfb3JkZXJfZW50cmllcy5lbnRyeV9pZCcsICc9JywgJ2VudHJpZXMuaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignZW50cmllcy5pZCcsICdlbnRyeV9pdGVtcy5lbnRyeV9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjdXJyZW5jeScsIGZ1bmN0aW9uICgkaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGl0ZW0tPmVudHJ5ID8gJGl0ZW0tPmVudHJ5LT5leGNoYW5nZVJhdGUgPyAkaXRlbS0+ZW50cnktPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3kgPyAkaXRlbS0+ZW50cnktPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPmNvZGUgOiAnJyA6ICcnIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZW50cnkuZXhjaGFuZ2VSYXRlLmN1cnJlbmN5JywgZnVuY3Rpb24gKCRxdWVyeSkgdXNlICgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnY29kZScsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ2N1cnJlbmN5JywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwbGVhc2VTb3J0TWUoJHF1ZXJ5LCAkb3JkZXIsIEVudHJ5OjpzZWxlY3QoJ2N1cnJlbmNpZXMuY29kZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2N1cnJlbmNpZXMnLCAnY3VycmVuY2llcy5pZCcsICc9JywgJ2V4Y2hhbmdfcmF0ZXMuY3VycmVuY3lfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdleGNoYW5nX3JhdGVzJywgJ2V4Y2hhbmdfcmF0ZXMuaWQnLCAnPScsICdlbnRyaWVzLmV4Y2hhbmdlX3JhdGVfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignZW50cmllcy5pZCcsICdlbnRyeV9pdGVtcy5lbnRyeV9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdkZWJpdCcsIGZ1bmN0aW9uICgkaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGl0ZW0tPmRlYml0X2NyZWRpdCA9PSAnRCcgPyBzeXN0ZW1Nb25leUZvcm1hdCgkaXRlbS0+YW1vdW50KSA6ICcnOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2RlYml0JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Ftb3VudCcsICdMSUtFJywgJyUnIC4gJGtleXdvcmQgLiAnJScpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignZGViaXQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnYW1vdW50JywgJG9yZGVyKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdjcmVkaXQnLCBmdW5jdGlvbiAoJGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRpdGVtLT5kZWJpdF9jcmVkaXQgPT0gJ0MnID8gc3lzdGVtTW9uZXlGb3JtYXQoJGl0ZW0tPmFtb3VudCkgOiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdjcmVkaXQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnYW1vdW50JywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdjcmVkaXQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnYW1vdW50JywgJG9yZGVyKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdieScsIGZ1bmN0aW9uICgkaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGl0ZW0tPmVkaXRvciA/ICRpdGVtLT5lZGl0b3ItPm5hbWUuJyAoJy4kaXRlbS0+ZWRpdG9yLT5waG9uZS4nKScgOiAnJzsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdieScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdlZGl0b3InLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UgKCRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZSgncGhvbmUnLCAnTElLRScsICclJyAuICRrZXl3b3JkIC4gJyUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdieScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBVc2VyOjpzZWxlY3QoJ3VzZXJzLm5hbWUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbigndXNlcnMuaWQnLCAnZW50cnlfaXRlbXMudXBkYXRlZF9ieScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhdCcsIGZ1bmN0aW9uICgkaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0ZSgnWS1tLWQgZzppIGEnLCBzdHJ0b3RpbWUoJGl0ZW0tPnVwZGF0ZWRfYXQpKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdieScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCd1cGRhdGVkX2F0JywgJ0xJS0UnLCAnJScgLiAka2V5d29yZCAuICclJyk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdieScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCd1cGRhdGVkX2F0JywgJG9yZGVyKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+cmF3Q29sdW1ucyhbXSkKICAgICAgICAgICAgICAgICAgICAtPnRvSnNvbigpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLnJlY29uY2lsZUJhbmtBY2NvdW50Lmhpc3RvcnknLCBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICdCYW5rIFJlY29uY2lsaWF0aW9uIEhpc3RvcnknLAogICAgICAgICAgICAgICAgJ2JhbmtBY2NvdW50cycgPT4gQmFua0FjY291bnQ6OmFsbCgpLAogICAgICAgICAgICAgICAgJ2FjY291bnRzJyA9PiBbaXNzZXQoJGJhbmtBY2NvdW50LT5jaGFydF9vZl9hY2NvdW50X2lkKSA/ICRiYW5rQWNjb3VudC0+Y2hhcnRfb2ZfYWNjb3VudF9pZCA6IDAsIGlzc2V0KCRiYW5rQWNjb3VudC0+YmFua19jaGFyZ2VzX2FjY291bnQpID8gJGJhbmtBY2NvdW50LT5iYW5rX2NoYXJnZXNfYWNjb3VudCA6IDBdLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfSBjYXRjaCAoXFRocm93YWJsZSAkdGgpIHsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9Cn0K