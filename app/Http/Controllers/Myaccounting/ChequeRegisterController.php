<?php
bolt_decrypt( __FILE__ , 'KZbAvB'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcTXlhY2NvdW50aW5nOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKCnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29tcGFueTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDb3N0Q2VudHJlOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEZpc2NhbFllYXI7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcRW50cnlUeXBlOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXFRhZzsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDaGFydE9mQWNjb3VudDsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xFbnRyeTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xFbnRyeUl0ZW07CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ2hlcXVlUmVnaXN0ZXI7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcU3VwcGxpZXJzOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXFB1cmNoYXNlXFB1cmNoYXNlT3JkZXI7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcR3JuXEdvb2RzUmVjZWl2ZWRJdGVtU3RvY2tJbjsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xTdXBwbGllclBheW1lbnQ7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcU3VwcGxpZXJMZWRnZXJzOwp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEJhbmtBY2NvdW50Owp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEFkdmFuY2VDYXRlZ29yeTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xQdXJjaGFzZVxQdXJjaGFzZU9yZGVyRW50cnk7Cgp1c2UgXEFwcFxNb2RlbHNcUG1zTW9kZWxzXEFjY291bnRzXEN1cnJlbmN5VHlwZTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xDdXJyZW5jeTsKdXNlIFxBcHBcTW9kZWxzXFBtc01vZGVsc1xBY2NvdW50c1xFeGNoYW5nZVJhdGU7Cgp1c2UgQXBwLCBEQiwgRGF0YVRhYmxlczsKdXNlIElsbHVtaW5hdGVcU3VwcG9ydFxGYWNhZGVzXEF1dGg7CgpjbGFzcyBDaGVxdWVSZWdpc3RlckNvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIHB1YmxpYyBmdW5jdGlvbiBoZWFkZXJDb2x1bW5zKCR2YWx1ZT0nJykKICAgIHsKICAgICAgICByZXR1cm4gYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnXSwgCiAgICAgICAgICAgIFsnYmFua19hY2NvdW50JywgJ2JhbmtfYWNjb3VudCcsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3N1cHBsaWVyJywgJ3N1cHBsaWVyJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIC8vIFsnaW52b2ljZScsICdpbnZvaWNlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnZGF0ZScsICdkYXRlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnaW52b2ljZXMnLCAnaW52b2ljZXMnXSwKICAgICAgICAgICAgWydjaGVxdWVfbnVtYmVyJywgJ2NoZXF1ZV9udW1iZXInLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydzb3VyY2UnLCAnc291cmNlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIC8vIFsndHlwZScsICd0eXBlJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIC8vIFsnZGViaXRfY3JlZGl0JywgJ2RlYml0X2NyZWRpdCcsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ2N1cnJlbmN5JywgJ2N1cnJlbmN5JywgJ3RleHQtY2VudGVyJ10sIAogICAgICAgICAgICBbJ2Ftb3VudCcsICdhbW91bnQnLCAndGV4dC1yaWdodCddLAogICAgICAgICAgICBbJ25hcnJhdGlvbicsICduYXJyYXRpb24nXSwKICAgICAgICAgICAgWydpc3N1ZWRfYnknLCAnaXNzdWVkX2J5JywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnb3B0aW9ucycsICdvcHRpb25zJywgJ3RleHQtY2VudGVyJywnd2lkdGg6MTUlJ10KICAgICAgICApOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbmRleCgpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJGNoZXF1ZXMgPSBDaGVxdWVSZWdpc3Rlcjo6d2l0aChbCiAgICAgICAgICAgICAgICAnYmFua0FjY291bnQnLAogICAgICAgICAgICAgICAgJ2VudHJ5LmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsCiAgICAgICAgICAgICAgICAnY3JlYXRvcicsCiAgICAgICAgICAgICAgICAnc3VwcGxpZXJMZWRnZXIucmVsU3VwcGxpZXJQYXltZW50JywKICAgICAgICAgICAgICAgICdzdXBwbGllckxlZGdlci5zdXBwbGllcicsCiAgICAgICAgICAgICAgICAnY2hlcXVlcy5zdXBwbGllckxlZGdlci5yZWxTdXBwbGllclBheW1lbnQnLAogICAgICAgICAgICAgICAgJ2NoZXF1ZXMuc3VwcGxpZXJMZWRnZXIuc3VwcGxpZXInLAogICAgICAgICAgICBdKQogICAgICAgICAgICAtPndoZXJlKCdiYW5rX2FjY291bnRfaWQnLCByZXF1ZXN0KCktPmdldCgnYmFua19hY2NvdW50X2lkJykpCiAgICAgICAgICAgIC0+Z3JvdXBCeSgnY2hlcXVlX251bWJlcicpCiAgICAgICAgICAgIC0+d2hlbighZGF0YXRhYmxlT3JkZXJpbmcoKSwgZnVuY3Rpb24oJHF1ZXJ5KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2lkJywgJ2Rlc2MnKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAocmVxdWVzdCgpLT5hamF4KCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBEYXRhVGFibGVzOjpvZigkY2hlcXVlcykKICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQogICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2JhbmtfYWNjb3VudCcsIGZ1bmN0aW9uKCRjaGVxdWUpewogICAgICAgICAgICAgICAgICAgIHJldHVybiAnWycuJGNoZXF1ZS0+YmFua0FjY291bnQtPm51bWJlci4nXSAnLiRjaGVxdWUtPmJhbmtBY2NvdW50LT5uYW1lLicgKCcuJGNoZXF1ZS0+YmFua0FjY291bnQtPmJhbmtfbmFtZS4nKSc7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2JhbmtfYWNjb3VudCcsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2JhbmtBY2NvdW50JywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGtleXdvcmQpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZShmdW5jdGlvbigkcXVlcnkpIHVzZSgka2V5d29yZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnbnVtYmVyJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdiYW5rX25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdiYW5rX2FjY291bnQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBCYW5rQWNjb3VudDo6c2VsZWN0KCdiYW5rX2FjY291bnRzLm51bWJlcicpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2JhbmtfYWNjb3VudHMuaWQnLCAnY2hlcXVlX3JlZ2lzdGVycy5iYW5rX2FjY291bnRfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdzdXBwbGllcicsIGZ1bmN0aW9uKCRjaGVxdWUpewogICAgICAgICAgICAgICAgICAgIHJldHVybiBpc3NldCgkY2hlcXVlLT5zdXBwbGllckxlZGdlci0+c3VwcGxpZXItPmNvZGUpID8gJ1snLiRjaGVxdWUtPnN1cHBsaWVyTGVkZ2VyLT5zdXBwbGllci0+Y29kZS4nXSAnLiRjaGVxdWUtPnN1cHBsaWVyTGVkZ2VyLT5zdXBwbGllci0+bmFtZSA6ICcnOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdzdXBwbGllcicsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ3N1cHBsaWVyTGVkZ2VyLnN1cHBsaWVyJywgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJGtleXdvcmQpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZShmdW5jdGlvbigkcXVlcnkpIHVzZSgka2V5d29yZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnY29kZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+b3JXaGVyZSgnbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ3N1cHBsaWVyJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgU3VwcGxpZXJMZWRnZXJzOjpzZWxlY3QoJ3N1cHBsaWVycy5uYW1lJykKICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdzdXBwbGllcnMnLCAnc3VwcGxpZXJzLmlkJywgJycsICdzdXBwbGllcl9sZWRnZXJzLnN1cHBsaWVyX2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZUNvbHVtbignc3VwcGxpZXJfbGVkZ2Vycy5pZCcsICdjaGVxdWVfcmVnaXN0ZXJzLnN1cHBsaWVyX2xlZGdlcl9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5lZGl0Q29sdW1uKCdkYXRlJywgZnVuY3Rpb24oJGNoZXF1ZSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGUoJ1ktbS1kJywgc3RydG90aW1lKCRjaGVxdWUtPmRhdGV0aW1lKSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2RhdGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdkYXRldGltZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignZGF0ZScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2RhdGV0aW1lJywgJG9yZGVyKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignaW52b2ljZXMnLCBmdW5jdGlvbigkY2hlcXVlKXsKICAgICAgICAgICAgICAgICAgICAkaW52b2ljZXMgPSBbXTsKICAgICAgICAgICAgICAgICAgICBpZigkY2hlcXVlLT5jaGVxdWVzLT53aGVyZSgnYmFua19hY2NvdW50X2lkJywgJGNoZXF1ZS0+YmFua19hY2NvdW50X2lkKS0+Y291bnQoKSA+IDApewogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoKCRjaGVxdWUtPmNoZXF1ZXMtPndoZXJlKCdiYW5rX2FjY291bnRfaWQnLCAkY2hlcXVlLT5iYW5rX2FjY291bnRfaWQpIGFzICRrZXkgPT4gJGNoayl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpc3NldCgkY2hrLT5zdXBwbGllckxlZGdlci0+cmVsU3VwcGxpZXJQYXltZW50LT5iaWxsX251bWJlcikpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGludm9pY2VzLCAkY2hrLT5zdXBwbGllckxlZGdlci0+cmVsU3VwcGxpZXJQYXltZW50LT5iaWxsX251bWJlcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJldHVybiBpbXBsb2RlKCcsICcsIGFycmF5X3VuaXF1ZSgkaW52b2ljZXMpKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignaW52b2ljZXMnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdjaGVxdWVzLnN1cHBsaWVyTGVkZ2VyLnJlbFN1cHBsaWVyUGF5bWVudCcsIGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRrZXl3b3JkKXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2JpbGxfbnVtYmVyJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbigkY2hlcXVlKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXNzZXQoJGNoZXF1ZS0+ZW50cnktPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPmNvZGUpID8gJGNoZXF1ZS0+ZW50cnktPmV4Y2hhbmdlUmF0ZS0+Y3VycmVuY3ktPmNvZGUgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlSGFzKCdlbnRyeS5leGNoYW5nZVJhdGUuY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnY29kZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignY3VycmVuY3knLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBFbnRyeTo6c2VsZWN0KCdjdXJyZW5jaWVzLmNvZGUnKQogICAgICAgICAgICAgICAgICAgICAgICAtPmpvaW4oJ2N1cnJlbmNpZXMnLCAnY3VycmVuY2llcy5pZCcsICc9JywgJ2V4Y2hhbmdlX3JhdGVzLmN1cnJlbmN5X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgLT5qb2luKCdleGNoYW5nZV9yYXRlcycsICdleGNoYW5nZV9yYXRlcy5pZCcsICdlbnRyaWVzLmV4Y2hhbmdlX3JhdGVfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdlbnRyaWVzLmlkJywgJ2NoZXF1ZV9yZWdpc3RlcnMuZW50cnlfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbignYW1vdW50JywgZnVuY3Rpb24oJGNoZXF1ZSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbU1vbmV5Rm9ybWF0KCRjaGVxdWUtPmNoZXF1ZXMtPndoZXJlKCdiYW5rX2FjY291bnRfaWQnLCAkY2hlcXVlLT5iYW5rX2FjY291bnRfaWQpLT5zdW0oJ2Ftb3VudCcpKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignYW1vdW50JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnYW1vdW50JywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdhbW91bnQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCdhbW91bnQnLCAkb3JkZXIpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdpc3N1ZWRfYnknLCBmdW5jdGlvbigkY2hlcXVlKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGNoZXF1ZS0+Y3JlYXRvciA/ICRjaGVxdWUtPmNyZWF0b3ItPm5hbWUgOiAnJzsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignaXNzdWVkX2J5JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnY3JlYXRvcicsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkcXVlcnktPndoZXJlKCduYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdpc3N1ZWRfYnknLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBVc2VyOjpzZWxlY3QoJ3VzZXJzLm5hbWUnKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCd1c2Vycy5pZCcsICdjaGVxdWVfcmVnaXN0ZXJzLmNyZWF0ZWRfYnknKQogICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdvcHRpb25zJywgZnVuY3Rpb24oJGNoZXF1ZSl7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8YSBjbGFzcz0iYnRuIGJ0bi14cyBidG4tcHJpbWFyeSBtdC0xIiB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iJy51cmwoJ2FjY291bnRpbmcvY2hlcXVlLXJlZ2lzdGVyLycuJGNoZXF1ZS0+aWQpLiciPjxpIGNsYXNzPSJsYXMgbGEtbW9uZXktY2hlY2stYWx0Ij48L2k+Jm5ic3A7UHJpbnQgQ2hlcXVlPC9hPjxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1zdWNjZXNzIG10LTEgbWItMSIgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9IicudXJsKCdhY2NvdW50aW5nL2NoZXF1ZS1yZWdpc3Rlci8nLiRjaGVxdWUtPmlkKS4nP2Nhc2giPjxpIGNsYXNzPSJsYXMgbGEtbW9uZXktY2hlY2stYWx0Ij48L2k+Jm5ic3A7Q2FzaCBDaGVxdWU8L2E+PGEgY2xhc3M9ImJ0biBidG4teHMgYnRuLXN1Y2Nlc3MiIG9uY2xpY2s9ImVkaXROYXJyYXRpb24oJCh0aGlzKSkiIGRhdGEtY2hlcXVlLWlkPSInLiRjaGVxdWUtPmlkLiciIGRhdGEtbmFycmF0aW9uPSInLiRjaGVxdWUtPm5hcnJhdGlvbi4nIiBkYXRhLXBheWVlLW5hbWU9IicuJGNoZXF1ZS0+cGF5ZWVfbmFtZS4nIj48aSBjbGFzcz0ibGEgbGEtZWRpdCI+PC9pPiZuYnNwO0VkaXQgTmFycmF0aW9uPC9hPic7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFsnb3B0aW9ucyddKQogICAgICAgICAgICAgICAgLT5tYWtlKHRydWUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gdmlldygnYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmNoZXF1ZVJlZ2lzdGVyLmluZGV4JywgWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnQ2hlcXVlIFJlZ2lzdGVyJywKICAgICAgICAgICAgICAgICdiYW5rQWNjb3VudHMnID0+IEJhbmtBY2NvdW50Ojp3aXRoKFsKICAgICAgICAgICAgICAgICAgICAnY3VycmVuY3knCiAgICAgICAgICAgICAgICBdKS0+Z2V0KCksCiAgICAgICAgICAgICAgICAnaGVhZGVyQ29sdW1ucycgPT4gJHRoaXMtPmhlYWRlckNvbHVtbnMoKQogICAgICAgICAgICBdKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCR0aC0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7CiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRjaGVxdWUgPSBDaGVxdWVSZWdpc3Rlcjo6ZmluZE9yRmFpbCgkcmVxdWVzdC0+aWQpOwogICAgICAgICAgICBDaGVxdWVSZWdpc3Rlcjo6d2hlcmUoWwogICAgICAgICAgICAgICAgJ2JhbmtfYWNjb3VudF9pZCcgPT4gJGNoZXF1ZS0+YmFua19hY2NvdW50X2lkLAogICAgICAgICAgICAgICAgJ2NoZXF1ZV9udW1iZXInID0+ICRjaGVxdWUtPmNoZXF1ZV9udW1iZXIsCiAgICAgICAgICAgIF0pCiAgICAgICAgICAgIC0+dXBkYXRlKFsKICAgICAgICAgICAgICAgICduYXJyYXRpb24nID0+ICRyZXF1ZXN0LT5uYXJyYXRpb24sCiAgICAgICAgICAgICAgICAncGF5ZWVfbmFtZScgPT4gJHJlcXVlc3QtPnBheWVlX25hbWUsCiAgICAgICAgICAgIF0pOwoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAiQ2hlcXVlIE5hcnJhdGlvbiBoYXMgYmVlbiB1cGRhdGVkLiIKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHNob3coJGlkKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRjaGVxdWUgPSBDaGVxdWVSZWdpc3Rlcjo6d2l0aChbCiAgICAgICAgICAgICAgICAnYmFua0FjY291bnQnLAogICAgICAgICAgICAgICAgJ2VudHJ5LmV4Y2hhbmdlUmF0ZS5jdXJyZW5jeScsCiAgICAgICAgICAgICAgICAnY3JlYXRvcicKICAgICAgICAgICAgXSktPmZpbmRPckZhaWwoJGlkKTsKICAgICAgICAgICAgJGFtb3VudCA9IENoZXF1ZVJlZ2lzdGVyOjp3aGVyZShbCiAgICAgICAgICAgICAgICAnYmFua19hY2NvdW50X2lkJyA9PiAkY2hlcXVlLT5iYW5rX2FjY291bnRfaWQsCiAgICAgICAgICAgICAgICAnY2hlcXVlX251bWJlcicgPT4gJGNoZXF1ZS0+Y2hlcXVlX251bWJlciwKICAgICAgICAgICAgXSktPnN1bSgnYW1vdW50Jyk7CiAgICAgICAgICAgICR0aXRsZSA9ICdDaGVxdWUgIycuJGNoZXF1ZS0+Y2hlcXVlX251bWJlcjsKCiAgICAgICAgICAgIHJldHVybiB2aWV3TVBERignYWNjb3VudGluZy5iYWNrZW5kLnBhZ2VzLmNoZXF1ZVJlZ2lzdGVyLmNoZXF1ZScsIFsKICAgICAgICAgICAgICAgICd0aXRsZScgPT4gJHRpdGxlLAogICAgICAgICAgICAgICAgJ2NoZXF1ZScgPT4gJGNoZXF1ZSwKICAgICAgICAgICAgICAgICdhbW91bnQnID0+ICRhbW91bnQKICAgICAgICAgICAgXSwgJHRpdGxlLCAkdGl0bGUsICdhNScsICdMJyk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQp9Cg==